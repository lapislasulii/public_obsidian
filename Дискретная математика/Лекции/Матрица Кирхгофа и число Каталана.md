
### 1. Матрица Кирхгофа (неориентированный, невзвешенный граф)

Матрица Кирхгофа (иногда пишется как Хирхгов) определяется для ориентированных и невзвешенных графов.

**Построение матрицы:**

1. **Диагональные элементы:** Содержат количество исходящих рёбер из каждой вершины.
2. **Недиагональные элементы:** Если существует ребро из вершины $A$ в вершину $B$, то элемент $A_{AB}$ равен $-1$. Если ребра нет, элемент равен нулю.

### 3. Свойства матрицы Кирхгофа

Матрица Кирхгофа обладает рядом важных свойств, применимых к графу, который она описывает. Первые два свойства работают для любых графов, третье и пятое — только для неориентированных.

#### Свойство 1: Сумма элементов по строкам равна нулю

Сумма элементов в любой строке матрицы Кирхгофа равна нулю.

- _Интуитивное пояснение:_ На диагонали стоит количество исходящих рёбер, а каждое исходящее ребро, которое оно представляет, дает вклад $-1$ в соответствующей строке, тем самым они взаимно сокращаются, давая в сумме ноль.

#### Свойство 2: Детерминант матрицы равен нулю

**Теорема:** Детерминант матрицы Кирхгофа равен нулю.

- **Доказательство (через Свойство 1):** Поскольку сумма элементов по строкам равна нулю, это означает, что вектор-столбцы, образующие матрицу, являются линейно зависимыми (при сложении всех столбцов с коэффициентами, равными единице, мы получим вектор из нулей). По теореме из линейной алгебры, если столбцы матрицы линейно зависимы, ее определитель (детерминант) равен нулю.

#### Свойство 3: Симметричность (только для неориентированных графов)

Для неориентированного графа матрица Кирхгофа всегда симметрична. Это очевидно, поскольку если есть ребро между $A$ и $B$, то $A_{AB} = -1$ и $A_{BA} = -1$.

#### Свойство 4: Нуль является собственным числом

**Теорема:** Одно из собственных чисел (собственных значений) матрицы Кирхгофа обязательно равно нулю.

- **Доказательство:** Это свойство непосредственно следует из Свойства 2. Собственное число $\lambda$ определяется уравнением $\det(A - \lambda E) = 0$, где $A$ — матрица Кирхгофа. Если подставить $\lambda=0$, получим $\det(A)$, а поскольку мы уже знаем, что $\det(A) = 0$, то $\lambda=0$ является корнем (собственным числом).

#### Свойство 5: Кратность нуля и компоненты связности (только для неориентированных графов)

**Теорема:** Кратность (число повторений) корня $\lambda=0$ в характеристическом многочлене матрицы Кирхгофа совпадает с количеством компонент связности в соответствующем неориентированном графе.

- _Интуитивное пояснение:_ Если граф состоит из $N$ несвязанных «островов» (компонент связности), каждый такой остров вносит свой вклад в детерминант, который обнуляется при $\lambda=0$. Таким образом, каждая компонента связности "производит" свой собственный нуль в многочлене, и общее количество нулей (кратность) равно общему количеству островов.

### 4. Подробное рассмотрение доказательства Свойства 5

Доказательство того, что кратность корня $\lambda=0$ равна точно количеству компонент связности ($N$), состоит из двух частей: сначала доказывается, что кратность **не меньше** $N$, а затем, что она **равна** $N$.

#### 4.1. Доказательство того, что кратность $\ge N$ (Минимальная кратность)

1. **Блочно-диагональный вид:** Если граф имеет $N$ компонент связности, можно переупорядочить вершины таким образом, что матрица Кирхгофа примет блочно-диагональный вид. Это возможно, потому что вершины из одной компоненты не связаны с вершинами из другой, что приводит к нулевым значениям вне диагональных блоков.
2. **Разложение многочлена:** Из линейной алгебры берется утверждение о том, что определитель блочно-диагональной матрицы равен произведению определителей блоков. Аналогично, характеристический многочлен всей матрицы равен произведению характеристических многочленов каждого блока.
3. **Применение Свойства 4 к блокам:** Каждый блок $M_i$ является матрицей Кирхгофа для своей (связанной) компоненты. Поскольку каждый блок $M_i$ имеет нулевой определитель, каждый из них обязательно имеет $\lambda=0$ как корень.
4. **Вывод о кратности:** Если каждый из $N$ блоков дает хотя бы один множитель $\lambda$, то произведение многочленов даст $\lambda$ в степени, не меньшей $N$ ($\lambda^N \cdot (\dots)$). Таким образом, кратность корня $\lambda=0$ **хотя бы** равна количеству компонент связности $N$.

#### 4.2. Доказательство того, что кратность $= N$ (Точная кратность)

Для доказательства того, что кратность равна _ровно_ $N$, необходимо показать, что для **связанного графа** (одной компоненты) кратность $\lambda=0$ равна **единице**.

1. **Процедура изоляции:** Для доказательства используется процесс изоляции вершин — вырезание всех рёбер, связанных с выбранной вершиной. Изоляция вершины $D$ превращает ее в отдельную компоненту связности, и матрица вновь становится блочно-диагональной, где один блок — это нулевой элемент (вершина $D$), а второй блок — оставшаяся часть графа.
2. **Базовый случай:** Процедура изоляции повторяется до тех пор, пока не останется минимально связанный граф из двух вершин, соединенных одним ребром. Матрица Кирхгофа для такого графа имеет вид $\begin{pmatrix} 1 & -1 \ -1 & 1 \end{pmatrix}$.
3. **Расчет для базы:** Рассчитывая спектр (собственные числа) этой матрицы, мы обнаруживаем только два собственных числа: $\lambda=0$ и $\lambda=2$. Таким образом, для этого графа, имеющего ровно одну компоненту связности, кратность корня $\lambda=0$ равна ровно единице.
4. **Заключение:** Поскольку было показано, что одна компонента связности дает кратность ровно 1, а добавление изолированных вершин или блоков лишь увеличивает общую кратность на количество новых блоков, мы приходим к выводу, что кратность корня $\lambda=0$ точно равна количеству компонент связности $N$.

### 5. Теоремы, связанные с матрицей Кирхгофа

#### Матрица Кирхгофа для взвешенных графов

Для взвешенных графов свойства матрицы не меняются. Изменяется лишь ее наполнение:

- **Диагональные элементы:** Содержат сумму весов исходящих рёбер.
- **Недиагональные элементы:** Содержат минус вес ребра (если ребро существует).
- _Ограничение:_ Свойство 5 (о кратности нуля) не применяется к взвешенным графам из-за потенциальных проблем с нулевыми весами рёбер.

#### Теорема Кирхгофа (Остовные деревья)

**Теорема:** Любое алгебраическое дополнение матрицы Кирхгофа равно количеству остовных деревьев в связанном графе.

- **Алгебраическое дополнение** — это определитель минора, взятый с соответствующим знаком.
- _Интуитивное пояснение:_ Остовное дерево — это минимальный связный подграф, содержащий все вершины. Теорема позволяет подсчитать количество таких структур простым вычислением определителя подматрицы.

#### Формула Кэли

Формула Кэли является следствием теоремы Кирхгофа и позволяет найти количество всевозможных **помеченных деревьев** (где вершины имеют уникальные номера) с $N$ вершинами.

**Формула:** Количество помеченных деревьев равно $N^{N-2}$.

#### Числа Каталана

Число Каталана описывает количество парно неизоморфных деревьев или количество правильных скобочных последовательностей (ПСП) с $2N$ символами.

- _Связь с ПСП:_ Любую правильную скобочную последовательность можно однозначно преобразовать в бинарное дерево.
- **Рекуррентная формула:** Для подсчета $C_N$ требуется сумма произведений предыдущих чисел Каталана: $C_n = \sum_{i=0}^{n-1} C_i C_{n-1-i}$.
- _Интуитивное пояснение:_ Рекуррентная формула основана на двух возможных структурах ПСП или бинарного дерева: либо последовательность заключена в скобки (случай с одним потомком), либо является конкатенацией двух правильных последовательностей (случай с двумя потомками), и мы перебираем все возможные комбинации разбиения.