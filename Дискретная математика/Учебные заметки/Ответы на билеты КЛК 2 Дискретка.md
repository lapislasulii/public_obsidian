
### 0. Основные определения: вершины, рёбра, графы, ориентированные графы, изоморфизм. Типы графов: деревья, пути, циклы, связные графы. Матрицы смежности и инцидентности.

#### Основные определения

1.  **Граф** $(G = (V, E))$
    *   **Определение:** Граф $G$ — это упорядоченная пара $(V, E)$, где $V$ — непустое конечное множество элементов, называемых **вершинами** (или узлами), а $E$ — множество **рёбер**, соединяющих пары вершин.
    *   **Пояснение:** Вершины — это "точки", а рёбра — "линии", соединяющие эти точки.
    *   **Типы графов:**
        *   **Простой граф:** Граф, который не содержит петель (рёбер, соединяющих вершину с самой собой) и кратных рёбер (более одного ребра между одной и той же парой вершин). В простом графе $E$ — это подмножество неупорядоченных пар вершин из $V$.
        *   **Мультиграф:** Граф, который может содержать кратные рёбра.
        *   **Псевдограф:** Граф, который может содержать как кратные рёбра, так и петли.
        *   **Пустой граф:** Граф, у которого множество рёбер $E$ пусто.
        *   **Полный граф ($K_n$):** Простой неориентированный граф, в котором каждая пара различных вершин соединена ровно одним ребром. Полный граф с $n$ вершинами обозначается $K_n$.

2.  **Вершины (Vertices)**
    *   **Определение:** Элементы множества $V$.
    *   **Пояснение:** Точки или узлы в графе.

3.  **Рёбра (Edges)**
    *   **Определение:** Элементы множества $E$. В неориентированном графе ребро — это неупорядоченная пара вершин $\{u, v\}$. В ориентированном графе ребро — это упорядоченная пара вершин $(u, v)$.
    *   **Пояснение:** Линии, соединяющие вершины.

4.  **Ориентированный граф (Орграф, Digraph)**
    *   **Определение:** Граф, в котором каждое ребро имеет направление. Ребро $(u, v)$ означает, что существует связь от вершины $u$ к вершине $v$, но не обязательно обратно.
    *   **Пояснение:** Дороги с односторонним движением.

5.  **Неориентированный граф (Неорграф)**
    *   **Определение:** Граф, в котором рёбра не имеют направления. Ребро $\{u, v\}$ означает, что существует связь между $u$ и $v$, и она двусторонняя.
    *   **Пояснение:** Дороги с двусторонним движением.

6.  **Изоморфизм графов**
    *   **Определение:** Два графа $G_1 = (V_1, E_1)$ и $G_2 = (V_2, E_2)$ называются **изоморфными**, если существует биективное отображение (взаимно однозначное соответствие) $f: V_1 \to V_2$ такое, что для любых двух вершин $u, v \in V_1$, ребро $\{u, v\} \in E_1$ тогда и только тогда, когда ребро $\{f(u), f(v)\} \in E_2$.
    *   **Пояснение:** Изоморфные графы имеют одинаковую структуру, они отличаются только "именами" своих вершин. Их можно "перерисовать" так, чтобы они выглядели одинаково.

#### Типы графов

1.  **Путь (Path)**
    *   **Определение:** В контексте графов, "путь" часто означает **простую цепь** — последовательность различных вершин $v_0, v_1, \dots, v_k$ такая, что каждая пара $(v_i, v_{i+1})$ является ребром в графе. Длина пути — количество рёбер ($k$).
    *   **Пояснение:** Маршрут, который не повторяет ни одной вершины.

2.  **Цикл (Cycle)**
    *   **Определение:** **Простой цикл** — это простая цепь, в которой первая и последняя вершины совпадают, а все остальные вершины различны.
    *   **Пояснение:** Замкнутый маршрут, который не повторяет ни одной вершины, кроме начальной/конечной.

3.  **Дерево (Tree)**
    *   **Определение:** Связный ациклический неориентированный граф.
    *   **Характеристические свойства:**
        *   Связный и не содержит циклов.
        *   Между любыми двумя вершинами существует единственный простой путь.
        *   Имеет $n$ вершин и $n-1$ ребро.
        *   Удаление любого ребра делает его несвязным.
        *   Добавление любого ребра создает цикл.
    *   **Пояснение:** Граф без циклов, в котором все вершины соединены.

4.  **Лес (Forest)**
    *   **Определение:** Неориентированный граф, каждая компонента связности которого является неориентированным деревом.
    *   **Пояснение:** Набор из одного или нескольких не связанных между собой деревьев.

5.  **Связный граф (Connected Graph)**
    *   **Определение (для неориентированных графов):** Граф, в котором между любой парой вершин существует путь.
    *   **Определение (для ориентированных графов):**
        *   **Слабо связный:** Если его базовый неориентированный граф (полученный удалением направлений рёбер) связен.
        *   **Сильно связный:** Если для любой упорядоченной пары вершин $(u, v)$ существует ориентированный путь из $u$ в $v$.
    *   **Пояснение:** Граф, который состоит из одного "куска", без изолированных частей.

#### Матрицы графов

1.  **Матрица смежности (Adjacency Matrix)**
    *   **Определение:** Для графа с $n$ вершинами $V = \{v_1, \dots, v_n\}$, матрица смежности $A$ размера $n \times n$ определяется следующим образом:
        *   $A_{ij} = 1$, если существует ребро из $v_i$ в $v_j$.
        *   $A_{ij} = 0$, если ребра нет.
    *   **Для взвешенных графов:** $A_{ij}$ может содержать вес ребра.
    *   **Для неориентированных графов:** Матрица смежности симметрична ($A_{ij} = A_{ji}$).
    *   **Пояснение:** Таблица, показывающая, какие вершины напрямую соединены друг с другом.

2.  **Матрица инцидентности (Incidence Matrix)**
    *   **Определение:** Для графа с $n$ вершинами $V = \{v_1, \dots, v_n\}$ и $m$ рёбрами $E = \{e_1, \dots, e_m\}$, матрица инцидентности $B$ размера $n \times m$ определяется следующим образом:
        *   **Для неориентированного графа:** $B_{ij} = 1$, если вершина $v_i$ инцидентна ребру $e_j$ (т.е. является его концом). $B_{ij} = 0$ в противном случае.
        *   **Для ориентированного графа:** $B_{ij} = 1$, если $v_i$ является началом ребра $e_j$. $B_{ij} = -1$, если $v_i$ является концом ребра $e_j$. $B_{ij} = 0$ в противном случае.
    *   **Пояснение:** Таблица, показывающая, какие вершины являются концами каких рёбер.

---

### 1. Изоморфность графа. Задача Рамсея. Дополнение графа. Связность (с определение количества). Теорема Менгера (c док-вом через алгоритм Форда-Фалкерсона)

#### Изоморфность графа

*   **Определение:** См. пункт 0.
*   **Задача:** Проверка изоморфизма графов является одной из самых сложных задач в теории графов. Для произвольных графов не существует полиномиального алгоритма, хотя для некоторых классов графов (например, деревьев, планарных графов) такие алгоритмы существуют.

#### Задача Рамсея

*   **Определение:** Задача Рамсея (или теория Рамсея) изучает условия, при которых в достаточно большой структуре обязательно появляется некоторая упорядоченная подструктура. В контексте графов, число Рамсея $R(s, t)$ — это наименьшее целое число $n$ такое, что любой граф с $n$ вершинами либо содержит полный подграф $K_s$ (клику размера $s$), либо его дополнение содержит полный подграф $K_t$ (независимое множество размера $t$).
*   **Пояснение:** Классический пример: $R(3, 3) = 6$. Это означает, что на любой вечеринке из 6 человек обязательно найдутся либо 3 человека, которые попарно знакомы друг с другом, либо 3 человека, которые попарно незнакомы друг с другом.
*   **Доказательство $R(3,3) = 6$:**
    1.  Рассмотрим произвольную вершину $v$ в графе $G$ с 6 вершинами. По принципу Дирихле, $v$ должна быть соединена либо с 3 другими вершинами, либо не соединена с 3 другими вершинами (поскольку степень $v$ плюс степень $v$ в дополнении равна $n-1=5$).
    2.  **Случай 1:** $v$ соединена с 3 вершинами $A, B, C$.
        *   Если среди $A, B, C$ есть хотя бы одно ребро (например, $A-B$), то $v, A, B$ образуют $K_3$.
        *   Если среди $A, B, C$ нет рёбер, то $A, B, C$ образуют независимое множество из 3 вершин (т.е. $K_3$ в дополнении).
    3.  **Случай 2:** $v$ не соединена с 3 вершинами $A, B, C$.
        *   Это означает, что $A, B, C$ образуют $K_3$ в дополнении.
        *   Если среди $A, B, C$ есть хотя бы одно ребро (например, $A-B$), то $A, B, C$ не образуют $K_3$ в дополнении. Тогда $A, B, C$ образуют $K_3$ в исходном графе.
    4.  Таким образом, в любом случае найдется $K_3$ либо в графе, либо в его дополнении.
    5.  Чтобы показать, что $R(3,3)$ не равно 5, достаточно привести пример графа с 5 вершинами, который не содержит $K_3$ и его дополнение также не содержит $K_3$. Таким графом является цикл $C_5$.

#### Дополнение графа ($\bar{G}$)

*   **Определение:** Для простого неориентированного графа $G = (V, E)$, его **дополнение** $\bar{G} = (V, \bar{E})$ — это граф на том же множестве вершин $V$, где множество рёбер $\bar{E}$ содержит все те рёбра, которые отсутствуют в $E$. То есть, $\{u, v\} \in \bar{E}$ тогда и только тогда, когда $\{u, v\} \notin E$.
*   **Пояснение:** Если в исходном графе между двумя вершинами было ребро, то в дополнении его нет, и наоборот.

#### Связность (с определение количества)

*   **Определение:**
    *   **Вершинная связность ($\kappa(G)$):** Минимальное количество вершин, удаление которых делает граф несвязным или тривиальным (состоящим из одной вершины).
    *   **Реберная связность ($\lambda(G)$):** Минимальное количество рёбер, удаление которых делает граф несвязным.
*   **Пояснение:** Вершинная связность показывает, насколько "устойчив" граф к удалению вершин, а реберная связность — к удалению рёбер.
*   **Свойство:** Для любого графа $G$, $\kappa(G) \le \lambda(G) \le \min_{v \in V} \text{deg}(v)$.

#### Теорема Менгера (с док-вом через алгоритм Форда-Фалкерсона)

*   **Формулировка (вершинная связность):** Пусть $G$ — неориентированный граф, и $u, v$ — две несмежные вершины. Тогда максимальное количество попарно вершинно-независимых путей между $u$ и $v$ (т.е. путей, не имеющих общих промежуточных вершин) равно минимальному количеству вершин, удаление которых разделяет $u$ и $v$.
*   **Формулировка (реберная связность):** Пусть $G$ — неориентированный граф, и $u, v$ — две вершины. Тогда максимальное количество попарно реберно-независимых путей между $u$ и $v$ (т.е. путей, не имеющих общих рёбер) равно минимальному количеству рёбер, удаление которых разделяет $u$ и $v$.
*   **Доказательство (реберная связность через Форда-Фалкерсона):**
    1.  **Построение сети:** Создадим транспортную сеть $N$ из графа $G$. Для каждого ребра $\{x, y\} \in E$ в $G$ создадим два ориентированных ребра $(x, y)$ и $(y, x)$ в $N$, каждому из которых присвоим пропускную способность $c(x, y) = 1$.
    2.  **Максимальный поток:** Найдем максимальный поток $f$ из $u$ в $v$ в этой сети $N$ с помощью алгоритма Форда-Фалкерсона.
    3.  **Теорема Форда-Фалкерсона:** Согласно теореме Форда-Фалкерсона, величина максимального потока $|f|$ равна пропускной способности минимального разреза $(S, T)$ в сети $N$.
    4.  **Связь с разрезом:** Минимальный разрез $(S, T)$ в этой сети состоит из рёбер, идущих из $S$ в $T$. Поскольку пропускная способность каждого ребра равна 1, величина разреза равна количеству рёбер, пересекающих разрез. Удаление этих рёбер в исходном графе $G$ разделяет $u$ и $v$. Таким образом, минимальное количество рёбер, разделяющих $u$ и $v$, равно величине минимального разреза.
    5.  **Связь с путями:** Каждый единичный поток, найденный алгоритмом Форда-Фалкерсона, соответствует реберно-независимому пути из $u$ в $v$. Поскольку поток максимален, мы нашли максимальное количество таких путей.
    6.  **Вывод:** Таким образом, максимальное количество реберно-независимых путей из $u$ в $v$ равно максимальному потоку, который, в свою очередь, равен минимальному количеству рёбер, разделяющих $u$ и $v$.

*   **Доказательство (вершинная связность через Форда-Фалкерсона):**
    1.  **Построение сети:** Для вершинной связности требуется более сложная конструкция. Каждую вершину $w \in V \setminus \{u, v\}$ в графе $G$ "раздваиваем" на две вершины $w_{in}$ и $w_{out}$, соединяя их ориентированным ребром $(w_{in}, w_{out})$ с пропускной способностью $c(w_{in}, w_{out}) = 1$.
    2.  Для каждого ребра $\{x, y\} \in E$ в $G$:
        *   Если $x, y \notin \{u, v\}$, добавляем рёбра $(x_{out}, y_{in})$ и $(y_{out}, x_{in})$ с бесконечной пропускной способностью.
        *   Если $x=u$, добавляем рёбра $(u, y_{in})$ с бесконечной пропускной способностью.
        *   Если $y=v$, добавляем рёбра $(x_{out}, v)$ с бесконечной пропускной способностью.
    3.  **Максимальный поток:** Найдем максимальный поток из $u$ в $v$ в этой новой сети.
    4.  **Связь с разрезом:** Минимальный разрез в этой сети будет иметь конечную пропускную способность только за счет рёбер типа $(w_{in}, w_{out})$. Каждое такое ребро соответствует вершине $w$ в исходном графе. Удаление этих вершин (и соответствующих рёбер) разделяет $u$ и $v$.
    5.  **Вывод:** Величина максимального потока будет равна минимальному количеству таких "раздвоенных" вершин, которые нужно "перерезать", чтобы разделить $u$ и $v$. Это и есть минимальное количество вершин, удаление которых разделяет $u$ и $v$, что равно максимальному количеству вершинно-независимых путей.

---

### 2. Эйлеровы циклы и цепи. Задача о кенигсбергских мостах. Теорема Эйлера (с док-вом). Покрытие графа наименьшим числом непересекающихся по ребрам цепей.

#### Эйлеровы циклы и цепи

*   **Эйлерова цепь (Eulerian Path):** Цепь, проходящая через все рёбра графа ровно один раз. Вершины могут повторяться.
*   **Эйлеров цикл (Eulerian Cycle):** Эйлерова цепь, которая начинается и заканчивается в одной и той же вершине.
*   **Эйлеров граф:** Граф, содержащий эйлеров цикл.

#### Задача о кёнигсбергских мостах

*   **Описание:** Классическая задача, решенная Леонардом Эйлером в 1736 году, положившая начало теории графов. Город Кёнигсберг (ныне Калининград) имел 7 мостов, соединяющих 4 части суши. Вопрос заключался в том, можно ли пройти по всем мостам ровно один раз и вернуться в исходную точку.
*   **Графовая модель:** Части суши представляются вершинами, а мосты — рёбрами. Граф имеет 4 вершины и 7 рёбер. Степени всех вершин в этом графе нечётны (3, 3, 3, 5).
*   **Решение Эйлера:** Эйлер доказал, что такой маршрут невозможен, сформулировав критерий существования эйлерова цикла/цепи.

#### Теорема Эйлера (с доказательством)

*   **Формулировка (для неориентированных графов):**
    1.  Связный неориентированный граф имеет **эйлеров цикл** тогда и только тогда, когда степени всех его вершин чётны.
    2.  Связный неориентированный граф имеет **эйлерову цепь** (но не цикл) тогда и только тогда, когда у него ровно две вершины нечётной степени.
*   **Доказательство (для эйлерова цикла):**
    *   **Необходимость:** Пусть граф $G$ имеет эйлеров цикл. Начнем обход из некоторой вершины $v$. Каждый раз, когда мы входим в вершину по ребру, мы должны выйти из неё по другому ребру, чтобы продолжить цикл (если это не начальная/конечная вершина). Таким образом, каждое посещение вершины (кроме начала/конца) использует два ребра. Поскольку цикл начинается и заканчивается в одной и той же вершине, эта вершина также использует два ребра (вход и выход). Следовательно, каждое ребро, инцидентное любой вершине, используется ровно один раз, и для каждой вершины количество входящих рёбер равно количеству исходящих рёбер (в случае ориентированного графа), или просто каждое ребро "парно" используется для входа и выхода. Таким образом, степень каждой вершины должна быть чётной.
    *   **Достаточность:** Пусть степени всех вершин связного графа $G$ чётны.
        1.  Начнем произвольный путь из любой вершины $v_0$, проходя по рёбрам, которые еще не были использованы. Поскольку каждая вершина имеет чётную степень, мы всегда можем выйти из любой вершины, в которую вошли (если это не $v_0$ и мы не использовали все рёбра).
        2.  Поскольку граф конечен, этот процесс должен закончиться, когда мы не сможем выйти из текущей вершины. Это произойдет только тогда, когда мы вернемся в $v_0$, и все рёбра, инцидентные $v_0$, будут использованы. Таким образом, мы построили цикл $C$.
        3.  Если $C$ включает все рёбра графа $G$, то это эйлеров цикл.
        4.  Если $C$ не включает все рёбра, то удалим рёбра $C$ из $G$, получив подграф $G'$. В $G'$ все вершины также будут иметь чётные степени (поскольку мы удалили по два ребра для каждой вершины, через которую проходил $C$).
        5.  Поскольку $G$ связен, и $C$ не покрывает все рёбра, в $G'$ должна быть хотя бы одна вершина $u$, которая была частью $C$ и имеет инцидентные рёбра в $G'$.
        6.  Начнем новый цикл $C'$ из $u$ в $G'$. Этот цикл также вернется в $u$.
        7.  Мы можем "вставить" цикл $C'$ в $C$ в точке $u$, образовав более длинный цикл, который проходит через большее количество рёбер.
        8.  Повторяя этот процесс, мы в конечном итоге построим цикл, который проходит через все рёбра графа $G$.

*   **Доказательство (для эйлеровой цепи):** Если граф имеет ровно две вершины нечётной степени, скажем $u$ и $v$. Добавим фиктивное ребро между $u$ и $v$. Тогда степени всех вершин станут чётными. По доказанному выше, в новом графе существует эйлеров цикл. Если удалить фиктивное ребро, то этот цикл превратится в эйлерову цепь, начинающуюся в $u$ и заканчивающуюся в $v$ (или наоборот).

#### Покрытие графа наименьшим числом непересекающихся по ребрам цепей

*   **Определение:** Задача состоит в том, чтобы найти минимальное количество цепей, которые покрывают все рёбра графа, при этом каждая цепь использует рёбра, не пересекающиеся с рёбрами других цепей.
*   **Теорема (Эрдёш-Галлаи):** Минимальное количество цепей, необходимых для покрытия всех рёбер графа $G$, равно $\max(1, \frac{1}{2} \sum_{v \in V} \text{deg}_{\text{odd}}(v))$, где $\text{deg}_{\text{odd}}(v)$ — количество вершин нечётной степени.
*   **Пояснение:** Каждая цепь может "поглотить" две вершины нечётной степени (одну как начало, другую как конец). Если вершин нечётной степени нет, то достаточно одной цепи (эйлерова цикла). Если есть $k$ вершин нечётной степени, то потребуется $k/2$ цепей, чтобы "закрыть" все эти нечётные степени.

---

### 3. Гамильтоновы циклы и цепи. Теорема Дирака (с док-вом). Теорема Оре. Граф Петерсена.

#### Гамильтоновы циклы и цепи

*   **Гамильтонова цепь (Hamiltonian Path):** Простая цепь, проходящая через все вершины графа ровно один раз.
*   **Гамильтонов цикл (Hamiltonian Cycle):** Простой цикл, проходящий через все вершины графа ровно один раз (кроме начальной/конечной, которая повторяется).
*   **Гамильтонов граф:** Граф, содержащий гамильтонов цикл.
*   **Полугамильтонов граф:** Граф, содержащий гамильтонову цепь, но не цикл.
*   **Пояснение:** В отличие от эйлеровых, гамильтоновы пути/циклы фокусируются на посещении всех *вершин*, а не всех *рёбер*.

#### Теорема Дирака (с доказательством)

*   **Формулировка:** Если в простом неориентированном графе $G$ с $n \ge 3$ вершинами степень каждой вершины $v$ удовлетворяет условию $\text{deg}(v) \ge \frac{n}{2}$, то граф $G$ является гамильтоновым.
*   **Доказательство (через теорему Оре):**
    1.  Возьмем любые две несмежные вершины $u$ и $v$ в графе $G$.
    2.  По условию теоремы Дирака, $\text{deg}(u) \ge n/2$ и $\text{deg}(v) \ge n/2$.
    3.  Сложим эти неравенства: $\text{deg}(u) + \text{deg}(v) \ge n/2 + n/2 = n$.
    4.  Это в точности условие теоремы Оре. Поскольку условие Оре выполнено, граф $G$ является гамильтоновым.
    *   **Вывод:** Теорема Дирака является прямым следствием теоремы Оре.

#### Теорема Оре (с доказательством)

*   **Формулировка:** Рассмотрим простой неориентированный граф $G$ с количеством вершин $n \ge 3$. Если для любых двух несмежных вершин $u$ и $v$ выполнено условие $\text{deg}(u) + \text{deg}(v) \ge n$, то граф $G$ является гамильтоновым.
*   **Доказательство (методом от противного):**
    1.  **Предположение:** Допустим, существует негамильтонов граф $G$ с $n$ вершинами, который удовлетворяет условию Оре.
    2.  **Максимальный негамильтонов граф:** Среди всех таких графов выберем тот, который имеет максимальное количество рёбер. Назовем его $G'$. Если $G'$ негамильтонов, но удовлетворяет условию Оре, то добавление любого ребра к $G'$ должно сделать его гамильтоновым.
    3.  **Существование гамильтонова пути:** Поскольку добавление любого ребра делает $G'$ гамильтоновым, в $G'$ должен существовать гамильтонов путь. Пусть это путь $v_1 \to v_2 \to \dots \to v_n$.
    4.  **Несмежность концов:** Вершины $v_1$ и $v_n$ не могут быть смежными в $G'$, иначе $v_1 \to v_2 \to \dots \to v_n \to v_1$ был бы гамильтоновым циклом, что противоречит предположению.
    5.  **Применение условия Оре:** Поскольку $v_1$ и $v_n$ не смежны, по условию теоремы Оре, $\text{deg}(v_1) + \text{deg}(v_n) \ge n$.
    6.  **Поиск "перекрестных" рёбер:** Рассмотрим множество $S = \{i \mid 1 < i \le n \text{ и } (v_1, v_i) \in E(G')\}$. Это множество индексов вершин, смежных с $v_1$. Размер $|S| = \text{deg}(v_1)$.
    7.  Рассмотрим множество $T = \{i \mid 1 \le i < n \text{ и } (v_i, v_n) \in E(G')\}$. Это множество индексов вершин, смежных с $v_n$. Размер $|T| = \text{deg}(v_n)$.
    8.  Если существует индекс $k$ такой, что $k \in S$ и $k-1 \in T$, то есть $(v_1, v_k) \in E(G')$ и $(v_{k-1}, v_n) \in E(G')$, то мы можем построить гамильтонов цикл:
        $v_1 \to v_k \to v_{k+1} \to \dots \to v_n \to v_{k-1} \to v_{k-2} \to \dots \to v_1$.
        Этот цикл проходит через все вершины, что противоречит предположению о негамильтоновости $G'$.
    9.  **Принцип Дирихле:** Предположим, что такого $k$ не существует. Это означает, что для любого $i \in S$, $i-1 \notin T$.
        Тогда множество $S' = \{i-1 \mid i \in S\}$ не пересекается с $T$.
        Размер $|S'| = |S| = \text{deg}(v_1)$.
        Множества $S'$ и $T$ являются подмножествами $\{1, 2, \dots, n-1\}$.
        Объединение $S' \cup T$ имеет размер $|S' \cup T| = |S'| + |T| = \text{deg}(v_1) + \text{deg}(v_n)$.
        Поскольку $\text{deg}(v_1) + \text{deg}(v_n) \ge n$, то $|S' \cup T| \ge n$.
        Но $S' \cup T$ является подмножеством $\{1, 2, \dots, n-1\}$, которое содержит всего $n-1$ элементов.
        Это противоречие ($n \ge n-1$).
    10. **Вывод:** Исходное предположение о существовании негамильтонова графа, удовлетворяющего условию Оре, ложно. Следовательно, любой такой граф является гамильтоновым.

#### Граф Петерсена

*   **Определение:** Граф Петерсена — это неориентированный граф с 10 вершинами и 15 рёбрами. Он является 3-регулярным (каждая вершина имеет степень 3).
*   **Свойства:**
    *   Негамильтонов (не содержит гамильтонова цикла).
    *   Непланарен (не может быть нарисован на плоскости без пересечений рёбер).
    *   Является классическим контрпримером для многих теорем в теории графов.
*   **Пояснение:** Граф Петерсена часто используется для иллюстрации того, что многие достаточные условия для гамильтоновости (например, Дирака или Оре) не являются необходимыми. Он не удовлетворяет условиям Дирака ($\text{deg}(v) = 3 < 10/2 = 5$) и Оре ($\text{deg}(u) + \text{deg}(v) = 3+3 = 6 < 10$).

---

### 4. Деревья и их характеристические свойства. Диаметры и центры деревьев. Поиск центра (с док-вом). Лес (мощность леса с док-вом).

#### Деревья и их характеристические свойства

*   **Определение:** См. пункт 0.
*   **Характеристические свойства (доказательства):**
    1.  **Связный граф с $n$ вершинами является деревом тогда и только тогда, когда он имеет $n-1$ ребро.**
        *   **Доказательство ( $\Rightarrow$ ):** Пусть $G$ — дерево с $n$ вершинами. Если $n=1$, то 0 рёбер. Если $n>1$, удалим ребро. Граф останется связным или распадется на 2 компоненты. Если он остался связным, то он содержит цикл, что противоречит определению дерева. Значит, удаление любого ребра делает его несвязным. Это свойство называется "минимальная связность". Можно доказать индукцией: базовый случай $n=1$ (0 рёбер). Предположим, для $k$ вершин дерево имеет $k-1$ ребро. Добавим новую вершину $v$ и соединим её с одной из существующих вершин $u$. Получим дерево с $k+1$ вершиной и $k$ рёбрами.
        *   **Доказательство ( $\Leftarrow$ ):** Пусть $G$ — связный граф с $n$ вершинами и $n-1$ ребром. Предположим, что $G$ содержит цикл. Тогда мы можем удалить одно ребро из этого цикла, и граф останется связным. Повторяя этот процесс, пока не удалим все циклы, мы получим связный ациклический подграф (дерево) с $n$ вершинами. Но у этого дерева будет меньше, чем $n-1$ ребро (поскольку мы удаляли рёбра), что противоречит первой части доказательства. Следовательно, $G$ не может содержать циклов и является деревом.
    2.  **Между любыми двумя вершинами дерева существует единственный простой путь.**
        *   **Доказательство:** Поскольку дерево связно, путь между любыми двумя вершинами существует. Предположим, что между вершинами $u$ и $v$ существует два различных простых пути $P_1$ и $P_2$. Тогда объединение этих двух путей $P_1 \cup P_2$ будет содержать цикл. Это противоречит определению дерева как ациклического графа. Следовательно, путь должен быть единственным.
    3.  **Дерево является ациклическим графом, в котором добавление любого ребра создает ровно один цикл.**
        *   **Доказательство:** Поскольку дерево ациклично, добавление ребра $\{u, v\}$ между двумя вершинами $u$ и $v$ создаст цикл. Поскольку между $u$ и $v$ уже существует единственный путь в дереве, добавление ребра $\{u, v\}$ замкнет этот путь в единственный цикл.

#### Диаметры и центры деревьев

*   **Эксцентриситет вершины $\epsilon(v)$:** Наибольшее расстояние от вершины $v$ до любой другой вершины в графе.
*   **Радиус графа $R(G)$:** Минимальный эксцентриситет среди всех вершин графа. $R(G) = \min_{v \in V} \epsilon(v)$.
*   **Диаметр графа $D(G)$:** Максимальный эксцентриситет среди всех вершин графа. $D(G) = \max_{v \in V} \epsilon(v)$.
*   **Центр дерева:** Вершина (или две смежные вершины), эксцентриситет которой равен радиусу дерева.
*   **Пояснение:** Центр дерева — это "самая центральная" вершина, которая находится ближе всего к самой удаленной вершине.

#### Поиск центра дерева (с доказательством)

*   **Алгоритм:**
    1.  Найти все листья (вершины степени 1) в дереве.
    2.  Удалить все листья и инцидентные им рёбра.
    3.  Повторять шаги 1 и 2 до тех пор, пока не останется одна или две вершины. Эти оставшиеся вершины и будут центром дерева.
*   **Доказательство:**
    1.  **Удаление листьев не меняет центр:** Пусть $P$ — самый длинный путь в дереве (диаметр). Концы этого пути являются листьями (иначе можно было бы продлить путь). Если мы удалим лист $l$ и его ребро, то эксцентриситет любой вершины $v$ в оставшемся дереве либо уменьшится, либо останется прежним. Однако, если $v$ является центром, то кратчайший путь от $v$ до самой удаленной вершины $u$ не может проходить через лист $l$, если $l$ не является $u$. Если $l$ является $u$, то $v$ не может быть центром, так как $u$ — лист.
    2.  **Сохранение диаметра:** Удаление листьев не изменяет диаметр дерева, пока не будут удалены все вершины, лежащие на диаметральном пути.
    3.  **Сведение к центру:** Процесс последовательного удаления листьев постепенно "сжимает" дерево к его центру. В конце останется либо одна вершина (если диаметр чётный), либо две смежные вершины (если диаметр нечётный). Эти вершины будут иметь минимальный эксцентриситет, равный радиусу дерева.

#### Лес (мощность леса с доказательством)

*   **Определение:** См. пункт 0.
*   **Мощность леса (количество компонент связности):** Если лес $G$ имеет $n$ вершин и $m$ рёбер, и состоит из $k$ компонент связности (деревьев), то $m = n - k$.
*   **Доказательство:**
    1.  Пусть лес $G$ состоит из $k$ деревьев $T_1, T_2, \dots, T_k$.
    2.  Пусть $T_i$ имеет $n_i$ вершин и $m_i$ рёбер.
    3.  По определению дерева, каждое дерево $T_i$ имеет $m_i = n_i - 1$ рёбер.
    4.  Общее количество вершин в лесу $n = \sum_{i=1}^k n_i$.
    5.  Общее количество рёбер в лесу $m = \sum_{i=1}^k m_i$.
    6.  Подставим $m_i = n_i - 1$: $m = \sum_{i=1}^k (n_i - 1) = \sum_{i=1}^k n_i - \sum_{i=1}^k 1 = n - k$.
    7.  **Вывод:** Таким образом, количество рёбер в лесу равно количеству вершин минус количество компонент связности.

---

### 5. Ориентированные деревья (определение, характеристики и свойства с док-вом). Поиск в глубину и в ширину. Бинарное дерево (+ полное бинарное, док-во количества листьев).

#### Ориентированные деревья

*   **Определение:** Ориентированный граф, который является ациклическим и имеет особую вершину, называемую **корнем**. Обладает следующими свойствами:
    1.  В корень входит ноль рёбер (ин-степень корня равна 0).
    2.  Из корня достижима любая другая вершина.
    3.  Для всех вершин, кроме корня, существует, причём единственное, ребро, входящее в эту вершину (ин-степень всех остальных вершин равна 1).
*   **Характеристики и свойства (с доказательством):**
    1.  **Единственность пути из корня:** Из корня в любую другую вершину существует единственный ориентированный путь.
        *   **Доказательство:** Предположим, что из корня $r$ в вершину $v$ существует два различных пути $P_1$ и $P_2$. Поскольку $P_1 \ne P_2$, они должны расходиться в некоторой вершине $u$ и затем снова сходиться в некоторой вершине $w$. Это означает, что существует два различных пути из $u$ в $w$. Если $u=r$, то это противоречит тому, что в каждую вершину (кроме корня) входит ровно одно ребро. Если $u \ne r$, то в $w$ будет входить два ребра (одно из $P_1$, другое из $P_2$), что противоречит свойству, что в каждую вершину, кроме корня, входит ровно одно ребро. Следовательно, путь должен быть единственным.
    2.  **Количество рёбер:** Ориентированное дерево с $n$ вершинами имеет $n-1$ ребро.
        *   **Доказательство:** Каждая вершина, кроме корня, имеет ин-степень 1. Корень имеет ин-степень 0. Сумма ин-степеней всех вершин в любом ориентированном графе равна общему количеству рёбер. Таким образом, количество рёбер равно $(n-1) \times 1 + 0 = n-1$.

#### Поиск в глубину (DFS) и в ширину (BFS)

Это алгоритмы обхода графа, используемые для нахождения путей, компонент связности, топологической сортировки и других задач.

1.  **Поиск в ширину (BFS - Breadth-First Search)**
    *   **Принцип:** Обходит граф "слоями", сначала посещая все вершины на расстоянии 1 от стартовой, затем все на расстоянии 2, и так далее. Использует **очередь (Queue)** для хранения вершин, которые нужно посетить.
    *   **Алгоритм:**
        1.  Инициализировать очередь $Q$, добавить стартовую вершину $s$ в $Q$. Отметить $s$ как посещенную.
        2.  Пока $Q$ не пуста:
            *   Извлечь вершину $u$ из начала $Q$.
            *   Для каждого соседа $v$ вершины $u$:
                *   Если $v$ не посещена:
                    *   Отметить $v$ как посещенную.
                    *   Добавить $v$ в конец $Q$.
                    *   Установить $u$ как родителя $v$.
    *   **Применение:** Нахождение кратчайших путей в невзвешенных графах, проверка связности, поиск компонент связности.
    *   **Сложность:** $O(V+E)$.

2.  **Поиск в глубину (DFS - Depth-First Search)**
    *   **Принцип:** Обходит граф, максимально углубляясь по одному пути, пока не достигнет тупика или уже посещенной вершины, затем возвращается и исследует другие ветви. Использует **стек (Stack)** (или рекурсию, которая использует стек вызовов) для хранения вершин.
    *   **Алгоритм (рекурсивный):**
        1.  Функция `DFS(u)`:
            *   Отметить $u$ как посещенную.
            *   Для каждого соседа $v$ вершины $u$:
                *   Если $v$ не посещена:
                    *   Установить $u$ как родителя $v$.
                    *   Вызвать `DFS(v)`.
    *   **Применение:** Топологическая сортировка, поиск компонент сильной связности, обнаружение циклов, поиск мостов и сочленений.
    *   **Сложность:** $O(V+E)$.

#### Бинарное дерево (+ полное бинарное, доказательство количества листьев)

*   **Бинарное дерево:** Ориентированное дерево, в котором каждая вершина имеет не более двух потомков (исходящих рёбер). Каждый потомок обычно обозначается как "левый" или "правый".
*   **Полное бинарное дерево:** Бинарное дерево, в котором все внутренние вершины имеют ровно двух потомков, и все листья находятся на одном уровне (глубине).
*   **Доказательство количества листьев в полном бинарном дереве:**
    *   Пусть $n$ — количество вершин, $l$ — количество листьев, $i$ — количество внутренних вершин. Тогда $n = i + l$.
    *   В полном бинарном дереве каждая внутренняя вершина имеет 2 потомка. Каждое ребро исходит из внутренней вершины.
    *   Общее количество рёбер в дереве с $n$ вершинами равно $n-1$.
    *   Каждая внутренняя вершина имеет 2 исходящих ребра. Таким образом, общее количество исходящих рёбер из внутренних вершин равно $2i$.
    *   Каждое ребро в дереве является исходящим из какой-то вершины (кроме корня, если считать входящие).
    *   В полном бинарном дереве, если корень является внутренней вершиной, то $2i = n-1$.
    *   Подставим $i = n-l$: $2(n-l) = n-1 \Rightarrow 2n - 2l = n-1 \Rightarrow n = 2l - 1$.
    *   Из этого следует, что $l = (n+1)/2$.
    *   **Вывод:** В полном бинарном дереве с $n$ вершинами количество листьев $l = (n+1)/2$.
    *   **Альтернативное доказательство:** Пусть $L$ — количество листьев, $I$ — количество внутренних вершин. Каждая внутренняя вершина имеет 2 потомка. Каждая вершина, кроме корня, является потомком ровно одной вершины.
        *   Общее количество потомков = $2I$.
        *   Общее количество вершин, которые являются потомками = $N-1$ (все, кроме корня).
        *   Значит, $2I = N-1$.
        *   Так как $N = I+L$, подставим $I = N-L$: $2(N-L) = N-1 \Rightarrow 2N - 2L = N-1 \Rightarrow N = 2L - 1$.
        *   Отсюда $L = (N+1)/2$.

---

### 6. Построение остовных деревьев: алгоритмы Прима-Ярника и Краскала. Построение попарно непересекающихся остовных деревьев (алгоритм + теорема с док-вом).

#### Остовное дерево (Spanning Tree)

*   **Определение:** Подграф связного неориентированного графа $G$, который является деревом и содержит все вершины $G$.
*   **Минимальное остовное дерево (MST - Minimum Spanning Tree):** Остовное дерево взвешенного графа, сумма весов рёбер которого минимальна.

#### Алгоритмы построения минимальных остовных деревьев

1.  **Алгоритм Прима-Ярника (Prim's Algorithm)**
    *   **Принцип:** Начинает с произвольной вершины и постепенно "разрастается", добавляя к текущему дереву ребро с минимальным весом, которое соединяет вершину из дерева с вершиной вне дерева.
    *   **Алгоритм:**
        1.  Выбрать произвольную стартовую вершину $s$ и добавить её в множество вершин $V_{MST}$ будущего MST.
        2.  Инициализировать множество рёбер $E_{MST}$ пустым.
        3.  Пока $V_{MST}$ не содержит все вершины графа:
            *   Найти ребро $(u, v)$ с минимальным весом, где $u \in V_{MST}$ и $v \notin V_{MST}$.
            *   Добавить $v$ в $V_{MST}$ и $(u, v)$ в $E_{MST}$.
    *   **Сложность:** $O(E \log V)$ или $O(E + V \log V)$ с использованием кучи Фибоначчи, $O(V^2)$ с использованием массива.

2.  **Алгоритм Краскала (Kruskal's Algorithm)**
    *   **Принцип:** Сортирует все рёбра графа по возрастанию веса и добавляет их в MST, если добавление не создает цикл.
    *   **Алгоритм:**
        1.  Создать лес, где каждая вершина графа является отдельным деревом.
        2.  Создать список всех рёбер графа и отсортировать их по возрастанию веса.
        3.  Для каждого ребра $(u, v)$ из отсортированного списка:
            *   Если $u$ и $v$ находятся в разных компонентах связности (т.е. добавление ребра не создаст цикл):
                *   Добавить ребро $(u, v)$ в MST.
                *   Объединить компоненты связности, содержащие $u$ и $v$.
        4.  Продолжать до тех пор, пока не будет $n-1$ ребро в MST (или пока все вершины не будут в одной компоненте).
    *   **Сложность:** $O(E \log E)$ или $O(E \log V)$ (так как $E \le V^2$, $\log E \approx \log V^2 = 2 \log V$). Использует структуру данных "система непересекающихся множеств" (Disjoint Set Union - DSU).

#### Построение попарно непересекающихся остовных деревьев (алгоритм + теорема с док-вом)

*   **Определение:** Два остовных дерева $T_1$ и $T_2$ называются **попарно непересекающимися по рёбрам**, если $E(T_1) \cap E(T_2) = \emptyset$.
*   **Теорема (Р. Грэхем, 1971):** Для любого связного графа $G$ с $n$ вершинами существует $k$ попарно непересекающихся по рёбрам остовных деревьев тогда и только тогда, когда $G$ является $k$-реберно-связным.
    *   **Пояснение:** Если граф $k$-реберно-связен, это означает, что для его разделения на две компоненты требуется удалить не менее $k$ рёбер. Эта теорема утверждает, что такая связность достаточна для существования $k$ непересекающихся остовных деревьев.
*   **Алгоритм (обобщенный, без детального док-ва):**
    1.  **Идея:** Используется модификация алгоритма Прима или Краскала. Для построения $k$ непересекающихся остовных деревьев, можно последовательно строить каждое дерево, удаляя использованные рёбра из графа для последующих деревьев. Однако это не гарантирует оптимальность или существование.
    2.  **Более сложный подход (на основе потоков):** Задача может быть сведена к задаче о максимальном потоке. Создается вспомогательная сеть, где вершины графа "раздваиваются", и рёбрам присваиваются пропускные способности. Поиск $k$ непересекающихся остовных деревьев эквивалентен поиску $k$ непересекающихся путей в этой сети.
    3.  **Доказательство (кратко):** Доказательство теоремы Грэхема сложное и выходит за рамки стандартного коллоквиума. Оно обычно опирается на теорию матроидов или на более продвинутые конструкции потоков в сетях. Основная идея заключается в том, что если граф $k$-реберно-связен, то существует достаточно "резервных" рёбер, чтобы построить $k$ независимых остовных структур.

---

### 7. Матрица Кирхгофа (определение и свойства с док-вами). Теорема Кирхгофа. Следствия. Формула Кэли.

#### Матрица Кирхгофа (Лапласиан)

*   **Определение:** Для неориентированного графа $G$ с $n$ вершинами, матрица Кирхгофа $L$ (или Лапласиан) размера $n \times n$ определяется как $L = D - A$, где $D$ — диагональная матрица степеней, а $A$ — матрица смежности.
    *   **Элементы матрицы:**
        *   $L_{ii} = \text{deg}(v_i)$ (степень вершины $v_i$).
        *   $L_{ij} = -1$, если $v_i$ и $v_j$ смежны ($i \ne j$).
        *   $L_{ij} = 0$, если $v_i$ и $v_j$ не смежны ($i \ne j$).
*   **Для ориентированных графов:** $L_{ii}$ — исходящая степень вершины $v_i$. $L_{ij} = -1$, если есть ребро $(v_i, v_j)$.

#### Свойства матрицы Кирхгофа (с доказательствами)

1.  **Сумма элементов по строкам (и столбцам) равна нулю.**
    *   **Доказательство:** Для любой строки $i$: $\sum_{j=1}^n L_{ij} = L_{ii} + \sum_{j \ne i} L_{ij}$. По определению, $L_{ii} = \text{deg}(v_i)$, а $\sum_{j \ne i} L_{ij}$ — это сумма $-1$ для каждого соседа $v_i$. Поскольку количество соседей равно $\text{deg}(v_i)$, то $\sum_{j \ne i} L_{ij} = -\text{deg}(v_i)$. Следовательно, $\sum_{j=1}^n L_{ij} = \text{deg}(v_i) - \text{deg}(v_i) = 0$.
    *   Для неориентированных графов матрица симметрична, поэтому сумма по столбцам также равна нулю.

2.  **Детерминант матрицы равен нулю.**
    *   **Доказательство:** Поскольку сумма элементов по каждой строке равна нулю, это означает, что сумма всех столбцов матрицы дает нулевой вектор. Это свидетельствует о линейной зависимости столбцов (или строк). Из линейной алгебры известно, что если столбцы (или строки) матрицы линейно зависимы, то её определитель равен нулю.

3.  **Симметричность (только для неориентированных графов).**
    *   **Доказательство:** В неориентированном графе, если $v_i$ смежна с $v_j$, то и $v_j$ смежна с $v_i$. Следовательно, $A_{ij} = A_{ji}$. Также $\text{deg}(v_i)$ и $\text{deg}(v_j)$ — это диагональные элементы. Таким образом, $L_{ij} = -A_{ij}$ и $L_{ji} = -A_{ji}$, а $L_{ii} = \text{deg}(v_i)$. Поскольку $A$ симметрична, $L$ также симметрична.

4.  **Нуль является собственным числом.**
    *   **Доказательство:** Собственные числа $\lambda$ матрицы $L$ находятся из уравнения $\det(L - \lambda I) = 0$. Если подставить $\lambda = 0$, получим $\det(L)$. Поскольку мы уже доказали, что $\det(L) = 0$, то $\lambda = 0$ является собственным числом.

5.  **Кратность нуля как собственного числа равна количеству компонент связности (только для неориентированных графов).**
    *   **Доказательство (кратко):**
        *   **Кратность $\ge k$:** Если граф имеет $k$ компонент связности, то, переупорядочив вершины, матрицу Кирхгофа можно представить в блочно-диагональном виде, где каждый блок соответствует одной компоненте связности. Определитель такой матрицы равен произведению определителей блоков. Каждый блок является матрицей Кирхгофа для связного графа, и, следовательно, каждый блок имеет определитель 0. Таким образом, характеристический многочлен будет иметь множитель $\lambda^k$, что означает кратность нуля не менее $k$.
        *   **Кратность $= k$:** Для связного графа (т.е. $k=1$) нужно показать, что кратность нуля равна 1. Это можно доказать, показав, что ранг матрицы Кирхгофа для связного графа равен $n-1$. Ранг матрицы равен $n - \text{кратность нуля}$. Если ранг $n-1$, то кратность нуля равна 1. Ранг $n-1$ означает, что существует только один линейно независимый вектор, который при умножении на $L$ дает нулевой вектор (это вектор из единиц).

#### Теорема Кирхгофа (Матричная теорема о деревьях)

*   **Формулировка:** Для любого связного неориентированного графа $G$ с $n$ вершинами, количество различных остовных деревьев равно любому алгебраическому дополнению матрицы Кирхгофа $L$. То есть, если $L_{ij}$ — элемент матрицы Кирхгофа, то количество остовных деревьев равно $(-1)^{i+j} \det(M_{ij})$, где $M_{ij}$ — минор, полученный удалением $i$-й строки и $j$-й столбца из $L$. На практике обычно берут минор $M_{11}$.
*   **Пояснение:** Эта теорема предоставляет мощный инструмент для подсчета остовных деревьев, что является нетривиальной задачей для больших графов.

#### Следствия: Формула Кэли

*   **Формула Кэли:** Количество помеченных остовных деревьев на $n$ вершинах (т.е. остовных деревьев полного графа $K_n$) равно $n^{n-2}$ для $n \ge 2$.
*   **Доказательство (через теорему Кирхгофа):**
    1.  Рассмотрим полный граф $K_n$. Матрица смежности $A$ для $K_n$ имеет 0 на диагонали и 1 везде, кроме диагонали.
    2.  Матрица степеней $D$ для $K_n$ имеет $(n-1)$ на диагонали и 0 везде, кроме диагонали.
    3.  Матрица Кирхгофа $L = D - A$ для $K_n$ будет иметь $(n-1)$ на диагонали и $-1$ везде, кроме диагонали.
    4.  Согласно теореме Кирхгофа, количество остовных деревьев равно любому алгебраическому дополнению $L$. Возьмем минор $M_{11}$.
    5.  Минор $M_{11}$ — это матрица $(n-1) \times (n-1)$, где на диагонали стоят $n-1$, а вне диагонали $-1$.
    6.  Вычисление определителя такой матрицы: $\det(M_{11}) = n^{n-2}$. Это стандартный результат из линейной алгебры для матрицы вида $aI + bJ$ (где $I$ — единичная матрица, $J$ — матрица из единиц).
    *   **Вывод:** Таким образом, количество остовных деревьев в $K_n$ равно $n^{n-2}$.

---

### 8. Неизоморфные деревья (в том числе бинарные). Число попарно неизоморфных бинарных корневых деревьев и его связь с числами Каталана (с док-вом).

#### Неизоморфные деревья

*   **Определение:** Деревья, которые не могут быть преобразованы друг в друга путем переименования вершин.
*   **Проблема:** Подсчет количества неизоморфных деревьев с $n$ вершинами является сложной задачей. Для малых $n$ это можно сделать вручную, но для больших $n$ используются более сложные комбинаторные методы (например, с использованием производящих функций и теоремы Пойа).
    *   Например, для $n=1, 2, 3, 4, 5, 6$ количество неизоморфных деревьев равно $1, 1, 1, 2, 3, 6$.

#### Число попарно неизоморфных бинарных корневых деревьев и его связь с числами Каталана

*   **Корневое бинарное дерево:** Бинарное дерево, в котором одна вершина выделена как корень.
*   **Числа Каталана ($C_n$):** Последовательность натуральных чисел, которая встречается во многих комбинаторных задачах.
    *   $C_0 = 1, C_1 = 1, C_2 = 2, C_3 = 5, C_4 = 14, C_5 = 42, \dots$
    *   **Рекуррентная формула:** $C_n = \sum_{i=0}^{n-1} C_i C_{n-1-i}$ для $n \ge 1$.
    *   **Явная формула:** $C_n = \frac{1}{n+1} \binom{2n}{n}$.

*   **Связь с бинарными деревьями (с доказательством):**
    *   **Утверждение:** Число попарно неизоморфных бинарных корневых деревьев с $n$ вершинами (или $n$ внутренними узлами, или $n+1$ листьями) равно $C_n$.
    *   **Доказательство (через рекуррентную формулу):**
        1.  Пусть $B_n$ — количество неизоморфных бинарных корневых деревьев с $n$ вершинами.
        2.  **Базовый случай:**
            *   $n=0$: Пустое дерево (или дерево с 0 внутренними узлами, 1 листом). $B_0 = 1 = C_0$.
            *   $n=1$: Дерево с одной вершиной (корнем). $B_1 = 1 = C_1$.
        3.  **Рекурсивный шаг:** Рассмотрим бинарное корневое дерево с $n$ вершинами. Корень имеет либо 0, либо 1, либо 2 потомка.
            *   Если корень имеет 0 потомков, это дерево из одной вершины.
            *   Если корень имеет 1 потомка (левого или правого), то оставшиеся $n-1$ вершин образуют поддерево.
            *   Если корень имеет 2 потомка (левого и правого), то левое поддерево имеет $i$ вершин, а правое поддерево имеет $n-1-i$ вершин, где $i$ может быть от $0$ до $n-1$.
        4.  **Формализация:** Количество бинарных деревьев с $n$ вершинами можно выразить как:
            $B_n = \sum_{i=0}^{n-1} B_i B_{n-1-i}$
            *   Здесь $B_i$ — количество способов построить левое поддерево с $i$ вершинами, а $B_{n-1-i}$ — количество способов построить правое поддерево с $n-1-i$ вершинами. Суммирование идет по всем возможным разбиениям оставшихся $n-1$ вершин между левым и правым поддеревьями.
            *   Это рекуррентное соотношение в точности совпадает с рекуррентной формулой для чисел Каталана: $C_n = \sum_{i=0}^{n-1} C_i C_{n-1-i}$.
        5.  **Вывод:** Поскольку $B_n$ удовлетворяет той же рекуррентной формуле и имеет те же базовые случаи, что и $C_n$, то $B_n = C_n$.

*   **Другие комбинаторные интерпретации чисел Каталана:**
    *   Количество правильных скобочных последовательностей из $n$ пар скобок.
    *   Количество способов триангуляции выпуклого $n+2$-угольника на $n$ треугольников.
    *   Количество путей Дика (путей на решетке от $(0,0)$ до $(2n,0)$ с шагами $(1,1)$ и $(1,-1)$, не опускающихся ниже оси $x$).

---

### 9. Вычисление матрицы кратчайших расстояний. Кратчайшие пути: алгоритмы Дейкстры и Флойда-Уоршелла. Метод северо-западного угла.

#### Вычисление матрицы кратчайших расстояний

*   **Определение:** Матрица кратчайших расстояний $D$ для графа с $n$ вершинами — это матрица $n \times n$, где элемент $D_{ij}$ содержит длину кратчайшего пути от вершины $i$ до вершины $j$. Если пути нет, расстояние считается бесконечным.
*   **Методы вычисления:**
    *   **Для всех пар:** Алгоритм Флойда-Уоршелла.
    *   **Для одной вершины до всех остальных:** Алгоритм Дейкстры (повторенный $n$ раз для каждой стартовой вершины) или алгоритм Форда-Беллмана (повторенный $n$ раз).

#### Алгоритмы кратчайших путей

1.  **Алгоритм Дейкстры (Dijkstra's Algorithm)**
    *   **Назначение:** Находит кратчайшие пути от **одной стартовой вершины до всех остальных** в графе с **неотрицательными весами** рёбер.
    *   **Принцип:** Использует жадный подход, постепенно "расширяя" область известных кратчайших расстояний. Поддерживает множество вершин, для которых кратчайшее расстояние уже найдено, и выбирает следующую вершину с минимальным расстоянием из непосещенных.
    *   **Алгоритм:**
        1.  Инициализировать расстояния $d[v] = \infty$ для всех $v \ne s$, $d[s] = 0$.
        2.  Создать приоритетную очередь $Q$, содержащую все вершины, отсортированные по текущему расстоянию.
        3.  Пока $Q$ не пуста:
            *   Извлечь вершину $u$ с минимальным $d[u]$ из $Q$.
            *   Если $u$ уже была обработана, пропустить.
            *   Для каждого соседа $v$ вершины $u$:
                *   Если $d[u] + \text{weight}(u, v) < d[v]$:
                    *   $d[v] = d[u] + \text{weight}(u, v)$.
                    *   Обновить $v$ в $Q$ (или добавить, если не было).
    *   **Ограничения:** Не работает с отрицательными весами рёбер.
    *   **Сложность:** $O(E \log V)$ или $O(E + V \log V)$ с использованием приоритетной очереди (например, бинарной кучи).

2.  **Алгоритм Флойда-Уоршелла (Floyd-Warshall Algorithm)**
    *   **Назначение:** Находит кратчайшие пути **между всеми парами вершин** в графе. Работает с **отрицательными весами**, но **обнаруживает отрицательные циклы** (если расстояние от вершины до самой себя становится отрицательным).
    *   **Принцип:** Использует динамическое программирование. Рассматривает вершины по порядку как промежуточные точки на пути.
    *   **Алгоритм:**
        1.  Инициализировать матрицу расстояний $D$ так, что $D_{ij} = \text{weight}(i, j)$ (или $\infty$, если нет ребра), $D_{ii} = 0$.
        2.  Для каждой вершины $k$ от $1$ до $n$ (промежуточная вершина):
            *   Для каждой вершины $i$ от $1$ до $n$ (начальная вершина):
                *   Для каждой вершины $j$ от $1$ до $n$ (конечная вершина):
                    *   $D_{ij} = \min(D_{ij}, D_{ik} + D_{kj})$.
    *   **Обнаружение отрицательных циклов:** Если после выполнения алгоритма $D_{ii} < 0$ для какой-либо вершины $i$, то в графе существует отрицательный цикл, проходящий через $i$.
    *   **Сложность:** $O(V^3)$.

#### Метод северо-западного угла

*   **Назначение:** Это не алгоритм поиска кратчайших путей в графах, а метод для нахождения **начального опорного решения** в **транспортной задаче** (задаче линейного программирования).
*   **Принцип:** Начинает заполнение таблицы перевозок с левого верхнего (северо-западного) угла, удовлетворяя спрос и предложение по очереди, пока все запасы не будут распределены, а все потребности не будут удовлетворены.
*   **Пояснение:** Он не гарантирует оптимального решения, но дает быстрое начальное приближение.
*   **Вывод:** Этот метод не относится к алгоритмам поиска кратчайших путей в графах.

---

### 10. Потоки и сети. Остаточный путь. Леммы с док-вом. Алгоритм Форда-Фалкерсона.

#### Потоки и сети

*   **Транспортная сеть:** Ориентированный граф $G=(V, E)$ с выделенными вершинами **истоком** $S$ и **стоком** $T$, и функцией **пропускной способности** $c(u, v) \ge 0$ для каждого ребра $(u, v) \in E$.
*   **Поток:** Функция $f: V \times V \to \mathbb{R}$ такая, что для всех $u, v \in V$:
    1.  **Ограничение пропускной способности:** $0 \le f(u, v) \le c(u, v)$.
    2.  **Антисимметричность:** $f(u, v) = -f(v, u)$.
    3.  **Сохранение потока:** Для каждой вершины $v \in V \setminus \{S, T\}$, $\sum_{u \in V} f(u, v) = 0$ (сумма входящих потоков равна сумме исходящих).
*   **Величина потока ($|f|$):** Суммарный поток, выходящий из истока: $|f| = \sum_{v \in V} f(S, v)$. (Эквивалентно, суммарный поток, входящий в сток: $|f| = \sum_{u \in V} f(u, T)$).

#### Остаточная сеть (Residual Network) и увеличивающий путь (Augmenting Path)

*   **Остаточная пропускная способность:** Для ребра $(u, v)$ с пропускной способностью $c(u, v)$ и текущим потоком $f(u, v)$:
    *   $c_f(u, v) = c(u, v) - f(u, v)$ (сколько еще можно "долить" по прямому ребру).
    *   $c_f(v, u) = f(u, v)$ (сколько можно "отлить" по обратному ребру, уменьшив поток по $(u, v)$).
*   **Остаточная сеть:** Граф $G_f = (V, E_f)$, где $E_f$ содержит все рёбра $(u, v)$ с $c_f(u, v) > 0$.
*   **Увеличивающий путь (Augmenting Path):** Путь из истока $S$ в сток $T$ в остаточной сети. Каждое ребро на таком пути имеет строго положительную остаточную пропускную способность.

#### Леммы (с доказательством)

1.  **Лемма о максимальном потоке и увеличивающем пути:** Поток $f$ максимален тогда и только тогда, когда в остаточной сети $G_f$ не существует увеличивающего пути из $S$ в $T$.
    *   **Доказательство:**
        *   **($\Rightarrow$) Если $f$ максимален, то нет увеличивающего пути:** Предположим, что $f$ максимален, но существует увеличивающий путь $P$ из $S$ в $T$ в $G_f$. Пусть $\Delta = \min_{(u, v) \in P} c_f(u, v)$. Поскольку $P$ — увеличивающий путь, $\Delta > 0$. Мы можем увеличить поток вдоль $P$ на $\Delta$. Для каждого ребра $(u, v) \in P$, новый поток $f'(u, v) = f(u, v) + \Delta$. Этот новый поток $f'$ будет корректным (не нарушает ограничений пропускной способности и сохранения потока) и его величина $|f'| = |f| + \Delta > |f|$. Это противоречит предположению о максимальности $f$. Следовательно, если $f$ максимален, увеличивающего пути нет.
        *   **($\Leftarrow$) Если нет увеличивающего пути, то $f$ максимален:** Это следует из теоремы Форда-Фалкерсона о максимальном потоке и минимальном разрезе (см. билет 12). Если нет увеличивающего пути, то исток $S$ и сток $T$ разделены в остаточной сети. Это позволяет построить разрез, пропускная способность которого равна текущему потоку, что означает, что поток максимален.

2.  **Лемма о существовании маршрута при положительном потоке:** Если величина максимального потока $|f| > 0$, то существует маршрут из $S$ в $T$, проходящий только по ребрам с положительной пропускной способностью.
    *   **Доказательство:** Поскольку $|f| > 0$, из истока $S$ выходит положительный поток. Это означает, что существует хотя бы одно ребро $(S, v_1)$ с $f(S, v_1) > 0$. Если $v_1 = T$, путь найден. Если $v_1 \ne T$, то по закону сохранения потока, из $v_1$ должен выходить положительный поток, т.е. существует ребро $(v_1, v_2)$ с $f(v_1, v_2) > 0$. Продолжая этот процесс, мы либо достигнем $T$, либо попадем в цикл. Поскольку поток не может бесконечно циркулировать (если бы он циркулировал, его можно было бы удалить, уменьшив поток, но не изменив его величину), и количество вершин конечно, мы в конечном итоге должны достичь $T$.

#### Алгоритм Форда-Фалкерсона

*   **Назначение:** Находит максимальный поток в транспортной сети.
*   **Принцип:** Итеративно находит увеличивающие пути в остаточной сети и увеличивает поток вдоль них, пока таких путей не останется.
*   **Алгоритм:**
    1.  Инициализировать поток $f(u, v) = 0$ для всех рёбер $(u, v) \in E$.
    2.  Пока существует увеличивающий путь $P$ из $S$ в $T$ в остаточной сети $G_f$:
        *   Найти пропускную способность пути $\Delta = \min_{(u, v) \in P} c_f(u, v)$.
        *   Для каждого ребра $(u, v)$ на пути $P$:
            *   Увеличить поток $f(u, v)$ на $\Delta$.
            *   Уменьшить поток $f(v, u)$ на $\Delta$ (для антисимметричности).
    3.  Когда увеличивающих путей не останется, текущий поток $f$ является максимальным.
*   **Поиск увеличивающего пути:** Может быть выполнен с помощью BFS (алгоритм Эдмондса-Карпа) или DFS.
*   **Сложность:**
    *   Если используется BFS (Эдмондс-Карп), сложность $O(V E^2)$.
    *   Если используется DFS, сложность может быть $O(E \cdot |f|)$ в худшем случае, где $|f|$ — величина максимального потока. Это может быть очень медленно, если пропускные способности большие.

---

### 11. Минимальный и максимальный разрезы. Алгоритм Каргера (с весами и без).

#### Разрезы в сетях

*   **Разрез (S, T-разрез):** Разделение множества вершин $V$ на два непересекающихся подмножества $V_S$ и $V_T$ таких, что $S \in V_S$ и $T \in V_T$.
*   **Пропускная способность разреза $c(V_S, V_T)$:** Сумма пропускных способностей всех рёбер $(u, v)$, где $u \in V_S$ и $v \in V_T$.
*   **Минимальный разрез:** Разрез с наименьшей пропускной способностью.
*   **Максимальный разрез:** Разрез, пропускная способность которого максимальна. (В контексте потоков обычно говорят о минимальном разрезе, так как он связан с максимальным потоком. Задача о максимальном разрезе — это другая, NP-трудная задача).

#### Алгоритм Каргера (Karger's Algorithm)

*   **Назначение:** Находит минимальный разрез в неориентированном графе. Это вероятностный алгоритм.
*   **Принцип:** Основан на случайном сжатии рёбер. Идея в том, что ребра, не входящие в минимальный разрез, с большей вероятностью будут сжаты, чем ребра, входящие в него.
*   **Алгоритм (без весов):**
    1.  Пока в графе более двух вершин:
        *   Случайным образом выбрать ребро $(u, v)$ из графа.
        *   Сжать (объединить) вершины $u$ и $v$ в одну новую вершину $w$. Все рёбра, ранее инцидентные $u$ или $v$, теперь инцидентны $w$. Петли (рёбра из $w$ в $w$) удаляются. Кратные рёбра сохраняются.
    2.  Когда останутся две вершины, разрез между ними является кандидатом на минимальный разрез.
    3.  Повторить алгоритм много раз (например, $O(n^2 \log n)$ раз), чтобы увеличить вероятность нахождения минимального разреза.
*   **Вероятность успеха:** Вероятность того, что один запуск алгоритма Каргера найдет минимальный разрез, составляет не менее $2/(n(n-1))$. Повторение алгоритма $O(n^2 \log n)$ раз увеличивает вероятность успеха до $1 - 1/n$.
*   **Сложность:** $O(V^2)$ для одного запуска, $O(V^4 \log V)$ для получения высокой вероятности успеха.
*   **Алгоритм Каргера-Штайна (Karger-Stein):** Улучшенная версия, которая использует рекурсию и имеет сложность $O(V^2 \log^3 V)$.
*   **С весами:** Алгоритм Каргера можно адаптировать для взвешенных графов, выбирая ребра для сжатия с вероятностью, пропорциональной их весу.

---

### 12. Критические пути в сетевом графике. Теорема Форда-Фалкерсона о максимальном потоке и минимальном разрезе (с док-вом).

#### Критические пути в сетевом графике

*   **Назначение:** Это метод управления проектами (CPM - Critical Path Method), используемый для планирования, управления и контроля сложных проектов. Он не относится напрямую к алгоритмам поиска кратчайших путей в графах или потокам в сетях, но использует графовые модели.
*   **Сетевой график:** Ориентированный ациклический граф (DAG), где вершины представляют события (вехи) или задачи, а рёбра — работы (действия) с указанием их длительности.
*   **Критический путь:** Самый длинный путь от начального события до конечного события в сетевом графике. Длительность критического пути определяет минимальное время выполнения всего проекта. Задачи на критическом пути не имеют временного резерва, и любая задержка в их выполнении приведет к задержке всего проекта.
*   **Поиск критического пути:** Используются алгоритмы для нахождения самого длинного пути в DAG (что эквивалентно поиску кратчайшего пути в графе с отрицательными весами, где веса — это отрицательные длительности задач).

#### Теорема Форда-Фалкерсона о максимальном потоке и минимальном разрезе (с доказательством)

*   **Формулировка:** В любой транспортной сети максимальная величина потока из истока $S$ в сток $T$ равна минимальной пропускной способности разреза $(S, T)$.
*   **Доказательство:**
    1.  **Лемма 1: Величина любого потока не превышает пропускной способности любого разреза.**
        *   Пусть $f$ — любой поток, а $(V_S, V_T)$ — любой разрез.
        *   Величина потока $|f| = \sum_{u \in V_S} \sum_{v \in V_T} f(u, v) - \sum_{u \in V_T} \sum_{v \in V_S} f(u, v)$. (Это следует из закона сохранения потока: сумма потоков, пересекающих разрез в прямом направлении, минус сумма потоков в обратном направлении).
        *   По определению потока, $f(u, v) \le c(u, v)$ и $f(u, v) \ge 0$. Также $f(v, u) \ge 0$.
        *   Следовательно, $|f| \le \sum_{u \in V_S} \sum_{v \in V_T} c(u, v) - 0 = c(V_S, V_T)$.
        *   Таким образом, $|f| \le c(V_S, V_T)$ для любого потока и любого разреза. Это означает, что максимальный поток $\le$ минимального разреза.

    2.  **Лемма 2: Если поток $f$ максимален, то в остаточной сети $G_f$ нет увеличивающего пути из $S$ в $T$.** (Доказано в билете 10).

    3.  **Доказательство равенства (построение разреза):**
        *   Пусть $f$ — максимальный поток. По Лемме 2, в остаточной сети $G_f$ нет увеличивающего пути из $S$ в $T$.
        *   Определим множество вершин $V_S = \{v \in V \mid \text{существует путь из } S \text{ в } v \text{ в } G_f\}$.
        *   Определим $V_T = V \setminus V_S$.
        *   Поскольку нет пути из $S$ в $T$ в $G_f$, то $S \in V_S$ и $T \in V_T$. Таким образом, $(V_S, V_T)$ является корректным разрезом.
        *   Рассмотрим любое ребро $(u, v)$ такое, что $u \in V_S$ и $v \in V_T$.
            *   Поскольку $u \in V_S$ и $v \notin V_S$, это означает, что в остаточной сети нет ребра $(u, v)$ с $c_f(u, v) > 0$.
            *   Это возможно только если $c_f(u, v) = c(u, v) - f(u, v) = 0$, то есть $f(u, v) = c(u, v)$.
        *   Рассмотрим любое ребро $(v, u)$ такое, что $v \in V_T$ и $u \in V_S$.
            *   Поскольку $v \in V_T$ и $u \in V_S$, это означает, что в остаточной сети нет ребра $(v, u)$ с $c_f(v, u) > 0$.
            *   Это возможно только если $c_f(v, u) = f(u, v) = 0$.
        *   Теперь вычислим величину потока через этот разрез:
            $|f| = \sum_{u \in V_S} \sum_{v \in V_T} f(u, v) - \sum_{u \in V_T} \sum_{v \in V_S} f(u, v)$
            $|f| = \sum_{u \in V_S} \sum_{v \in V_T} c(u, v) - \sum_{u \in V_T} \sum_{v \in V_S} 0$
            $|f| = \sum_{u \in V_S} \sum_{v \in V_T} c(u, v) = c(V_S, V_T)$.
        *   Таким образом, мы нашли разрез, пропускная способность которого равна величине максимального потока. Поскольку мы уже знаем, что любой поток $\le$ любому разрезу, этот разрез должен быть минимальным, а поток — максимальным.
*   **Вывод:** Теорема Форда-Фалкерсона устанавливает фундаментальную связь между потоками и разрезами, являясь одним из краеугольных камней комбинаторной оптимизации.

---

### 13. Раскраски графа Хроматическое число графа. Хроматический многочлен. Хроматический класс (с док-вом нижней оценки). Кликовое число графа.

#### Раскраска графа

*   **Правильная раскраска вершин:** Присвоение каждой вершине графа "цвета" таким образом, чтобы никакие две смежные вершины не имели одинакового цвета.
*   **$k$-раскрашиваемый граф:** Граф, который может быть правильно раскрашен $k$ цветами.

#### Хроматическое число графа ($\chi(G)$)

*   **Определение:** Минимальное количество цветов, необходимое для правильной раскраски вершин графа $G$.
*   **Пояснение:** Это мера "сложности" графа с точки зрения его структуры смежности.

#### Хроматический многочлен ($P(G, \lambda)$)

*   **Определение:** Многочлен, который для данного графа $G$ и целого числа $\lambda$ (количество доступных цветов) вычисляет количество способов правильно раскрасить вершины $G$ с использованием не более $\lambda$ цветов.
*   **Свойства:**
    *   $P(G, \lambda)$ всегда является многочленом от $\lambda$.
    *   $P(G, \lambda) = 0$, если $\lambda < \chi(G)$.
    *   $P(G, \lambda) = \lambda^n$ для пустого графа с $n$ вершинами.
    *   $P(G, \lambda) = \lambda(\lambda-1)^{n-1}$ для дерева с $n$ вершинами.
    *   $P(G, \lambda) = P(G-e, \lambda) - P(G/e, \lambda)$ (формула удаления-стягивания), где $G-e$ — граф без ребра $e$, а $G/e$ — граф, где ребро $e$ стянуто (его концы объединены в одну вершину).

#### Хроматический класс (индекс) графа ($\chi'(G)$)

*   **Определение:** Минимальное количество цветов, необходимое для правильной раскраски рёбер графа $G$ таким образом, чтобы никакие два смежных ребра не имели одинакового цвета.
*   **Пояснение:** Это хроматическое число линейного графа $L(G)$, где вершины $L(G)$ соответствуют рёбрам $G$, а рёбра $L(G)$ соединяют смежные рёбра $G$.
*   **Нижняя оценка (с доказательством):**
    *   **Теорема:** Для любого графа $G$, $\chi'(G) \ge \Delta(G)$, где $\Delta(G)$ — максимальная степень вершины в $G$.
    *   **Доказательство:** Пусть $v$ — вершина с максимальной степенью $\Delta(G)$. Все $\Delta(G)$ рёбер, инцидентных $v$, являются попарно смежными. Следовательно, в любой правильной раскраске рёбер все эти $\Delta(G)$ рёбер должны иметь различные цвета. Таким образом, требуется как минимум $\Delta(G)$ цветов.
    *   **Теорема Визинга:** Для любого простого графа $G$, $\Delta(G) \le \chi'(G) \le \Delta(G) + 1$. Это означает, что хроматический класс может быть либо $\Delta(G)$, либо $\Delta(G)+1$.

#### Кликовое число графа ($\omega(G)$)

*   **Определение:** Размер наибольшей клики (полного подграфа) в графе $G$.
*   **Пояснение:** Кликовое число показывает, насколько "плотно" соединены некоторые части графа.
*   **Связь с хроматическим числом:** Для любого графа $G$, $\chi(G) \ge \omega(G)$. Это очевидно, так как все вершины клики должны иметь разные цвета. Однако обратное неверно (существуют графы с большим хроматическим числом, но малым кликовым числом, например, графы Грёча).

---

### 14. Двудольный граф. Паросочетания. Теорема Кёнига. Критерий двудольности графа (с док-вом). Двудольные графы и раскраски графов.

#### Двудольный граф

*   **Определение:** Неориентированный граф $G=(V, E)$ называется **двудольным**, если множество его вершин $V$ можно разбить на два непересекающихся подмножества $V_1$ и $V_2$ (доли) таких, что каждое ребро в $E$ соединяет вершину из $V_1$ с вершиной из $V_2$. Внутри $V_1$ и $V_2$ рёбер нет.
*   **Пояснение:** Граф, который можно раскрасить двумя цветами так, чтобы смежные вершины имели разные цвета.

#### Паросочетания (Matching)

*   **Определение:** Множество рёбер $M \subseteq E$ в графе $G$ такое, что никакие два ребра из $M$ не имеют общей вершины.
*   **Максимальное паросочетание:** Паросочетание, которое нельзя расширить, добавив еще одно ребро.
*   **Наибольшее паросочетание:** Паросочетание, содержащее максимальное количество рёбер.
*   **Совершенное паросочетание:** Паросочетание, которое покрывает все вершины графа.

#### Теорема Кёнига

*   **Формулировка:** В любом двудольном графе максимальный размер паросочетания равен минимальному размеру вершинного покрытия.
    *   **Вершинное покрытие:** Множество вершин $C \subseteq V$ такое, что каждое ребро графа инцидентно хотя бы одной вершине из $C$.
*   **Пояснение:** Эта теорема устанавливает важную связь между двумя, казалось бы, разными понятиями в двудольных графах.

#### Критерий двудольности графа (с доказательством)

*   **Формулировка:** Неориентированный граф является двудольным тогда и только тогда, когда он не содержит циклов нечётной длины.
*   **Доказательство:**
    *   **($\Rightarrow$) Если граф двудольный, то он не содержит нечётных циклов:**
        *   Пусть $G$ — двудольный граф с долями $V_1$ и $V_2$.
        *   Рассмотрим любой цикл в $G$. Начнем обход цикла из вершины $v \in V_1$.
        *   Первое ребро ведет в вершину из $V_2$. Второе ребро — в вершину из $V_1$. Третье — в $V_2$, и так далее.
        *   Чтобы вернуться в исходную вершину $v \in V_1$, путь должен пройти четное количество рёбер (каждое ребро меняет долю, поэтому для возвращения в ту же долю требуется четное число шагов).
        *   Следовательно, длина любого цикла в двудольном графе должна быть чётной.
    *   **($\Leftarrow$) Если граф не содержит нечётных циклов, то он двудольный:**
        *   Пусть $G$ — связный граф без нечётных циклов.
        *   Выберем произвольную вершину $s \in V$.
        *   Разделим вершины на два множества: $V_1 = \{v \in V \mid \text{расстояние от } s \text{ до } v \text{ чётно}\}$ и $V_2 = \{v \in V \mid \text{расстояние от } s \text{ до } v \text{ нечётно}\}$.
        *   Покажем, что в $V_1$ нет рёбер, и в $V_2$ нет рёбер.
        *   Предположим, что существует ребро $\{u, v\}$ такое, что $u, v \in V_1$. Тогда расстояния $d(s, u)$ и $d(s, v)$ оба чётные. Путь от $s$ до $u$ и путь от $s$ до $v$ вместе с ребром $\{u, v\}$ образуют цикл. Длина этого цикла будет $d(s, u) + d(s, v) + 1$ (если пути не пересекаются, или более сложная сумма, если пересекаются). В любом случае, если $d(s, u)$ и $d(s, v)$ имеют одинаковую четность, то $d(s, u) + d(s, v)$ будет чётным, а $d(s, u) + d(s, v) + 1$ будет нечётным. Это противоречит предположению, что граф не содержит нечётных циклов.
        *   Аналогично, если $u, v \in V_2$, то $d(s, u)$ и $d(s, v)$ оба нечётные. $d(s, u) + d(s, v)$ будет чётным, а $d(s, u) + d(s, v) + 1$ будет нечётным. Снова противоречие.
        *   Следовательно, все рёбра должны соединять вершины из $V_1$ с вершинами из $V_2$. Таким образом, граф является двудольным.
        *   Если граф несвязный, то каждую компоненту связности можно двудольно раскрасить независимо.

#### Двудольные графы и раскраски графов

*   **Связь:** Двудольный граф — это граф, хроматическое число которого равно 2 ($\chi(G) = 2$), при условии, что он не пустой (т.е. имеет хотя бы одно ребро). Если граф пустой, его хроматическое число равно 1.
*   **Алгоритм раскраски:** Критерий двудольности дает алгоритм для раскраски: можно использовать BFS или DFS, чтобы назначить цвета. Начиная с произвольной вершины, присвоить ей цвет 1. Всем её соседям присвоить цвет 2. Всем соседям соседей присвоить цвет 1, и так далее. Если в процессе обнаруживается, что смежные вершины должны иметь одинаковый цвет, то граф не является двудольным.

---

### 15. k-регулярные графы. Раскраска k-регулярных графов. Факторизация. Теорема Холла (с док-вом) и ее применения.

#### k-регулярные графы

*   **Определение:** Граф, в котором степень каждой вершины равна одному и тому же числу $k$.
*   **Примеры:** Полный граф $K_n$ является $(n-1)$-регулярным. Цикл $C_n$ является 2-регулярным.

#### Раскраска k-регулярных графов

*   **Раскраска рёбер:** Для $k$-регулярных графов, согласно теореме Визинга, хроматический класс $\chi'(G)$ равен либо $k$, либо $k+1$.
    *   **Теорема Кёнига (для регулярных двудольных графов):** Если $G$ является $k$-регулярным двудольным графом, то $\chi'(G) = k$. То есть, его рёбра можно раскрасить $k$ цветами.
*   **Раскраска вершин:** Хроматическое число $\chi(G)$ $k$-регулярного графа может быть любым числом от 2 до $k+1$ (для $K_{k+1}$).

#### Факторизация графа

*   **Определение:** $k$-фактор графа $G$ — это $k$-регулярный остовный подграф $G$.
*   **1-фактор (совершенное паросочетание):** 1-фактор — это совершенное паросочетание, то есть набор рёбер, который покрывает все вершины графа, и каждая вершина инцидентна ровно одному ребру из этого набора.
*   **Факторизация:** Разложение графа на непересекающиеся по рёбрам $k$-факторы.
*   **Теорема Петерсена:** Любой $2k$-регулярный граф без мостов имеет 2-фактор. Более того, любой $2k$-регулярный граф без мостов может быть разложен на $k$ 2-факторов.

#### Теорема Холла (с доказательством) и её применения

*   **Назначение:** Дает необходимое и достаточное условие для существования совершенного паросочетания в двудольном графе.
*   **Формулировка (Теорема о свадьбах):** Пусть $G=(V_1 \cup V_2, E)$ — двудольный граф. Существует паросочетание, которое покрывает все вершины из $V_1$ (т.е. каждое $v \in V_1$ инцидентно ребру из паросочетания) тогда и только тогда, когда для любого подмножества $A \subseteq V_1$, $|N(A)| \ge |A|$, где $N(A)$ — множество соседей вершин из $A$ в $V_2$.
*   **Пояснение:** "Каждая группа женихов должна иметь достаточно невест".
*   **Доказательство (кратко):**
    *   **Необходимость ($\Rightarrow$):** Если существует паросочетание $M$, покрывающее все вершины $V_1$, то для любого $A \subseteq V_1$, каждый $a \in A$ сопоставлен с уникальным соседом в $V_2$. Следовательно, $|N(A)| \ge |A|$.
    *   **Достаточность ($\Leftarrow$):** Доказывается методом от противного. Предположим, условие Холла выполняется, но паросочетания, покрывающего $V_1$, не существует.
        1.  Рассмотрим наибольшее паросочетание $M$. Пусть $u \in V_1$ — вершина, не покрытая $M$.
        2.  Построим "чередующийся путь" (alternating path) из $u$, где рёбра чередуются между не входящими в $M$ и входящими в $M$.
        3.  Если такой путь заканчивается в непокрытой вершине $v \in V_2$, то мы можем увеличить паросочетание, "переключив" рёбра на этом пути, что противоречит максимальности $M$.
        4.  Следовательно, все чередующиеся пути из $u$ должны заканчиваться в покрытых вершинах $V_1$ или $V_2$.
        5.  Рассмотрим множество $R$ всех вершин, достижимых из $u$ по чередующимся путям. Пусть $A = R \cap V_1$ и $B = R \cap V_2$.
        6.  По построению, для каждой вершины $x \in A \setminus \{u\}$, существует ребро из $M$, соединяющее $x$ с вершиной в $B$. Также для каждой вершины $y \in B$, существует ребро из $M$, соединяющее $y$ с вершиной в $A$.
        7.  Это означает, что $|A| = |B| + 1$ (если $u$ не покрыта).
        8.  Также $N(A) \subseteq B$. (Если бы существовал сосед $v \in N(A)$ такой, что $v \notin B$, то мы могли бы продлить чередующийся путь до $v$, что противоречило бы определению $R$).
        9.  Тогда $|N(A)| \le |B|$.
        10. Но по условию Холла, $|N(A)| \ge |A|$.
        11. Получаем $|A| \le |N(A)| \le |B|$. Но мы знаем, что $|A| = |B| + 1$.
        12. Это приводит к противоречию: $|B|+1 \le |B|$.
        13. Следовательно, наше исходное предположение о том, что паросочетания не существует, было ложным.
*   **Применения:**
    *   Планирование расписаний (например, назначение задач работникам).
    *   Распределение ресурсов.
    *   Доказательство существования совершенных паросочетаний в различных классах графов.

---

### 16. Реализация графов в трехмерном пространстве. Плоские графы. Планарные графы. Формула Эйлера (с док-вом). Гомеоморфные графы. Теорема Понтрягина-Куратовского.

#### Реализация графов в трехмерном пространстве

*   **Определение:** Любой граф может быть реализован (нарисован) в трехмерном евклидовом пространстве без пересечений рёбер. Вершины представляются точками, рёбра — кривыми, соединяющими эти точки.
*   **Пояснение:** В 3D-пространстве всегда можно "обойти" любое пересечение, подняв или опустив одно из рёбер. Это контрастирует с 2D-пространством, где не все графы могут быть нарисованы без пересечений.

#### Плоские графы (Plane Graphs)

*   **Определение:** Граф, который уже нарисован на плоскости таким образом, что его рёбра пересекаются только в вершинах.
*   **Пояснение:** Это конкретное вложение графа в плоскость.

#### Планарные графы (Planar Graphs)

*   **Определение:** Граф, который может быть нарисован на плоскости без пересечений рёбер (т.е. существует его плоское вложение).
*   **Пояснение:** Это свойство самого графа, а не конкретного рисунка. Если граф планарен, то существует хотя бы один способ нарисовать его на плоскости без пересечений.

#### Формула Эйлера для планарных графов (с доказательством)

*   **Формулировка:** Для любого связного плоского графа с $V$ вершинами, $E$ рёбрами и $F$ гранями (областями, на которые граф делит плоскость), выполняется соотношение: $V - E + F = 2$.
*   **Доказательство (индукцией по количеству рёбер $E$):**
    1.  **Базовый случай:** Пусть $E=0$. Тогда граф состоит из одной вершины ($V=1$) и одной грани (внешняя область, $F=1$). $1 - 0 + 1 = 2$. Формула верна.
    2.  **Индукционный переход:** Предположим, что формула верна для всех связных плоских графов с $E-1$ рёбрами. Рассмотрим связный плоский граф $G$ с $E$ рёбрами.
        *   **Случай 1: Граф $G$ содержит цикл.** Выберем любое ребро $e$, входящее в цикл. Удалим это ребро $e$. Получим новый граф $G'$.
            *   $G'$ по-прежнему связен.
            *   Количество рёбер в $G'$ равно $E-1$.
            *   Удаление ребра из цикла объединяет две грани, которые были разделены этим ребром. Таким образом, количество граней в $G'$ равно $F-1$.
            *   Количество вершин в $G'$ равно $V$.
            *   По индукционному предположению, для $G'$ выполняется $V - (E-1) + (F-1) = 2$.
            *   Раскрывая скобки, получаем $V - E + 1 + F - 1 = 2$, что упрощается до $V - E + F = 2$. Формула верна для $G$.
        *   **Случай 2: Граф $G$ не содержит циклов (т.е. является деревом).**
            *   Дерево с $V$ вершинами имеет $E = V-1$ рёбер.
            *   Дерево, будучи ациклическим, не делит плоскость на несколько областей; оно имеет только одну внешнюю грань. Следовательно, $F=1$.
            *   Подставим в формулу: $V - (V-1) + 1 = V - V + 1 + 1 = 2$. Формула верна для $G$.
    3.  **Вывод:** По принципу математической индукции, формула Эйлера верна для всех связных плоских графов.

#### Гомеоморфные графы

*   **Определение:** Два графа $G_1$ и $G_2$ называются **гомеоморфными**, если один может быть получен из другого путем последовательного применения операций:
    1.  Добавление новой вершины на ребро (т.е. замена ребра $(u, v)$ на два ребра $(u, w)$ и $(w, v)$).
    2.  Удаление вершины степени 2 (т.е. замена двух рёбер $(u, w)$ и $(w, v)$ на одно ребро $(u, v)$).
*   **Пояснение:** Гомеоморфные графы имеют по существу одинаковую "топологическую" структуру, отличаясь только наличием или отсутствием вершин степени 2 на рёбрах.

#### Теорема Понтрягина-Куратовского

*   **Формулировка:** Граф является планарным тогда и только тогда, когда он не содержит подграфов, гомеоморфных $K_5$ (полному графу с 5 вершинами) или $K_{3,3}$ (полному двудольному графу с 3 вершинами в каждой доле).
*   **Пояснение:** Эта теорема дает точный критерий планарности. $K_5$ и $K_{3,3}$ являются "минимальными" непланарными графами. Если в графе есть любая "копия" (гомеоморфная версия) одного из этих двух графов, то он не может быть нарисован на плоскости без пересечений.
