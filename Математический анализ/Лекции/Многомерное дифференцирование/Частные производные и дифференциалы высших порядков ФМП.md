# Частные производные и дифференциалы высших порядков

---

## 1. Обзор лекции

Лекция продолжает курс дифференциального исчисления функций нескольких переменных. В начале лектор напоминает результаты предыдущего занятия: производная вещественнозначной функции нескольких переменных есть линейный оператор, задаваемый строкой частных производных; этот оператор называется **градиентом**, а его геометрический смысл — направление наибольшего роста функции, причём норма градиента равна максимальной скорости роста. Затем разбирается приложение градиента к нахождению уравнения **касательной плоскости** к поверхности уровня: вектор нормали к плоскости совпадает с градиентом в данной точке. Далее лекция переходит к главной теме: **частные производные высших порядков**, их обозначения в нотации штрихов и "круглого D" (символа $\partial$), подсчёт их количества, а также ключевая теорема о равенстве смешанных производных. Затем вводятся **классы гладкости $C^k$** функций. В завершение обсуждаются **дифференциалы высших порядков**: формальный оператор дифференцирования $d$, дифференциал второго порядка $d^2 f$ для функции двух переменных и связь с формулой бинома через операторный язык. Итогом лекции является подготовка инструментария для формулы Тейлора и исследования на экстремум.

---

## 2. Предварительные сведения

- **Частная производная** $\frac{\partial f}{\partial x_i}$ — производная $f$ по переменной $x_i$ при фиксированных остальных переменных.
- **Производная функции нескольких переменных (дифференциал Фреше)** — линейный оператор $Df(x_0)$, задаваемый матрицей Якоби (для вещественнозначных функций — строкой).
- **Градиент** $\nabla f(x_0)$ — вектор, составленный из частных производных; одновременно является производной $Df(x_0)$ для $f \colon \mathbb{R}^n \to \mathbb{R}$.
- **Производная по направлению** $\frac{\partial f}{\partial \mathbf{v}}(x_0) = \langle \nabla f(x_0),\, \mathbf{e}_v \rangle$, где $\mathbf{e}_v$ — единичный вектор в направлении $\mathbf{v}$.
- **Поверхность уровня** функции $F \colon \mathbb{R}^3 \to \mathbb{R}$ — множество $\{(x,y,z) \mid F(x,y,z) = 0\}$.
- **Теорема Лагранжа (о среднем значении)** для дифференцируемой функции одной переменной: если $\varphi$ дифференцируема на $[a,b]$, то существует $c \in (a,b)$ такое, что $\varphi(b) - \varphi(a) = \varphi'(c)(b-a)$.
- **Дифференцируемость** функции в точке: $f(x_0 + h) = f(x_0) + L(h) + o(\|h\|)$, где $L$ — линейное отображение.

---

## 3. Основное содержание

### 3.1. Касательная плоскость к поверхности уровня (повторение и уточнение)

Пусть $F \colon \mathbb{R}^3 \to \mathbb{R}$ — дифференцируемая функция, $S = \{(x,y,z) \mid F(x,y,z) = 0\}$ — поверхность уровня, $M = (x_0, y_0, z_0) \in S$.

**Ключевое наблюдение.** Для любой гладкой кривой $\mathbf{r}(t) = (x(t), y(t), z(t))$, лежащей на $S$ и проходящей через $M$ при $t = t_0$, выполнено:

$$F(\mathbf{r}(t)) = 0 \quad \Rightarrow \quad \frac{d}{dt}F(\mathbf{r}(t))\Big|_{t=t_0} = 0.$$

По цепному правилу:

$$\frac{\partial F}{\partial x}\dot{x} + \frac{\partial F}{\partial y}\dot{y} + \frac{\partial F}{\partial z}\dot{z} = 0 \quad \Leftrightarrow \quad \langle \nabla F(M),\, \dot{\mathbf{r}}(t_0) \rangle = 0.$$

Таким образом, касательный вектор $\dot{\mathbf{r}}(t_0)$ любой кривой на $S$, проходящей через $M$, ортогонален вектору $\nabla F(M)$. Все такие касательные векторы лежат в одной плоскости.

**Определение 3.1 (касательная плоскость к поверхности уровня).** Касательной плоскостью к поверхности $F(x,y,z) = 0$ в точке $M = (x_0, y_0, z_0)$ называется плоскость, проходящая через $M$ и перпендикулярная вектору $\nabla F(M)$.

**Уравнение касательной плоскости:**

$$\frac{\partial F}{\partial x}(M)\,(x - x_0) + \frac{\partial F}{\partial y}(M)\,(y - y_0) + \frac{\partial F}{\partial z}(M)\,(z - z_0) = 0.$$

Здесь вектор нормали к плоскости — это $\mathbf{n} = \nabla F(M) = \left(\frac{\partial F}{\partial x}(M),\, \frac{\partial F}{\partial y}(M),\, \frac{\partial F}{\partial z}(M)\right)$.

МОТИВАЦИЯ: Касательная плоскость является наилучшим линейным приближением поверхности вблизи точки $M$. Это геометрическое понятие напрямую обобщает понятие касательной к кривой.

ИНТУИЦИЯ: Любая кривая, нарисованная на поверхности через точку $M$, имеет касательный вектор, лежащий в одной плоскости, — это и есть касательная плоскость. Вектор нормали перпендикулярен всем этим касательным.

ТИПИЧНЫЕ ОШИБКИ: Если $\nabla F(M) = \mathbf{0}$, касательная плоскость не определена — в такой точке поверхность может "иметь угол" или особенность. Также не путайте: уравнение $F(x,y,z) = c$ (поверхность уровня) и уравнение касательной плоскости — это разные объекты.

---

### 3.2. Частные производные высших порядков

#### 3.2.1. Определение

Пусть $f \colon D \subset \mathbb{R}^n \to \mathbb{R}$, и пусть существуют все частные производные первого порядка $\frac{\partial f}{\partial x_i}$. Каждая из них является функцией тех же переменных $x_1, \ldots, x_n$.

**Определение 3.2 (частная производная второго порядка).** Частной производной второго порядка функции $f$ по переменным $x_i$ и $x_j$ называется частная производная от $\frac{\partial f}{\partial x_i}$ по переменной $x_j$:

$$\frac{\partial^2 f}{\partial x_j \, \partial x_i} := \frac{\partial}{\partial x_j}\!\left(\frac{\partial f}{\partial x_i}\right).$$

В обозначении штрихами: $f''_{x_i x_j}$.

Замечание об обозначении: при записи $\frac{\partial^2 f}{\partial x_j \, \partial x_i}$ переменные читаются **справа налево** — сначала дифференцируют по $x_i$, затем по $x_j$. В обозначении штрихами порядок читается **слева направо**: $f''_{x_i x_j}$ означает сначала по $x_i$, затем по $x_j$. Это важный нюанс нотации.

**Символ $\partial$ ("рондо", "круглое D").** Это не дифференциал и не дробь. Выражение $\frac{\partial f}{\partial x}$ следует воспринимать как единый символ операции взятия частной производной. При возведении в степень:

$$\frac{\partial^2 f}{\partial x^2} = \left(\frac{\partial}{\partial x}\right)^2 f = \frac{\partial}{\partial x}\!\left(\frac{\partial f}{\partial x}\right)$$

— это оператор взятия производной, применённый дважды (то есть производная второго порядка), а **не** квадрат производной первого порядка.

**Определение 3.3 (частная производная $k$-го порядка).** Частная производная порядка $k$ функции $f$ по набору переменных $x_{i_1}, x_{i_2}, \ldots, x_{i_k}$ (где каждый индекс $i_j \in \{1, \ldots, n\}$) определяется рекурсивно:

$$\frac{\partial^k f}{\partial x_{i_k} \cdots \partial x_{i_1}} := \frac{\partial}{\partial x_{i_k}}\!\left(\frac{\partial^{k-1} f}{\partial x_{i_{k-1}} \cdots \partial x_{i_1}}\right),$$

при условии, что производная $(k-1)$-го порядка существует и допускает дифференцирование по $x_{i_k}$.

#### 3.2.2. Подсчёт количества частных производных

Для функции $f$ от $m$ переменных:
- Частных производных **1-го порядка**: $m$.
- Частных производных **2-го порядка** (в общем случае): $m^2$, поскольку для каждой из $m$ производных первого порядка можно взять производную ещё по каждой из $m$ переменных.
- Частных производных **$k$-го порядка**: $m^k$ (в общем случае).

Если некоторые производные совпадают (теорема о равенстве смешанных производных), то различных производных меньше, но в общем случае количество — $m^k$.

#### 3.2.3. Смешанные производные

Производные вида $\frac{\partial^2 f}{\partial x_i \, \partial x_j}$ при $i \neq j$ называются **смешанными** (или перекрёстными). Производные $\frac{\partial^2 f}{\partial x_i^2}$ — **чистыми**.

**Пример 3.1.** Найти все частные производные второго порядка функции $f(x, y) = x^y \cdot y^x$.

Прежде всего вычислим производные первого порядка.

Производная по $x$ (при фиксированном $y$: $x^y$ — степенная функция, $y^x$ — показательная):

$$\frac{\partial f}{\partial x} = y \cdot x^{y-1} \cdot y^x + x^y \cdot y^x \ln y.$$

Производная по $y$ (при фиксированном $x$: $x^y$ — показательная, $y^x$ — степенная):

$$\frac{\partial f}{\partial y} = x^y \ln x \cdot y^x + x^y \cdot x \cdot y^{x-1}.$$

Производная второго порядка $f''_{xx} = \frac{\partial^2 f}{\partial x^2}$ — берём $\frac{\partial f}{\partial x}$ ещё раз по $x$:

$$f''_{xx} = y(y-1)x^{y-2} \cdot y^x + y \cdot x^{y-1} \cdot y^x \ln y + y \cdot x^{y-1} \cdot y^x \ln y + x^y \cdot y^x (\ln y)^2.$$

Производная второго порядка $f''_{yy}$ — берём $\frac{\partial f}{\partial y}$ ещё раз по $y$:

$$f''_{yy} = x^y(\ln x)^2 \cdot y^x + 2 \cdot x^y \ln x \cdot x \cdot y^{x-1} + x^y \cdot x(x-1)y^{x-2}.$$

Смешанная производная $\frac{\partial^2 f}{\partial y \, \partial x}$ — берём $\frac{\partial f}{\partial x}$ по $y$ (это произведение, зависящее от $y$):

$$\frac{\partial^2 f}{\partial y \, \partial x} = \frac{\partial}{\partial y}\left(y x^{y-1} y^x + x^y y^x \ln y\right).$$

В лекции отмечается, что смешанные производные $\frac{\partial^2 f}{\partial y \, \partial x}$ и $\frac{\partial^2 f}{\partial x \, \partial y}$ для данной функции оказываются равными — это подтверждает общую теорему.

---

### 3.3. Теорема о равенстве смешанных производных (теорема Шварца)

МОТИВАЦИЯ: Возникает естественный вопрос: зависит ли результат от порядка дифференцирования? Для "хороших" функций ответ отрицателен, и это делает работу с частными производными высших порядков значительно удобнее.

**Теорема 3.1 (о равенстве смешанных производных).** Пусть функция $f(x, y)$ определена в окрестности точки $(x_0, y_0)$. Пусть в этой окрестности существуют обе смешанные частные производные $\frac{\partial^2 f}{\partial y \, \partial x}$ и $\frac{\partial^2 f}{\partial x \, \partial y}$, и обе они непрерывны в точке $(x_0, y_0)$. Тогда:

$$\frac{\partial^2 f}{\partial y \, \partial x}(x_0, y_0) = \frac{\partial^2 f}{\partial x \, \partial y}(x_0, y_0).$$

**Доказательство.**

Идея: ввести вспомогательную величину $W$, зависящую от $\Delta x$ и $\Delta y$, выразить её двумя способами и перейти к пределу.

**Шаг 1. Вспомогательная конструкция.** Для достаточно малых $\Delta x, \Delta y \neq 0$ рассмотрим:

$$W(\Delta x, \Delta y) = f(x_0 + \Delta x,\, y_0 + \Delta y) - f(x_0 + \Delta x,\, y_0) - f(x_0,\, y_0 + \Delta y) + f(x_0,\, y_0).$$

**Шаг 2. Первое представление.** Введём функцию одной переменной $x$:

$$\varphi(x) = f(x,\, y_0 + \Delta y) - f(x,\, y_0).$$

Тогда $W = \varphi(x_0 + \Delta x) - \varphi(x_0)$.

По условию функция $f$ имеет производные второго порядка в окрестности $(x_0, y_0)$, значит $\varphi$ дифференцируема по $x$ в этой окрестности:

$$\varphi'(x) = \frac{\partial f}{\partial x}(x,\, y_0 + \Delta y) - \frac{\partial f}{\partial x}(x,\, y_0).$$

По теореме Лагранжа существует $x_1$ между $x_0$ и $x_0 + \Delta x$ такое, что:

$$W = \varphi'(x_1) \cdot \Delta x = \left[\frac{\partial f}{\partial x}(x_1,\, y_0 + \Delta y) - \frac{\partial f}{\partial x}(x_1,\, y_0)\right] \Delta x.$$

Выражение в скобках — это разность значений $\frac{\partial f}{\partial x}$ как функции $y$. По теореме Лагранжа (снова) существует $y_1$ между $y_0$ и $y_0 + \Delta y$:

$$W = \frac{\partial^2 f}{\partial y \, \partial x}(x_1,\, y_1) \cdot \Delta x \cdot \Delta y.$$

Отсюда:

$$\frac{W}{\Delta x \, \Delta y} = \frac{\partial^2 f}{\partial y \, \partial x}(x_1,\, y_1),$$

где $(x_1, y_1)$ лежит внутри прямоугольника с углами $(x_0, y_0)$ и $(x_0 + \Delta x, y_0 + \Delta y)$.

**Шаг 3. Второе представление.** Аналогично вводим $\psi(y) = f(x_0 + \Delta x, y) - f(x_0, y)$ и применяем теорему Лагранжа сначала по $y$, затем по $x$. Получаем точки $x_2, y_2$ такие, что:

$$\frac{W}{\Delta x \, \Delta y} = \frac{\partial^2 f}{\partial x \, \partial y}(x_2,\, y_2).$$

**Шаг 4. Предельный переход.** Из шагов 2 и 3:

$$\frac{\partial^2 f}{\partial y \, \partial x}(x_1,\, y_1) = \frac{\partial^2 f}{\partial x \, \partial y}(x_2,\, y_2).$$

При $\Delta x \to 0$ и $\Delta y \to 0$ точки $(x_1, y_1)$ и $(x_2, y_2)$, сжатые внутри уменьшающегося прямоугольника, оба стремятся к $(x_0, y_0)$. В силу непрерывности обеих смешанных производных в точке $(x_0, y_0)$:

$$\frac{\partial^2 f}{\partial y \, \partial x}(x_0,\, y_0) = \frac{\partial^2 f}{\partial x \, \partial y}(x_0,\, y_0). \quad \square$$

ИНТУИЦИЯ: Результат дифференцирования не зависит от порядка, если производные достаточно "хорошие" (непрерывные). Это говорит о том, что операторы $\frac{\partial}{\partial x}$ и $\frac{\partial}{\partial y}$ "перестановочны" на классе $C^2$.

ТИПИЧНЫЕ ОШИБКИ: Непрерывность обеих смешанных производных в точке — существенное условие. Если его убрать, можно построить пример функции, у которой смешанные производные существуют, но не равны между собой. Также: смешанные производные должны существовать в окрестности точки (а не только в самой точке).

**Замечание 3.1 (обобщение на высшие порядки).** Теорема обобщается: для производных $k$-го порядка, если все они непрерывны, результат не зависит от порядка дифференцирования. То есть $f''_{x_i x_j} = f''_{x_j x_i}$ влечёт, например, $f'''_{xxy} = f'''_{xyx} = f'''_{yxx}$ при условии непрерывности всех этих производных. В частности, для функции $n$ переменных все производные порядка $k$ с одним и тем же набором (мультиндексом) переменных совпадают.

**Замечание 3.2.** Условие требует непрерывности смешанных производных **с одним и тем же набором переменных**. Например, $f'''_{xxy}$, $f'''_{xyx}$ и $f'''_{yxx}$ имеют одинаковый набор $\{x, x, y\}$ и при непрерывности равны, тогда как $f'''_{xyy}$ (набор $\{x,y,y\}$) им в общем случае не равна.

---

### 3.4. Классы гладкости $C^k$

МОТИВАЦИЯ: Удобно объединять функции со схожими свойствами гладкости в классы. Это позволяет кратко формулировать условия теорем.

**Определение 3.4 (класс $C^k(E)$).** Говорят, что функция $f$ принадлежит классу $C^k(E)$ (или является $k$ раз непрерывно дифференцируемой на множестве $E$), если все её частные производные порядка $k$ существуют и непрерывны на $E$.

Обозначение: $f \in C^k(E)$.

**Замечание 3.3.** Если $f \in C^1(E)$ (существуют непрерывные частные производные первого порядка), то $f$ дифференцируема на $E$ (в смысле Фреше). Такие функции называются **непрерывно дифференцируемыми**.

**Замечание 3.4.** Если $f \in C^2(E)$, то все частные производные второго порядка существуют и непрерывны, а значит и первого порядка тоже (как производные от $C^2$ функций). Такие функции иногда называют **дважды непрерывно дифференцируемыми** или **дважды гладкими**.

Иерархия классов:

$$C^\infty(E) \subset \cdots \subset C^2(E) \subset C^1(E) \subset C^0(E).$$

Для теории экстремума нам будет достаточно класса $C^2$.

ИНТУИЦИЯ: Класс $C^k$ означает, что функция "достаточно гладкая" — её можно дифференцировать $k$ раз без разрывов. Чем выше $k$, тем "лучше" функция.

---

### 3.5. Дифференциалы высших порядков

#### 3.5.1. Напоминание: дифференциал первого порядка

Для $f \in C^1$, $f \colon \mathbb{R}^n \to \mathbb{R}$, дифференциал первого порядка:

$$df = \sum_{i=1}^n \frac{\partial f}{\partial x_i} \, dx_i = \frac{\partial f}{\partial x_1} dx_1 + \frac{\partial f}{\partial x_2} dx_2 + \cdots + \frac{\partial f}{\partial x_n} dx_n.$$

Это линейная форма (линейная комбинация первой степени относительно $dx_1, \ldots, dx_n$), то есть однородный многочлен первой степени по $dx_i$.

МОТИВАЦИЯ: Дифференциал первого порядка — это главная линейная часть приращения функции. Дифференциалы высших порядков будут описывать следующие члены разложения (по аналогии с рядом Тейлора).

#### 3.5.2. Формальный оператор дифференцирования

**Определение 3.5 (формальный оператор $d$).** Введём формальный оператор:

$$d = \sum_{i=1}^n \frac{\partial}{\partial x_i} \, dx_i,$$

то есть $d$ действует на функцию $f$ следующим образом: место для $f$ пусто, а оператор «ждёт» функцию:

$$df = \left(\sum_{i=1}^n \frac{\partial}{\partial x_i} \, dx_i\right) f = \sum_{i=1}^n \frac{\partial f}{\partial x_i} \, dx_i.$$

Здесь $dx_i$ — зафиксированные вещественные числа (приращения аргументов), а $\frac{\partial}{\partial x_i}$ — операторы взятия частных производных. Их произведение понимается как: взять производную по $x_i$, затем умножить на число $dx_i$.

ИНТУИЦИЯ: Оператор $d$ — это "машина", которая берёт функцию и выдаёт её дифференциал. Числа $dx_i$ фиксируются как параметры (направление, в котором мы смотрим на приращение).

#### 3.5.3. Дифференциал второго порядка

**Определение 3.6 (дифференциал $k$-го порядка).** Дифференциал $k$-го порядка определяется как $k$-кратное применение оператора $d$ к функции $f$ (при фиксированных $dx_i$):

$$d^k f = \underbrace{d(d(\cdots(d}_{k} f)\cdots)).$$

Для $k = 2$:

$$d^2 f = d(df).$$

**Вычисление $d^2 f$ для $f(x,y)$.**

Раскрываем $d^2 f$, рассматривая оператор $d^2$ как квадрат суммы операторов:

$$d^2 = \left(\frac{\partial}{\partial x} dx + \frac{\partial}{\partial y} dy\right)^2.$$

Поскольку $dx$ и $dy$ — числа, а $\frac{\partial}{\partial x}$ и $\frac{\partial}{\partial y}$ — операторы, раскрываем по формуле квадрата суммы. Умножение операторов понимается как их **композиция** (последовательное применение):

$$d^2 = \left(\frac{\partial}{\partial x}\right)^2 (dx)^2 + 2 \frac{\partial^2}{\partial x \, \partial y} dx \, dy + \left(\frac{\partial}{\partial y}\right)^2 (dy)^2.$$

Здесь $\left(\frac{\partial}{\partial x}\right)^2 = \frac{\partial^2}{\partial x^2}$ — производная второго порядка, а $(dx)^2 = (dx)(dx)$ — квадрат числа $dx$.

Применяя к $f$:

$$d^2 f = \frac{\partial^2 f}{\partial x^2} (dx)^2 + 2 \frac{\partial^2 f}{\partial x \, \partial y} \, dx \, dy + \frac{\partial^2 f}{\partial y^2} (dy)^2.$$

Замечание: коэффициент $2$ перед смешанной производной берётся потому, что при раскрытии скобки $\left(\frac{\partial}{\partial x} dx + \frac{\partial}{\partial y} dy\right)^2$ возникают два перекрёстных слагаемых $\frac{\partial}{\partial x}\frac{\partial}{\partial y} dx \, dy$ и $\frac{\partial}{\partial y}\frac{\partial}{\partial x} dy \, dx$. При условии $f \in C^2$ теорема о равенстве смешанных производных гарантирует $\frac{\partial^2 f}{\partial x \, \partial y} = \frac{\partial^2 f}{\partial y \, \partial x}$, и оба слагаемых объединяются в одно с коэффициентом 2.

**Итоговая формула для $d^2 f$** ($f$ — функция двух переменных, $f \in C^2$):

$$d^2 f = \frac{\partial^2 f}{\partial x^2} (dx)^2 + 2 \frac{\partial^2 f}{\partial x \, \partial y} \, dx \, dy + \frac{\partial^2 f}{\partial y^2} (dy)^2.$$

#### 3.5.4. Операторный язык и формула бинома Ньютона

Ключевое наблюдение состоит в следующем: оператор $d$ применяется к функции $f$ по правилам алгебры операторов, и поскольку $dx_i$ — числа, формально выполняется **бином Ньютона**:

$$d^n f = \left(\frac{\partial}{\partial x} dx + \frac{\partial}{\partial y} dy\right)^n f = \sum_{k=0}^{n} \binom{n}{k} \frac{\partial^n f}{\partial x^k \, \partial y^{n-k}} (dx)^k (dy)^{n-k}.$$

При этом важно понимать:
- $\left(\frac{\partial}{\partial x}\right)^k$ — это оператор взятия $k$-й производной по $x$, то есть $\frac{\partial^k}{\partial x^k}$ (а **не** квадрат первой производной).
- $(dx)^k$ — это $(dx)^k$, обычная $k$-я степень числа $dx$.
- Условие применимости формулы бинома: $f \in C^n$, чтобы все производные $n$-го порядка существовали и смешанные производные были равны (что гарантирует биномиальные коэффициенты).

ИНТУИЦИЯ: Дифференциал $n$-го порядка $d^n f$ — это однородный многочлен степени $n$ по $dx$ и $dy$ (или вообще по $dx_1, \ldots, dx_m$). Первый дифференциал — линейная форма (степень 1), второй — квадратичная форма (степень 2), третий — кубическая и т.д.

СВЯЗИ: Эта конструкция является непосредственной подготовкой к **формуле Тейлора для функций нескольких переменных**:

$$f(x_0 + h) = f(x_0) + df\big|_{x_0} + \frac{1}{2!} d^2 f\big|_{x_0} + \cdots + \frac{1}{n!} d^n f\big|_{x_0} + R_n,$$

где $h = (dx_1, \ldots, dx_n)$ — вектор приращений, а $d^k f\big|_{x_0}$ вычисляется по формуле бинома.

**Пример 3.2.** Записать $d^2 f$ для $f(x,y,z)$.

$$d^2 f = \left(\frac{\partial}{\partial x} dx + \frac{\partial}{\partial y} dy + \frac{\partial}{\partial z} dz\right)^2 f$$

$$= \frac{\partial^2 f}{\partial x^2}(dx)^2 + \frac{\partial^2 f}{\partial y^2}(dy)^2 + \frac{\partial^2 f}{\partial z^2}(dz)^2 + 2\frac{\partial^2 f}{\partial x \partial y} dx \, dy + 2\frac{\partial^2 f}{\partial x \partial z} dx \, dz + 2\frac{\partial^2 f}{\partial y \partial z} dy \, dz.$$

(При условии $f \in C^2$, когда смешанные производные равны и объединяются.)

---

## 4. Справочный лист

### Уравнение касательной плоскости к поверхности $F(x,y,z) = 0$ в точке $M = (x_0, y_0, z_0)$:

$$F_x(M)(x - x_0) + F_y(M)(y - y_0) + F_z(M)(z - z_0) = 0,$$

где $F_x, F_y, F_z$ — частные производные, вектор нормали $\mathbf{n} = \nabla F(M)$.

### Частные производные высших порядков:

$$f''_{x_i x_j} = \frac{\partial^2 f}{\partial x_j \, \partial x_i} = \frac{\partial}{\partial x_j}\!\left(\frac{\partial f}{\partial x_i}\right).$$

Количество производных $k$-го порядка функции от $m$ переменных (в общем случае): $m^k$.

### Теорема о равенстве смешанных производных:

Если $\frac{\partial^2 f}{\partial x \, \partial y}$ и $\frac{\partial^2 f}{\partial y \, \partial x}$ существуют в окрестности $(x_0, y_0)$ и непрерывны в этой точке, то:

$$\frac{\partial^2 f}{\partial x \, \partial y}(x_0, y_0) = \frac{\partial^2 f}{\partial y \, \partial x}(x_0, y_0).$$

### Классы гладкости:

$f \in C^k(E)$ — все частные производные порядка $k$ существуют и непрерывны на $E$.

### Формальный оператор дифференцирования:

$$d = \sum_{i=1}^n \frac{\partial}{\partial x_i} \, dx_i, \qquad df = \sum_{i=1}^n \frac{\partial f}{\partial x_i} \, dx_i.$$

### Дифференциал второго порядка (функция двух переменных, $f \in C^2$):

$$d^2 f = \frac{\partial^2 f}{\partial x^2}(dx)^2 + 2\frac{\partial^2 f}{\partial x \, \partial y} \, dx \, dy + \frac{\partial^2 f}{\partial y^2}(dy)^2.$$

### Дифференциал $n$-го порядка (функция двух переменных, $f \in C^n$):

$$d^n f = \sum_{k=0}^{n} \binom{n}{k} \frac{\partial^n f}{\partial x^k \, \partial y^{n-k}} (dx)^k (dy)^{n-k}.$$

### Степень однородности дифференциалов по $dx_i$:

$d^k f$ — однородный многочлен степени $k$ относительно $dx_1, \ldots, dx_n$.

---

## 5. Концептуальное резюме

Лекция выстраивает мост между дифференцированием первого порядка и аппаратом высших производных, необходимым для анализа экстремумов функций нескольких переменных. Градиент и касательная плоскость завершают геометрическую часть, демонстрируя, как линейная алгебра (нормаль к плоскости) связана с дифференцированием. Затем рекурсивное определение частных производных высших порядков приводит к ключевому результату — теореме о равенстве смешанных производных, которая позволяет без оговорок переставлять операторы $\frac{\partial}{\partial x_i}$ для достаточно гладких функций. Классы $C^k$ формализуют понятие "достаточной гладкости". Наконец, формальный операторный язык дифференциалов высших порядков позволяет элегантно записать $d^n f$ через бином Ньютона — это непосредственная подготовка к формуле Тейлора, с помощью которой будут доказываться достаточные условия экстремума.

---

## 6. Связи с более широкой математикой

**Формула Тейлора для функций нескольких переменных.** Дифференциалы $d^k f$ образуют члены разложения Тейлора. Следующая лекция будет посвящена именно этому.

**Квадратичные формы и теория экстремума.** Дифференциал второго порядка $d^2 f$ — квадратичная форма относительно $(dx, dy)$. Знакоопределённость этой формы (матрица Гессе $H_f$) является критерием локального экстремума:
- $H_f$ положительно определена $\Rightarrow$ локальный минимум,
- $H_f$ отрицательно определена $\Rightarrow$ локальный максимум,
- $H_f$ знаконеопределена $\Rightarrow$ седловая точка.

**Матрица Гессе.** Коэффициенты $d^2 f$ образуют симметричную матрицу вторых производных — матрицу Гессе $H_f = \left(\frac{\partial^2 f}{\partial x_i \partial x_j}\right)$. Симметричность (равенство $\frac{\partial^2 f}{\partial x_i \partial x_j} = \frac{\partial^2 f}{\partial x_j \partial x_i}$) гарантирована теоремой Шварца для $f \in C^2$.

**Машинное обучение и оптимизация.** Поиск минимума функции потерь в задачах машинного обучения — это в точности задача нахождения экстремума функции многих переменных (параметров модели). Производные высших порядков используются в методах второго порядка (метод Ньютона, квазиньютоновские методы).

**Дифференциальная геометрия.** Касательная плоскость к поверхности уровня — частный случай более общей конструкции касательного пространства к гладкому многообразию.

**Теорема Стокса и дифференциальные формы.** Формальный оператор $d$ является предшественником оператора внешнего дифференцирования в теории дифференциальных форм, где $d^2 = 0$ — фундаментальное тождество.
