
## 1. Обзор лекции

Лекция посвящена обобщению понятия производной на случай функций нескольких переменных. Отправная точка — желание измерять скорость изменения функции $f : \mathbb{R}^m \to \mathbb{R}^n$ не по всем координатам сразу, а вдоль фиксированного направления в пространстве аргументов. Вводится **производная по направлению** как предел разностного отношения при движении аргумента вдоль единичного вектора $\ell^0$, а частные производные оказываются её частным случаем — производными вдоль базисных векторов. Далее устанавливается связь матрицы Якоби с частными производными и доказывается **достаточное условие дифференцируемости**: непрерывность всех частных производных в окрестности точки. Для вещественнозначных функций матрица Якоби вырождается в вектор-строку, называемый **градиентом**. Выводятся два ключевых свойства градиента: формула выражения производной по направлению через скалярное произведение с градиентом и тот факт, что градиент указывает направление наискорейшего возрастания функции, а его длина равна максимальной скорости роста. В завершение доказывается, что градиент ортогонален любой гладкой кривой, лежащей на поверхности уровня и проходящей через данную точку — это фундамент для определения касательной плоскости, которое анонсируется на следующую лекцию.

---

## 2. Предварительные сведения

| Понятие | Краткое напоминание |
|---|---|
| Норма вектора | $\|x\| = \sqrt{x_1^2 + \cdots + x_m^2}$ |
| Орт вектора | $\ell^0 = \ell / \|\ell\|$ — единичный вектор того же направления |
| Предел функции многих переменных | $\lim_{h \to 0} g(h) = A$ означает $\|g(h) - A\| \to 0$ при $\|h\| \to 0$ |
| Дифференцируемость отображения (определение) | Существует линейный оператор $A$ (матрица Якоби): $f(x_0+h) = f(x_0) + Ah + o(\|h\|)$ |
| Матрица Якоби | Матрица $A$ из определения дифференцируемости; для $f:\mathbb{R}^m\to\mathbb{R}^n$ имеет размер $n \times m$ |
| Базисные векторы | $e_j = (0,\ldots,1,\ldots,0)^T$ — $j$-й стандартный базисный вектор |
| Теорема Лагранжа (о среднем) | Если $\varphi$ дифференцируема на $(a,b)$ и непрерывна на $[a,b]$, то $\exists\, \xi \in (a,b):\; \varphi(b)-\varphi(a) = \varphi'(\xi)(b-a)$ |
| Бесконечно малая $o(\|h\|)$ | Функция $\alpha(h)$ такая, что $\alpha(h)/\|h\| \to 0$ при $h \to 0$ |

---

## 3. Основное содержание

---

### 3.1. Производная по направлению

#### Определение 3.1.1 (Производная по направлению)

Пусть $f : D \subset \mathbb{R}^m \to \mathbb{R}$, точка $x_0 \in D$, $\ell \in \mathbb{R}^m \setminus \{0\}$ — произвольный вектор, $\ell^0 = \ell/\|\ell\|$ — его орт. **Производной функции $f$ по направлению $\ell$ в точке $x_0$** называется

$$
\frac{\partial f}{\partial \ell}(x_0) \;=\; \lim_{t \to 0^+} \frac{f(x_0 + t\,\ell^0) - f(x_0)}{t},
$$

если этот предел существует и конечен.

> **Замечание 3.1.1.** Предел берётся **односторонний** ($t \to 0^+$), поскольку при $t < 0$ аргумент смещается в направлении $-\ell$, то есть мы фактически вычисляли бы производную по противоположному направлению. Чтобы разграничить эти два понятия, ограничиваются положительными $t$.

> **Замечание 3.1.2.** В некоторых учебниках вместо орта $\ell^0$ подставляют сам вектор $\ell$ (без нормировки). Это другое определение; результат будет умножен на $\|\ell\|$. Мы придерживаемся нормированного варианта.

**МОТИВАЦИЯ.** Обычная производная вещественной функции одной переменной измеряет скорость изменения функции при увеличении аргумента. Когда аргумент многомерен, мы хотим сохранить тот же смысл, но зафиксировав конкретное направление в $\mathbb{R}^m$. При движении вдоль орта $\ell^0$ аргумент $x_0 + t\ell^0$ изменяется как функция единственного параметра $t > 0$, и функция $f$ по этому параметру становится обычной функцией одной переменной.

**ИНТУИЦИЯ.** Представьте рельеф местности: значение $f(x,y)$ — высота над точкой $(x,y)$. Производная по направлению $\ell$ показывает, с какой скоростью меняется высота, если двигаться из точки $x_0$ в направлении $\ell$. Разные направления дают разные скорости подъёма/спуска.

**СВЯЗИ.** При $m = 1$ производная по направлению совпадает с обычной (односторонней) производной.

---

#### Определение 3.1.2 (Частная производная)

Пусть $x = (x_1, \ldots, x_m)$, $e_j$ — $j$-й стандартный базисный вектор. **Частной производной** функции $f$ по переменной $x_j$ в точке $x_0$ называется

$$
\frac{\partial f}{\partial x_j}(x_0) \;=\; \lim_{t \to 0} \frac{f(x_0 + t\,e_j) - f(x_0)}{t},
$$

[восстановлено] где предел двусторонний ($t \to 0$), то есть рассматриваются как положительные, так и отрицательные приращения $t$.[/восстановлено]

**МОТИВАЦИЯ.** Если требуется понять, как функция реагирует на изменение лишь одной из $m$ переменных при фиксированных остальных, мы получаем ту же задачу, что и для функции одной переменной.

**ИНТУИЦИЯ.** $\partial f/\partial x_j$ — это производная функции $x_j \mapsto f(x_0^{(1)}, \ldots, x_0^{(j-1)}, x_j, x_0^{(j+1)}, \ldots, x_0^{(m)})$, то есть все координаты кроме $j$-й зафиксированы.

**СВЯЗЬ с производной по направлению.** Частная производная $\partial f/\partial x_j$ есть почти что производная по направлению $e_j$, с единственным отличием: в определении частной производной предел **двусторонний**, а в производной по направлению — **односторонний**. Если обе односторонние пределы совпадают, то частная производная совпадает с производной по направлению $e_j$.

---

#### Замечание 3.1.3 (Необходимые условия дифференцируемости)

Пусть $f : D \subset \mathbb{R}^m \to \mathbb{R}^n$ дифференцируема в точке $x_0$. Тогда:

1. $f$ **непрерывна** в точке $x_0$.
2. Существуют все частные производные $\dfrac{\partial f_i}{\partial x_j}(x_0)$ для $i = 1,\ldots,n$, $j = 1,\ldots,m$.
3. Существуют производные $f$ по любому направлению $\ell$ в точке $x_0$.

**КРИТИЧЕСКИ ВАЖНО:** Обратное **неверно**. Существование всех частных производных (и даже всех производных по направлениям) в точке **не гарантирует** дифференцируемости. Это принципиальное отличие от случая $m = 1$, где дифференцируемость равносильна существованию производной.

[восстановлено]
**Классический контрпример.** Рассмотрим
$$
f(x,y) = \begin{cases} \dfrac{xy}{x^2+y^2}, & (x,y)\neq(0,0),\\ 0, & (x,y)=(0,0). \end{cases}
$$
В точке $(0,0)$ обе частные производные равны нулю ($\partial f/\partial x = \partial f/\partial y = 0$), существуют все производные по направлениям, но $f$ не является непрерывной (а значит, и дифференцируемой) в $(0,0)$: предел вдоль прямой $y = x$ равен $1/2 \neq 0$.
[/восстановлено]

---

### 3.2. Матрица Якоби через частные производные

#### Замечание 3.2.1 (Структура матрицы Якоби)

Пусть $f : \mathbb{R}^m \to \mathbb{R}^n$, $f = (f_1, \ldots, f_n)^T$, дифференцируема в $x_0$. Матрица Якоби $J_f(x_0)$ имеет размер $n \times m$ и выглядит следующим образом:

$$
J_f(x_0) = \begin{pmatrix}
\dfrac{\partial f_1}{\partial x_1}(x_0) & \cdots & \dfrac{\partial f_1}{\partial x_m}(x_0) \\[10pt]
\vdots & \ddots & \vdots \\[4pt]
\dfrac{\partial f_n}{\partial x_1}(x_0) & \cdots & \dfrac{\partial f_n}{\partial x_m}(x_0)
\end{pmatrix}.
$$

В $i$-й строке стоят все частные производные $i$-й координатной функции $f_i$.

**Дифференциал** отображения $f$ в точке $x_0$ — это вектор
$$
df_{x_0}(h) = J_f(x_0)\, h,
$$
то есть результат умножения матрицы Якоби на вектор приращения $h$. При покоординатной записи $i$-я компонента дифференциала — это $\sum_{j=1}^{m} \dfrac{\partial f_i}{\partial x_j}(x_0)\, h_j$.

---

### 3.3. Достаточное условие дифференцируемости

#### Теорема 3.3.1 (Достаточное условие дифференцируемости)

Пусть $f : D \subset \mathbb{R}^m \to \mathbb{R}^n$, $x_0$ — внутренняя точка $D$. Если все частные производные $\dfrac{\partial f_i}{\partial x_j}$ **существуют в некоторой окрестности** точки $x_0$ и **непрерывны в самой точке $x_0$** (для всех $i = 1,\ldots,n$ и $j = 1,\ldots,m$), то $f$ **дифференцируема в точке $x_0$**.

**МОТИВАЦИЯ.** Определение дифференцируемости требует проверки существования $o(\|h\|)$ — это сложно делать напрямую в каждом конкретном случае. Данная теорема даёт удобный практический критерий: достаточно проверить непрерывность частных производных.

**ИНТУИЦИЯ.** Непрерывность частных производных означает, что «скорость изменения» по каждой оси меняется плавно. Это плавное изменение позволяет хорошо аппроксимировать функцию линейным оператором в малой окрестности точки.

---

#### Доказательство Теоремы 3.3.1

**Идея.** Сводим к скалярному случаю ($n=1$, $m=2$), потом комментируем общий случай. Применяем теорему Лагранжа, чтобы расписать приращение функции как сумму «приращений вдоль каждой оси», и используем непрерывность частных производных, чтобы заменить их значениями в точке $x_0$ с ошибкой $o(\|h\|)$.

**Шаг 0: Сведение к $n=1$.** Достаточно доказать теорему для $n=1$ (то есть для вещественнозначной функции), а затем применить его покоординатно к каждой функции $f_i$.

**Шаг 1: Сведение к $m=2$.** Для ясности доказываем при $m=2$; общий случай аналогичен (нужно сделать цепочку добавления/вычитания вспомогательных точек длиннее). Итак, рассматриваем $f(x,y)$, точку $(x_0, y_0)$ и приращение $h = (\Delta x, \Delta y)$.

**Шаг 2: Расщепление приращения.** Запишем приращение функции:
$$
\Delta f = f(x_0 + \Delta x,\; y_0 + \Delta y) - f(x_0, y_0).
$$
Прибавим и вычтем промежуточное значение $f(x_0 + \Delta x,\, y_0)$:
$$
\Delta f = \underbrace{\bigl[f(x_0+\Delta x,\, y_0+\Delta y) - f(x_0+\Delta x,\, y_0)\bigr]}_{A} + \underbrace{\bigl[f(x_0+\Delta x,\, y_0) - f(x_0,\, y_0)\bigr]}_{B}.
$$

**Шаг 3: Применение теоремы Лагранжа к слагаемому $B$.** В слагаемом $B$ зафиксирован $y = y_0$, а меняется только первая координата. Введём $\varphi(x) = f(x, y_0)$. По условию теоремы $\partial f/\partial x$ существует в окрестности $(x_0, y_0)$, значит $\varphi$ дифференцируема на отрезке $[x_0, x_0+\Delta x]$ (при достаточно малом $\Delta x$). По теореме Лагранжа:
$$
B = f(x_0+\Delta x,\, y_0) - f(x_0,\, y_0) = \frac{\partial f}{\partial x}(\xi_1,\, y_0)\cdot \Delta x,
$$
где $\xi_1$ лежит строго между $x_0$ и $x_0 + \Delta x$.

**Шаг 4: Использование непрерывности $\partial f/\partial x$.** По условию, $\partial f/\partial x$ непрерывна в $(x_0, y_0)$. Значит,
$$
\frac{\partial f}{\partial x}(\xi_1,\, y_0) = \frac{\partial f}{\partial x}(x_0,\, y_0) + \alpha(\xi_1),
$$
где $\alpha(\xi_1) \to 0$ при $\xi_1 \to x_0$ (что выполнено при $\Delta x \to 0$). Следовательно:
$$
B = \frac{\partial f}{\partial x}(x_0, y_0)\cdot\Delta x + \alpha(\xi_1)\cdot\Delta x.
$$

**Шаг 5: Применение теоремы Лагранжа к слагаемому $A$.** В слагаемом $A$ зафиксирована первая координата $x_0+\Delta x$, меняется только $y$. Введём $\psi(y) = f(x_0+\Delta x, y)$. Аналогично:
$$
A = \frac{\partial f}{\partial y}(x_0+\Delta x,\, \xi_2)\cdot\Delta y,
$$
где $\xi_2$ лежит строго между $y_0$ и $y_0 + \Delta y$. Используя непрерывность $\partial f/\partial y$ в $(x_0,y_0)$:
$$
\frac{\partial f}{\partial y}(x_0+\Delta x,\, \xi_2) = \frac{\partial f}{\partial y}(x_0, y_0) + \beta(\Delta x, \xi_2),
$$
где $\beta \to 0$ при $(\Delta x, \xi_2 - y_0) \to 0$, то есть при $h \to 0$. Следовательно:
$$
A = \frac{\partial f}{\partial y}(x_0, y_0)\cdot\Delta y + \beta(\Delta x, \xi_2)\cdot\Delta y.
$$

**Шаг 6: Сборка.** Итого:
$$
\Delta f = \frac{\partial f}{\partial x}(x_0,y_0)\cdot\Delta x + \frac{\partial f}{\partial y}(x_0,y_0)\cdot\Delta y + \alpha(\xi_1)\Delta x + \beta(\Delta x,\xi_2)\Delta y.
$$
В матричной записи:
$$
\Delta f = \underbrace{\begin{pmatrix}\dfrac{\partial f}{\partial x}(x_0,y_0) & \dfrac{\partial f}{\partial y}(x_0,y_0)\end{pmatrix}}_{J_f(x_0)} \begin{pmatrix}\Delta x \\ \Delta y\end{pmatrix} + \alpha(\xi_1)\Delta x + \beta(\Delta x,\xi_2)\Delta y.
$$

**Шаг 7: «Хвосты» суть $o(\|h\|)$.** Покажем, что $R = \alpha(\xi_1)\Delta x + \beta(\Delta x,\xi_2)\Delta y = o(\|h\|)$, где $\|h\| = \sqrt{(\Delta x)^2 + (\Delta y)^2}$.

Для первого слагаемого:
$$
\left|\frac{\alpha(\xi_1)\Delta x}{\|h\|}\right| \le |\alpha(\xi_1)|\cdot\frac{|\Delta x|}{\sqrt{(\Delta x)^2+(\Delta y)^2}} \le |\alpha(\xi_1)| \to 0 \quad \text{при } h\to 0,
$$
так как $|\Delta x|/\|h\| \le 1$, а $\xi_1 \in [x_0, x_0+\Delta x] \to x_0$, поэтому $\alpha(\xi_1) \to 0$.

Для второго слагаемого аналогично: $|\Delta y|/\|h\| \le 1$ и $\beta \to 0$, поэтому
$$
\left|\frac{\beta(\Delta x,\xi_2)\Delta y}{\|h\|}\right| \le |\beta(\Delta x,\xi_2)| \to 0.
$$

Таким образом, $R = o(\|h\|)$ при $h \to 0$.

**Вывод.** Получено разложение:
$$
f(x_0+h) = f(x_0) + J_f(x_0)\,h + o(\|h\|),
$$
что в точности является определением дифференцируемости $f$ в точке $x_0$. $\square$

**Замечание 3.3.1 (Общий $m$).** При $m > 2$ доказательство аналогично: приращение расщепляется в сумму $m$ слагаемых — по одному на каждую координату, к каждому применяется теорема Лагранжа. «Хвосты» оцениваются так же: $|\Delta x_j|/\|h\| \le 1$.

**Замечание 3.3.2 (Общий $n$).** При $n > 1$ рассматриваем каждую координатную функцию $f_i$ отдельно — применяем доказанное при $n=1$ — и объединяем строки матриц Якоби в одну матрицу.

**ТИПИЧНЫЕ ОШИБКИ:**
- Путать необходимые и достаточные условия: существование частных производных — лишь необходимо.
- Забыть, что точка $x_0$ должна быть **внутренней**: иначе нельзя сдвигаться во все стороны на вектор $h$.
- При применении теоремы Лагранжа не проверить, что функция дифференцируема на всём отрезке (это следует из существования частных производных в окрестности).

---

### 3.4. Градиент вещественнозначной функции

#### Определение 3.4.1 (Градиент)

Пусть $f : D \subset \mathbb{R}^m \to \mathbb{R}$ дифференцируема в точке $x_0 \in D$. Матрица Якоби $J_f(x_0)$ является вектором-строкой размера $1 \times m$. **Градиентом** функции $f$ в точке $x_0$ называется вектор (столбец)

$$
\nabla f(x_0) = \operatorname{grad} f(x_0) = \begin{pmatrix} \dfrac{\partial f}{\partial x_1}(x_0) \\ \vdots \\ \dfrac{\partial f}{\partial x_m}(x_0) \end{pmatrix} \in \mathbb{R}^m.
$$

[восстановлено] Таким образом, $J_f(x_0)$ и $\nabla f(x_0)$ содержат одни и те же числа, но трактуются по-разному: $J_f(x_0)$ — линейный оператор (строка), $\nabla f(x_0)$ — геометрический вектор в пространстве аргументов.[/восстановлено]

**МОТИВАЦИЯ.** При $n=1$ линейный оператор $J_f(x_0) : \mathbb{R}^m \to \mathbb{R}$ можно рассматривать как вектор в $\mathbb{R}^m$, действие которого на $h$ задаётся скалярным произведением $\langle \nabla f(x_0), h \rangle$. Это позволяет геометрически интерпретировать дифференциал.

**ИНТУИЦИЯ.** Градиент в каждой точке $x_0$ — это «стрелочка» в пространстве аргументов, показывающая, в каком направлении функция растёт быстрее всего. Совокупность таких стрелочек во всех точках области образует **поле градиентов** (векторное поле).

**Пример 3.4.1.** Пусть $f(x,y) = x^2 + y^2$ (параболоид вращения). Тогда

$$
\nabla f(x,y) = \begin{pmatrix} 2x \\ 2y \end{pmatrix}.
$$

В точке $(x,y)$ градиент — это вектор, направленный от начала координат радиально наружу с длиной $2\sqrt{x^2+y^2}$. Линии уровня $f = c$ — окружности радиуса $\sqrt{c}$; векторы градиента перпендикулярны этим окружностям (ортогональны касательным к ним).

---

### 3.5. Скалярное произведение (напоминание-введение)

#### Определение 3.5.1 (Скалярное произведение)

Для двух векторов $a = (a_1,\ldots,a_m)^T$ и $b = (b_1,\ldots,b_m)^T$ из $\mathbb{R}^m$ **скалярное произведение** определяется как

$$
\langle a, b \rangle = a \cdot b = a^T b = \sum_{k=1}^{m} a_k b_k \in \mathbb{R}.
$$

**Геометрический смысл.** Если $\varphi$ — угол между векторами $a$ и $b$, то

$$
\langle a, b \rangle = \|a\|\,\|b\|\cos\varphi.
$$

Скалярное произведение равно нулю тогда и только тогда, когда $a \perp b$ (при условии, что оба вектора ненулевые).

**Проекция.** Скалярное произведение $\langle a, \hat{n} \rangle$, где $\hat{n}$ — единичный вектор, равно **проекции вектора $a$ на направление $\hat{n}$**:
$$
\operatorname{pr}_{\hat{n}} a = \langle a, \hat{n} \rangle.
$$

---

### 3.6. Производная по направлению и градиент

#### Теорема 3.6.1 (Формула производной по направлению через градиент)

Пусть $f : D \subset \mathbb{R}^m \to \mathbb{R}$ дифференцируема в точке $x_0$, $\ell \in \mathbb{R}^m \setminus \{0\}$ — произвольное направление, $\ell^0 = \ell/\|\ell\|$. Тогда

$$
\boxed{\frac{\partial f}{\partial \ell}(x_0) = \langle \nabla f(x_0),\, \ell^0 \rangle = \sum_{j=1}^{m} \frac{\partial f}{\partial x_j}(x_0)\cdot \ell^0_j.}
$$

**МОТИВАЦИЯ.** Производную по направлению можно вычислять, не возвращаясь к определению через предел. Достаточно знать градиент и направление.

**ИНТУИЦИЯ.** Производная по направлению $\ell^0$ — это **проекция градиента на направление $\ell^0$**. Чем «ближе» направление к направлению градиента, тем больше производная.

---

#### Доказательство Теоремы 3.6.1

**Идея.** Подставим конкретный вектор $h = t\,\ell^0$ в условие дифференцируемости и разделим на $t$, устремив $t \to 0^+$.

**Шаг 1.** Так как $f$ дифференцируема в $x_0$, выполнено:
$$
f(x_0 + h) - f(x_0) = J_f(x_0)\,h + o(\|h\|) \quad \text{при } h \to 0.
$$

**Шаг 2.** Возьмём $h = t\,\ell^0$, $t \to 0^+$. Тогда $\|h\| = t\|\ell^0\| = t$ (так как $\|\ell^0\|=1$). Подставим:
$$
f(x_0 + t\,\ell^0) - f(x_0) = J_f(x_0)\,(t\,\ell^0) + o(t).
$$

**Шаг 3.** В силу линейности $J_f(x_0)$:
$$
J_f(x_0)\,(t\,\ell^0) = t\,J_f(x_0)\,\ell^0.
$$

**Шаг 4.** Делим на $t > 0$ и переходим к пределу:
$$
\frac{f(x_0 + t\,\ell^0) - f(x_0)}{t} = J_f(x_0)\,\ell^0 + \frac{o(t)}{t} \;\xrightarrow{t\to 0^+}\; J_f(x_0)\,\ell^0.
$$
Так как $o(t)/t \to 0$ по определению $o$-малого.

**Шаг 5.** По определению это и есть $\dfrac{\partial f}{\partial \ell}(x_0)$. Замечаем, что $J_f(x_0)\,\ell^0 = \langle \nabla f(x_0),\,\ell^0\rangle$. $\square$

**ТИПИЧНЫЕ ОШИБКИ:**
- Применять формулу к $\ell$ вместо $\ell^0$ (забыть нормировать).
- Использовать формулу, не проверив дифференцируемость $f$ в точке $x_0$.

---

### 3.7. Геометрический смысл градиента: направление наискорейшего возрастания

#### Теорема 3.7.1 (Максимум производной по направлению)

Пусть $f$ дифференцируема в $x_0$, $\nabla f(x_0) \neq 0$. Тогда:

1. Максимум производной по направлению
$$
\max_{\ell:\,\|\ell\|=1} \frac{\partial f}{\partial \ell}(x_0) = \|\nabla f(x_0)\|
$$
достигается при $\ell^0 = \dfrac{\nabla f(x_0)}{\|\nabla f(x_0)\|}$ (в направлении градиента).

2. Минимум (наибольшая скорость убывания) равен $-\|\nabla f(x_0)\|$ и достигается при $\ell^0 = -\dfrac{\nabla f(x_0)}{\|\nabla f(x_0)\|}$.

---

#### Доказательство Теоремы 3.7.1

По Теореме 3.6.1 и геометрическому смыслу скалярного произведения:
$$
\frac{\partial f}{\partial \ell}(x_0) = \langle \nabla f(x_0),\, \ell^0 \rangle = \|\nabla f(x_0)\|\,\|\ell^0\|\cos\varphi = \|\nabla f(x_0)\|\cos\varphi,
$$
где $\varphi$ — угол между $\nabla f(x_0)$ и $\ell^0$, и $\|\ell^0\| = 1$. Величина $\cos\varphi$ максимальна ($= 1$) при $\varphi = 0$, то есть при $\ell^0 \parallel \nabla f(x_0)$, и минимальна ($= -1$) при $\varphi = \pi$, то есть при $\ell^0 \parallel -\nabla f(x_0)$. $\square$

**ИНТУИЦИЯ.** Градиент «смотрит» в ту сторону, куда функция поднимается круче всего. Его длина — это «крутизна» самого крутого подъёма. Если проецировать градиент на различные направления, проекция наибольшая при совпадении направлений.

**Следствие 3.7.1.** В точке $x_0$, где $\nabla f(x_0) = 0$ (критическая точка), производная по любому направлению равна нулю — функция «стоит горизонтально» в линейном приближении.

---

### 3.8. Поверхности уровня и ортогональность градиента

#### Определение 3.8.1 (Поверхность уровня)

Пусть $f : D \subset \mathbb{R}^m \to \mathbb{R}$, $c \in \mathbb{R}$. **Поверхностью (множеством) уровня** функции $f$ при значении $c$ называется

$$
\Sigma_c = \{x \in D : f(x) = c\}.
$$

При $m = 2$ поверхность уровня — **линия уровня** (кривая на плоскости).
При $m = 3$ — **поверхность уровня** в пространстве (в обычном смысле).

**Пример.** Для $f(x,y) = x^2+y^2$ линии уровня $c > 0$ — окружности радиуса $\sqrt{c}$.

---

#### Теорема 3.8.1 (Ортогональность градиента к поверхности уровня)

Пусть $f : D \subset \mathbb{R}^m \to \mathbb{R}$ дифференцируема в $x_0 \in \Sigma_c$, $\gamma : [a,b] \to \Sigma_c$ — гладкая кривая, лежащая на поверхности уровня $\Sigma_c$ и проходящая через $x_0$ (то есть $\gamma(t_0) = x_0$ для некоторого $t_0 \in (a,b)$). Тогда

$$
\langle \nabla f(x_0),\; \gamma'(t_0) \rangle = 0.
$$

Иными словами, **градиент $\nabla f(x_0)$ ортогонален касательному вектору $\gamma'(t_0)$ к любой гладкой кривой, лежащей на $\Sigma_c$ и проходящей через $x_0$**.

**МОТИВАЦИЯ.** Это свойство объясняет перпендикулярность стрелочек градиента линиям уровня, наблюдаемую в примере с параболоидом. Более того, оно является основой для определения **касательной плоскости** к поверхности уровня.

---

#### Доказательство Теоремы 3.8.1

**Идея.** Кривая $\gamma$ лежит на $\Sigma_c$, значит $f(\gamma(t)) = c$ при всех $t$. Дифференцируем это тождество по $t$ и применяем правило дифференцирования сложной функции.

**Шаг 1.** Поскольку $\gamma(t) \in \Sigma_c$ для всех $t \in [a,b]$:
$$
f(\gamma(t)) = c \quad \forall\, t \in [a,b].
$$

**Шаг 2.** Функции $f$ и $\gamma$ дифференцируемы, значит их композиция $t \mapsto f(\gamma(t))$ дифференцируема. Дифференцируем обе части по $t$:
$$
\frac{d}{dt}\bigl[f(\gamma(t))\bigr] = \frac{d}{dt}[c] = 0.
$$

**Шаг 3.** По цепному правилу (правилу дифференцирования сложной функции):
$$
\frac{d}{dt}\bigl[f(\gamma(t))\bigr] = J_f(\gamma(t))\cdot\gamma'(t) = \langle \nabla f(\gamma(t)),\, \gamma'(t) \rangle.
$$

**Шаг 4.** При $t = t_0$ (то есть в точке $x_0 = \gamma(t_0)$):
$$
\langle \nabla f(x_0),\, \gamma'(t_0) \rangle = 0. \quad \square
$$

**ИНТУИЦИЯ.** Если двигаться вдоль поверхности уровня, $f$ не меняется (по определению). Градиент — вектор, «в направлении которого $f$ растёт». Если $f$ не меняется при движении вдоль касательной кривой, это именно потому, что касательный вектор перпендикулярен градиенту.

**Следствие 3.8.1.** Поскольку $\gamma'(t_0)$ — произвольный касательный вектор к $\Sigma_c$ в точке $x_0$, градиент $\nabla f(x_0)$ лежит в **нормальном пространстве** к $\Sigma_c$ в точке $x_0$. [восстановлено]Это даёт определение **касательной плоскости** к поверхности уровня: плоскость $\langle \nabla f(x_0), x - x_0 \rangle = 0$ является касательной плоскостью к $\Sigma_c$ в точке $x_0$.[/восстановлено]

---

## 4. Справочный лист

### Ключевые формулы

| Объект | Формула |
|---|---|
| Производная по направлению | $\dfrac{\partial f}{\partial \ell}(x_0) = \lim_{t\to 0^+}\dfrac{f(x_0+t\ell^0)-f(x_0)}{t}$ |
| Орт вектора | $\ell^0 = \ell/\|\ell\|$ |
| Частная производная | $\dfrac{\partial f}{\partial x_j}(x_0) = \lim_{t\to 0}\dfrac{f(x_0+te_j)-f(x_0)}{t}$ |
| Матрица Якоби $(n{\times}m)$ | $J_f(x_0) = \left(\dfrac{\partial f_i}{\partial x_j}(x_0)\right)_{i,j}$ |
| Дифференцируемость | $f(x_0+h) = f(x_0) + J_f(x_0)h + o(\|h\|)$ |
| Градиент | $\nabla f(x_0) = \left(\dfrac{\partial f}{\partial x_1},\ldots,\dfrac{\partial f}{\partial x_m}\right)^T$ |
| Производная по направлению через градиент | $\dfrac{\partial f}{\partial \ell}(x_0) = \langle \nabla f(x_0), \ell^0\rangle$ |
| Скалярное произведение | $\langle a,b\rangle = \sum_k a_k b_k = \|a\|\|b\|\cos\varphi$ |
| Максимум производной по направлению | $\max_{\|\ell^0\|=1}\dfrac{\partial f}{\partial \ell}(x_0) = \|\nabla f(x_0)\|$, достигается при $\ell^0 \parallel \nabla f(x_0)$ |
| Ортогональность градиента | $\langle \nabla f(x_0), \gamma'(t_0)\rangle = 0$ для любой $\gamma \subset \Sigma_c$ |
| Уравнение касательной плоскости к $\Sigma_c$ | $\langle \nabla f(x_0), x - x_0\rangle = 0$ |

### Логика необходимых и достаточных условий

$$
\text{все } \tfrac{\partial f_i}{\partial x_j} \text{ непрерывны в }x_0 \quad \Longrightarrow \quad f \text{ дифференцируема в }x_0
$$
$$
f \text{ дифференцируема в }x_0 \quad \Longrightarrow \quad \exists\text{ все } \tfrac{\partial f_i}{\partial x_j}(x_0),\; \exists \tfrac{\partial f}{\partial \ell}(x_0)\;\forall\ell,\; f \text{ непрерывна в }x_0
$$
$$
\exists \text{ все } \tfrac{\partial f_i}{\partial x_j}(x_0) \quad \not\Longrightarrow \quad f \text{ дифференцируема в }x_0
$$

---

## 5. Концептуальное резюме

Лекция выстраивает цепочку понятий, обобщающих скалярное дифференцирование на многомерный случай. Производная по направлению обобщает обычную производную: вместо единственного направления ($+x$) теперь можно выбирать произвольное направление в $\mathbb{R}^m$. Частные производные — это производные по координатным направлениям; они образуют матрицу Якоби, кодирующую линейное приближение отображения. Для вещественнозначных функций матрица Якоби отождествляется с вектором — градиентом, который, с одной стороны, позволяет вычислять производную по любому направлению через скалярное произведение, а с другой — является геометрическим объектом: он указывает направление наискорейшего роста функции и ортогонален поверхностям уровня. Достаточное условие дифференцируемости (непрерывность частных производных) даёт практический критерий, избавляющий от прямой проверки определения. Всё это вместе создаёт математический фундамент для дальнейшего изучения экстремумов функций многих переменных, метода множителей Лагранжа, касательных плоскостей и производных высших порядков.

---

## 6. Связи с более широкой математикой

**Дифференциальная геометрия.** Понятие нормального вектора к поверхности через градиент лежит в основе теории гладких многообразий; нормальное пространство к многообразию определяется именно через дифференциалы задающих функций.

**Оптимизация.** Метод градиентного спуска использует свойство: в направлении $-\nabla f(x)$ функция убывает быстрее всего. Метод множителей Лагранжа для поиска условного экстремума опирается на условие параллельности градиента целевой функции и градиентов ограничений.

**Физика.** Потенциальные поля $\mathbf{E} = -\nabla \varphi$ (электрическое поле как отрицательный градиент потенциала), теплопроводность ($\mathbf{q} = -\kappa\nabla T$), гидродинамика. Градиент давления создаёт силу в жидкости (уравнение Навье—Стокса).

**Численные методы.** Конечно-разностные аппроксимации частных производных, методы сопряжённых градиентов, конечные элементы — всё основано на дискретизации понятий дифференцируемости и градиента.

**Функциональный анализ.** Фреше-дифференцируемость в бесконечномерных пространствах — прямое обобщение рассмотренного определения; матрица Якоби заменяется ограниченным линейным оператором между банаховыми пространствами.

**Теорема о неявной функции.** Её формулировка и доказательство существенно используют матрицу Якоби и условие её невырожденности.
