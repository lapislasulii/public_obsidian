
## 1. Обзор семинара

На семинаре разбирались три круга задач. Первый — нахождение матриц проектора и отражения для прямой суммы $V = V_1 \oplus V_2$ через специальный согласованный базис и формулу замены базиса (задача 11 листка 17). Второй — одновременное вычисление ядра и образа линейного оператора единым методом расширенной матрицы с приписанной единичной матрицей, сначала для матричного оператора (задача 12а), затем для операторов в пространстве многочленов $\mathbb{R}[x]_n$ (задачи 13б, 13г, 13д). Третий — комбинаторные задачи подсчёта числа идемпотентных и инволютивных матриц над конечным полем $\mathbb{F}_q$ через переформулировку в терминах подпространств (задачи 14*, 15*). В конце начали листок 18: критерий инвариантности подпространства через порождающую систему и разбор конкретных примеров с нахождением матрицы сужения.

---

## 2. Предварительные сведения

- **Линейный оператор (эндоморфизм):** отображение $\mathcal{A}: V \to V$, сохраняющее линейные операции.
- **Матрица оператора в базисе $e$:** $j$-й столбец — координаты $\mathcal{A}(e_j)$ в том же базисе.
- **Формула замены базиса:** если $C$ — матрица перехода от старого базиса к новому (столбцы — новые базисные векторы в старых координатах), то $A_{\text{new}} = C^{-1} A_{\text{old}} C$.
- **Прямая сумма:** $V = V_1 \oplus V_2$ означает, что любой вектор единственным образом представляется как $v = u + w$, $u \in V_1$, $w \in V_2$.
- **Проектор на $V_1$ параллельно $V_2$:** оператор $P$ такой, что $P(u+w) = u$.
- **Отражение относительно $V_1$ вдоль $V_2$:** оператор $D$ такой, что $D(u+w) = u - w$.
- **Ядро и образ:** $\ker \mathcal{A} = \{x : \mathcal{A}(x) = 0\}$, $\operatorname{im} \mathcal{A} = \{\mathcal{A}(x) : x \in V\}$; теорема о размерностях: $\dim \ker \mathcal{A} + \dim \operatorname{im} \mathcal{A} = \dim V$.
- **Конечное поле $\mathbb{F}_q$:** поле из $q$ элементов; $n$-мерное пространство над $\mathbb{F}_q$ содержит ровно $q^n$ векторов.

---

## 3. Основное содержание

### 3.1. Матрицы проектора и отражения (задача 11)

**Условие.** В $\mathbb{R}^4$ даны подпространства
$$V_1 = \langle (1,0,-1,2)^T,\, (0,1,3,1)^T \rangle, \quad V_2 = \langle (-1,1,0,2)^T,\, (1,2,1,0)^T \rangle,$$
и утверждается, что $\mathbb{R}^4 = V_1 \oplus V_2$. Найти матрицы проектора на $V_1$ параллельно $V_2$ и отражения относительно $V_1$ вдоль $V_2$ в стандартном базисе.

---

**Ключевая идея.** В произвольном базисе матрица проектора выглядит сложно. Но если выбрать базис, *согласованный* с разложением $V_1 \oplus V_2$, матрицы принимают тривиальный вид без каких-либо вычислений.

**Метод специального базиса.**

Возьмём базис $\mathcal{B} = (v_1, v_2, v_3, v_4)$, где $v_1, v_2$ — базис $V_1$, а $v_3, v_4$ — базис $V_2$:
$$v_1 = (1,0,-1,2)^T,\quad v_2 = (0,1,3,1)^T,\quad v_3 = (-1,1,0,2)^T,\quad v_4 = (1,2,1,0)^T.$$

В базисе $\mathcal{B}$ действие проектора очевидно: векторы $v_1, v_2 \in V_1$ переходят в себя, векторы $v_3, v_4 \in V_2$ переходят в $0$. Записывая образы в столбцы, получаем:

$$P_{\mathcal{B}} = \begin{pmatrix} 1 & 0 & 0 & 0 \\ 0 & 1 & 0 & 0 \\ 0 & 0 & 0 & 0 \\ 0 & 0 & 0 & 0 \end{pmatrix}.$$

Для отражения: векторы из $V_1$ переходят в себя (лежат "на зеркале"), векторы из $V_2$ переходят в свои противоположные (отражаются "через зеркало"):

$$D_{\mathcal{B}} = \begin{pmatrix} 1 & 0 & 0 & 0 \\ 0 & 1 & 0 & 0 \\ 0 & 0 & -1 & 0 \\ 0 & 0 & 0 & -1 \end{pmatrix}.$$

**Связь:** $D = 2P - I$ — это следует из того, что $D(u+w) = u - w = 2u - (u+w)$.

**Переход к стандартному базису.** Обозначим стандартный базис $e$. Матрица перехода $C$ от $\mathcal{B}$ к $e$ — это матрица, столбцы которой суть координаты векторов $v_i$ в стандартном базисе:

$$C = \begin{pmatrix} 1 & 0 & -1 & 1 \\ 0 & 1 & 1 & 2 \\ -1 & 3 & 0 & 1 \\ 2 & 1 & 2 & 0 \end{pmatrix}.$$

Тогда матрицы в стандартном базисе:
$$P_e = C \cdot P_{\mathcal{B}} \cdot C^{-1}, \qquad D_e = C \cdot D_{\mathcal{B}} \cdot C^{-1}.$$

[дополнено] Почему именно $C P C^{-1}$, а не $C^{-1} P C$? Пусть $x$ — вектор в стандартных координатах. Тогда $C^{-1}x$ — его координаты в базисе $\mathcal{B}$. Применяем $P_{\mathcal{B}}$. Переводим обратно умножением на $C$. Итого: $P_e x = C \cdot P_{\mathcal{B}} \cdot C^{-1} x$. [/дополнено]

**Нахождение $C^{-1}$.** Удобно методом Гаусса: $[C | E] \xrightarrow{\text{Гаусс}} [E | C^{-1}]$.

**ЛОВУШКИ:**
- Перепутать порядок: формула $C^{-1} P C$ даёт матрицу оператора при *обратной* замене базиса.
- Перепутать, какие векторы идут в $V_1$, а какие в $V_2$ — тогда проектор и отражение поменяются местами.

---

### 3.2. Одновременное нахождение ядра и образа (задача 12а)

**Условие.** Найти ядро и образ оператора $\mathcal{A}$, заданного в некотором базисе $(e_1, e_2, e_3, e_4)$ матрицей

$$A = \begin{pmatrix} 1 & 0 & 2 & 3 \\ 2 & 1 & 1 & 0 \\ 3 & 2 & 0 & 3 \\ 6 & 1 & -1 & 7 \end{pmatrix}.$$

---

**Ключевая идея метода.** Образ оператора — это линейная оболочка столбцов матрицы $A$ (столбцы — это образы $\mathcal{A}(e_j)$). Ядро — это решения $Ax = 0$. Оба можно найти за один проход Гаусса, если воспользоваться следующим приёмом.

Запишем $j$-й столбец $A$ как образ $j$-го базисного вектора. Транспонируем: теперь $j$-я *строка* содержит $\mathcal{A}(e_j)$ в координатах. Приписываем справа единичную матрицу $E$ — она отслеживает, какие линейные комбинации строк мы делаем:

$$\left(\begin{array}{cccc|cccc}
1 & 0 & 2 & 3 & 1 & 0 & 0 & 0 \\
2 & 1 & 1 & 0 & 0 & 1 & 0 & 0 \\
3 & 2 & 0 & 3 & 0 & 0 & 1 & 0 \\
6 & 1 & -1 & 7 & 0 & 0 & 0 & 1
\end{array}\right).$$

Применяем элементарные преобразования строк ко всей расширенной матрице:

$R_2 \leftarrow R_2 - 2R_1$:
$$\left(\begin{array}{cccc|cccc}
1 & 0 & 2 & 3 & 1 & 0 & 0 & 0 \\
0 & 1 & -3 & -6 & -2 & 1 & 0 & 0 \\
3 & 2 & 0 & 3 & 0 & 0 & 1 & 0 \\
6 & 1 & -1 & 7 & 0 & 0 & 0 & 1
\end{array}\right).$$

$R_3 \leftarrow R_3 - 3R_1$, $R_4 \leftarrow R_4 - 6R_1$:
$$\left(\begin{array}{cccc|cccc}
1 & 0 & 2 & 3 & 1 & 0 & 0 & 0 \\
0 & 1 & -3 & -6 & -2 & 1 & 0 & 0 \\
0 & 2 & -6 & -6 & -3 & 0 & 1 & 0 \\
0 & 1 & -13 & -11 & -6 & 0 & 0 & 1
\end{array}\right).$$

$R_3 \leftarrow R_3 - 2R_2$, $R_4 \leftarrow R_4 - R_2$:
$$\left(\begin{array}{cccc|cccc}
1 & 0 & 2 & 3 & 1 & 0 & 0 & 0 \\
0 & 1 & -3 & -6 & -2 & 1 & 0 & 0 \\
0 & 0 & 0 & 6 & 1 & -2 & 1 & 0 \\
0 & 0 & -10 & -5 & -4 & -1 & 0 & 1
\end{array}\right).$$

Меняем $R_3 \leftrightarrow R_4$ для удобства и продолжаем до ступенчатого вида. После полного приведения предположим, что обнулились строки 3 и 4 в левой части (ранг матрицы равен 2 — проверяется по ходу вычислений). Тогда:

- **Образ** $\operatorname{im}\mathcal{A}$ порождён ненулевыми строками левой части (это линейно независимые образы базисных векторов), но нужно вернуться к исходным координатам: базис образа — это соответствующие столбцы исходной $A$. Удобнее записать образ через ненулевые строки после Гаусса: это базис образа в координатах.

- **Ядро** $\ker\mathcal{A}$: строки правой части $E$, соответствующие нулевым строкам левой, дают координаты векторов базиса ядра. Смысл: если строка обнулилась, значит соответствующая линейная комбинация $\mathcal{A}(e_j)$ равна нулю — то есть некоторый вектор пространства (записанный в правой части) лежит в ядре.

[дополнено] **Почему это работает?** Единичная матрица справа изначально содержит стандартные базисные векторы. Когда мы делаем $R_i \leftarrow R_i - \alpha R_j$, в правой части накапливаются коэффициенты линейных комбинаций. Если строка слева обнулилась, это значит: $\sum_k c_k \mathcal{A}(e_k) = 0$, то есть $\mathcal{A}(\sum_k c_k e_k) = 0$. Вектор $\sum_k c_k e_k$ — элемент ядра, его координаты записаны в правой части этой строки. [/дополнено]

**Проверка:** $\dim\ker\mathcal{A} + \dim\operatorname{im}\mathcal{A} = 4$ — должно выполняться.

**ЛОВУШКИ:**
- Забыть применять преобразования к правой части.
- Перепутать: ядро читается из правой части нулевых строк, образ — из ненулевых строк левой части.

---

### 3.3. Ядро и образ операторов в $\mathbb{R}[x]_n$ (задачи 13б, 13г, 13д)

Пространство $\mathbb{R}[x]_n$ — многочлены степени не выше $n$, размерность $n+1$.

---

#### 3.3.1. Оператор $T: f \mapsto f(x+1)$ (задача 13б)

**Ядро.** $Tf = 0$ означает $f(x+1) = 0$ как многочлен, то есть $f \equiv 0$. Значит, $\ker T = \{0\}$.

**Образ.** Матрица $T$ в базисе $(1, x, x^2, \ldots, x^n)$ вычислялась ранее — это верхнетреугольная матрица с единицами на главной диагонали (биномиальные коэффициенты):

$$T(x^k) = (x+1)^k = \sum_{j=0}^{k} \binom{k}{j} x^j.$$

Определитель такой матрицы равен произведению диагональных элементов, то есть $1$. Значит, матрица обратима, оператор $T$ — изоморфизм. Следовательно, $\operatorname{im} T = \mathbb{R}[x]_n$.

**Интуиция.** Подстановка $x \mapsto x+1$ — это просто сдвиг аргумента. Обратный оператор: $x \mapsto x-1$. Любой многочлен получается из некоторого другого сдвигом, поэтому образ — всё пространство.

---

#### 3.3.2. Оператор $D: f \mapsto x^3 f'''(x)$ (задача 13г)

**Ядро.** $Df = 0$ означает $x^3 f'''(x) = 0$, то есть $f'''(x) = 0$ (поскольку $x^3 \neq 0$ как многочлен). Условие $f''' = 0$ выполняется тогда и только тогда, когда $\deg f \leq 2$. Значит:
$$\ker D = \mathbb{R}[x]_2 = \langle 1, x, x^2 \rangle, \quad \dim\ker D = 3.$$

**Образ.** Третья производная понижает степень на 3, умножение на $x^3$ повышает на 3. Если $\deg f = k \geq 3$, то $\deg(Df) = k - 3 + 3 = k$. Но при дифференцировании свободный член, $x$, $x^2$ обнуляются, а $x^3$ переходит в константу, которая после умножения на $x^3$ даёт $x^3$. Таким образом, образ содержит только многочлены, делящиеся на $x^3$:
$$\operatorname{im} D = \langle x^3, x^4, \ldots, x^n \rangle, \quad \dim\operatorname{im} D = n - 2.$$

**Проверка:** $\dim\ker D + \dim\operatorname{im} D = 3 + (n-2) = n+1 = \dim\mathbb{R}[x]_n$. Верно.

---

#### 3.3.3. Оператор $P: f \mapsto f(5) \cdot x$ (задача 13д)

**Ядро.** $Pf = 0$ означает $f(5) \cdot x = 0$, то есть $f(5) = 0$. Это многочлены, у которых $x = 5$ является корнем:
$$\ker P = \{f \in \mathbb{R}[x]_n : f(5) = 0\}, \quad \dim\ker P = n.$$
Базис: $(x-5),\, x(x-5),\, x^2(x-5),\, \ldots,\, x^{n-1}(x-5)$ — или любые $n$ линейно независимых многочленов с корнем в $5$.

**Образ.** $Pf = f(5) \cdot x$ — это всегда многочлен вида $\lambda x$, где $\lambda = f(5) \in \mathbb{R}$. Любое значение $\lambda$ достижимо (например, взять $f = \lambda$). Значит:
$$\operatorname{im} P = \langle x \rangle, \quad \dim\operatorname{im} P = 1.$$

**Проверка:** $n + 1 = n + 1$. Верно.

---

### 3.4. Подсчёт числа идемпотентных матриц (задача 14*)

**Условие.** Найти число решений $X^2 = X$, где $X \in M_4(\mathbb{F}_q)$, $\operatorname{rank} X = 2$.

**Переформулировка.** Условие $X^2 = X$ означает, что $X$ — идемпотент, то есть проектор. Любой идемпотент ранга $r$ является проектором на своей образ (двумерное подпространство $U \subset \mathbb{F}_q^4$) параллельно своему ядру (тоже двумерное подпространство $W$, причём $\mathbb{F}_q^4 = U \oplus W$).

Таким образом, задача сводится к: **сколькими способами можно выбрать прямое разложение $\mathbb{F}_q^4 = U \oplus W$, где $\dim U = \dim W = 2$?**

Каждая такая пара $(U, W)$ однозначно определяет проектор $X$ (и обратно). Значит, нужно посчитать такие пары.

**Подсчёт числа двумерных подпространств в $\mathbb{F}_q^4$.**

Выбираем базис двумерного подпространства $U$:
- Первый базисный вектор: любой ненулевой вектор из $\mathbb{F}_q^4$, то есть $q^4 - 1$ вариантов.
- Второй базисный вектор: любой вектор, линейно независимый с первым, то есть не из порождённого первым одномерного пространства. Таких $q^4 - q$ вариантов.

Но одно и то же двумерное пространство порождается $|\text{GL}_2(\mathbb{F}_q)|$ различными базисами. Число базисов двумерного пространства над $\mathbb{F}_q$:
$$(q^2 - 1)(q^2 - q).$$

Итого число двумерных подпространств в $\mathbb{F}_q^4$:
$$\binom{4}{2}_q = \frac{(q^4-1)(q^4-q)}{(q^2-1)(q^2-q)} = \frac{(q^4-1)(q^3-1)}{(q^2-1)(q-1)}\cdot\frac{1}{1} = (q^2+1)(q^2+q+1).$$

[дополнено] Это число называется *гауссовым биномиальным коэффициентом* $\binom{4}{2}_q$. [/дополнено]

**Подсчёт числа прямых дополнений к фиксированному $U$.**

Зафиксируем двумерное подпространство $U$. Нужно найти число двумерных $W$ таких, что $U \oplus W = \mathbb{F}_q^4$.

Выбираем базис $W$ в оставшемся пространстве: так как $\mathbb{F}_q^4 / U \cong \mathbb{F}_q^2$, выбор первого вектора $w_1$ — это вектор не из $U$ (таких $q^4 - q^2$), выбор второго — вектор не в $U + \langle w_1 \rangle$ (таких $q^4 - q^3$). Делим на число базисов двумерного пространства $(q^2-1)(q^2-q)$:

$$\text{число дополнений к } U = \frac{(q^4 - q^2)(q^4 - q^3)}{(q^2-1)(q^2-q)} = q^4.$$

**Итоговый ответ.** Каждая пара $(U,W)$ с $U \oplus W = \mathbb{F}_q^4$ определяет ровно один идемпотент ранга 2. Число таких пар:

$$\text{число двумерных } U \times \text{число дополнений к каждому } U = (q^2+1)(q^2+q+1) \cdot q^4.$$

**Замечание.** На семинаре вычисление числа дополнений вызвало дискуссию и не было окончательно завершено — преподаватель отложил окончательное обоснование. Формула выше является корректным завершением этого рассуждения.

---

### 3.5. Подсчёт числа инволютивных матриц (задача 15*)

**Условие.** Найти число решений $X^2 = E$, где $X \in M_3(\mathbb{F}_q)$, $\operatorname{char}\mathbb{F}_q \neq 2$.

**Переформулировка.** $X^2 = E$ означает, что $X$ — инволюция. Любая инволюция является отражением: если $U = \ker(X-E)$ (подпространство, где $X$ действует как тождественный), $W = \ker(X+E)$ (подпространство, где $X$ действует как $-E$), то $V = U \oplus W$ и $X$ — отражение относительно $U$ вдоль $W$. Условие $\operatorname{char}\mathbb{F}_q \neq 2$ гарантирует, что $E \neq -E$, то есть разложение нетривиально.

Задача сводится к: **сколькими способами можно разложить $\mathbb{F}_q^3 = U \oplus W$?**

Перебираем по размерности $\dim U = k$, $\dim W = 3-k$ для $k = 0, 1, 2, 3$:

- $k = 0$: $U = \{0\}$, $W = \mathbb{F}_q^3$. Один способ: $X = -E$.
- $k = 3$: $U = \mathbb{F}_q^3$, $W = \{0\}$. Один способ: $X = E$.
- $k = 1$: выбираем одномерное $U$, затем двумерное прямое дополнение $W$.

Число одномерных подпространств в $\mathbb{F}_q^3$: $\dfrac{q^3-1}{q-1} = q^2+q+1$.

Для фиксированного одномерного $U$: число двумерных $W$ с $U \oplus W = \mathbb{F}_q^3$ равно $q^2$ (аналогичный подсчёт через факторпространство).

Итого для $k=1$: $(q^2+q+1) \cdot q^2$.

- $k = 2$: выбираем двумерное $U$ — это то же самое число $(q^2+q+1)$ (число двумерных подпространств в $\mathbb{F}_q^3$), дополнение $W$ одномерное и единственно определяется как единственное одномерное прямое дополнение... но прямое дополнение не единственно в общем случае. Аналогичный подсчёт даёт $q^2$ вариантов.

Итого для $k=2$: $(q^2+q+1) \cdot q^2$.

**Итоговый ответ:**
$$1 + (q^2+q+1)q^2 + (q^2+q+1)q^2 + 1 = 2 + 2q^2(q^2+q+1).$$

**Замечание.** Задача на семинаре была начата, разобрана идея переформулировки, конкретный подсчёт дополнений обсуждался подробно — преподаватель указал, что прямое дополнение не единственно и его надо учитывать отдельно.

---

### 3.6. Инвариантные подпространства (листок 18, задача 1 и примеры)

**Определение.** Подпространство $U \subset V$ называется *инвариантным* относительно оператора $\mathcal{A}$, если $\mathcal{A}(U) \subseteq U$, то есть для любого $u \in U$ выполнено $\mathcal{A}(u) \in U$.

**Теорема (критерий через порождающую систему).** Подпространство $U = \langle a_1, \ldots, a_k \rangle$ инвариантно относительно $\mathcal{A}$ тогда и только тогда, когда $\mathcal{A}(a_i) \in U$ для всех $i = 1, \ldots, k$.

*Доказательство.* Необходимость очевидна (базисные векторы принадлежат $U$). Достаточность: любой $u \in U$ представляется как $u = \sum \lambda_i a_i$, тогда $\mathcal{A}(u) = \sum \lambda_i \mathcal{A}(a_i) \in U$ (как линейная комбинация элементов $U$). $\square$

**Практический смысл.** Для проверки инвариантности не нужно проверять все векторы подпространства — достаточно проверить образы базисных векторов.

---

**Пример А.** $V = M_2(\mathbb{R})$, $U$ — симметрические матрицы, $\mathcal{A}: X \mapsto X^T$.

Любая симметрическая матрица $X^T = X$ переходит в себя: $\mathcal{A}(X) = X^T = X \in U$. Значит, $U$ инвариантно.

**Пример Б.** $V = M_2(\mathbb{R})$, $U$ — кососимметрические матрицы ($X^T = -X$), $\mathcal{A}: X \mapsto X^T$.

Для кососимметрической $X$: $\mathcal{A}(X) = X^T = -X \in U$ (кососимметрическая). Значит, $U$ инвариантно.

**Пример Г (нахождение матрицы сужения).** $V = \mathbb{R}[x]_n$, $U = \ker D^3 = \mathbb{R}[x]_2 = \langle 1, x, x^2 \rangle$, оператор $\mathcal{A} = D$ (дифференцирование).

Проверяем инвариантность: $D(1) = 0 \in U$, $D(x) = 1 \in U$, $D(x^2) = 2x \in U$. Инвариантно.

Матрица сужения $D|_U$ в базисе $(1, x, x^2)$:
$$D|_U \leftrightarrow \begin{pmatrix} 0 & 1 & 0 \\ 0 & 0 & 2 \\ 0 & 0 & 0 \end{pmatrix}.$$

**Пример Е.** $V = \mathbb{R}[x]_2$, $U = \mathbb{R}[x]_1 = \langle 1, x \rangle$, оператор $\mathcal{A}: f(x) \mapsto f(1-x)$.

Проверяем: $\mathcal{A}(1) = 1 \in U$, $\mathcal{A}(x) = 1-x \in U$. Инвариантно.

Матрица сужения в базисе $(1, x)$:
- $\mathcal{A}(1) = 1 = 1 \cdot 1 + 0 \cdot x$
- $\mathcal{A}(x) = 1-x = 1 \cdot 1 + (-1) \cdot x$

$$\mathcal{A}|_U \leftrightarrow \begin{pmatrix} 1 & 1 \\ 0 & -1 \end{pmatrix}.$$

**ЛОВУШКИ:**
- Проверять инвариантность для всего пространства, а не только для базиса подпространства — лишняя работа.
- Путать матрицу сужения с матрицей исходного оператора (матрица сужения меньшего размера, базис выбирается только внутри $U$).

---

## 4. Справочный лист

$$P_{\mathcal{B}} = \operatorname{diag}(\underbrace{1,\ldots,1}_{k},\underbrace{0,\ldots,0}_{n-k}), \quad D_{\mathcal{B}} = \operatorname{diag}(\underbrace{1,\ldots,1}_{k},\underbrace{-1,\ldots,-1}_{n-k})$$

$$D = 2P - I$$

$$A_e = C \cdot A_{\mathcal{B}} \cdot C^{-1}, \quad \text{где столбцы } C \text{ — новые базисные векторы в старых координатах}$$

$$\dim\ker\mathcal{A} + \dim\operatorname{im}\mathcal{A} = \dim V$$

$$\text{Число } k\text{-мерных подпространств в } \mathbb{F}_q^n: \quad \binom{n}{k}_q = \frac{(q^n-1)(q^{n-1}-1)\cdots(q^{n-k+1}-1)}{(q^k-1)(q^{k-1}-1)\cdots(q-1)}$$

$$U \text{ инвариантно} \iff \mathcal{A}(a_i) \in U \text{ для всех } a_i \text{ из порождающей системы } U$$

---

## 5. Типичные ошибки семинара

1. **Порядок в формуле замены базиса.** $A_e = C A_{\mathcal{B}} C^{-1}$, а не $C^{-1} A_{\mathcal{B}} C$. Запомнить: сначала переходим к специальному базису ($C^{-1}$), применяем оператор ($A_{\mathcal{B}}$), возвращаемся ($C$).

2. **Метод расширенной матрицы.** Ядро — из правой части нулевых строк; образ — из ненулевых строк левой части. Часто путают местами.

3. **Многочлены: интерпретация ядра через корни.** Для оператора подстановки ($f \mapsto f(a) \cdot g(x)$) ядро — это многочлены с корнем в точке $a$, а не произвольные многочлены.

4. **Инвариантность.** Достаточно проверять образы базисных векторов подпространства, а не всех векторов.

5. **Матрица сужения.** Выбирать базис только внутри инвариантного подпространства; размер матрицы сужения — $\dim U \times \dim U$.
