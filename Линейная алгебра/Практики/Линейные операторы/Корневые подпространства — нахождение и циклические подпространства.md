# Корневые подпространства — нахождение и циклические подпространства

## Обзор семинара

На семинаре рассматривались два основных класса задач. Первый — теоретическая задача о собственных значениях вещественной матрицы ранга 1 в зависимости от её следа. Второй — практическое нахождение корневых подпространств оператора, заданного конкретной матрицей $3 \times 3$, с анализом момента стабилизации цепочки ядер $(A - \lambda E)^k$. Дополнительно разобрана задача о базисе циклического подпространства и матрице сужения оператора. Центральная идея: если геометрическая кратность собственного значения меньше алгебраической, корневое подпространство строится итеративным расширением ядер.

---

## Методы и подходы

### 1. Собственные значения матрицы ранга 1

**Когда применять:** матрица $A \in M_n(\mathbb{R})$, $\operatorname{rank} A = 1$.

**Алгоритм:**

1. Записать $A = cb^T$ (произведение ненулевого столбца на ненулевую строку).
2. По теореме о ранге-дефекте: $\dim \ker A = n - 1$, значит $\lambda = 0$ — собственное значение геометрической кратности $n-1$, алгебраической $\geq n-1$.
3. Вычислить $\operatorname{tr} A = b^T c$.
4. Из $\lambda_1 + \cdots + \lambda_n = \operatorname{tr} A$ при $(n-1)$ нулевых значениях: оставшееся значение равно $\operatorname{tr} A$.

**Два случая:**

При $\operatorname{tr} A \neq 0$: спектр $\{0^{(n-1)},\ \operatorname{tr} A^{(1)}\}$.

При $\operatorname{tr} A = 0$: спектр $\{0^{(n)}\}$, и $A^2 = 0$.

**Ключевое тождество:** $A^2 = (\operatorname{tr} A) \cdot A$.

Доказательство: $A^2 x = A(cb^T x) = c(b^T x)(b^T c) = (b^T c)(cb^T x) = (\operatorname{tr} A) \cdot Ax$.

**ЛОВУШКИ:**
- Не путать алгебраическую кратность 0 (равна $n-1$ при $\operatorname{tr} A \neq 0$) и геометрическую ($n-1$). Здесь они совпадают — это исключение.
- При $\operatorname{tr} A = 0$ алгебраическая кратность 0 равна $n$, геометрическая — $n-1$.

**ПРИЗНАКИ ПРИМЕНИМОСТИ:** в условии указано $\operatorname{rank} A = 1$.

---

### 2. Нахождение корневых подпространств: метод стабилизации ядер

**Когда применять:** нужно найти $V_\lambda^*$ для оператора с собственным значением $\lambda$, у которого геометрическая кратность может быть меньше алгебраической.

**Теоретическая основа.** Корневое подпространство:
$$V_\lambda^* = \ker(A - \lambda E)^m,$$
где $m$ — алгебраическая кратность $\lambda$. Цепочка ядер строго возрастает до стабилизации:
$$\ker(A-\lambda E) \subsetneq \ker(A-\lambda E)^2 \subsetneq \cdots \subsetneq \ker(A-\lambda E)^p = V_\lambda^*,$$
причём размерность увеличивается на каждом шаге не менее чем на 1.

**Алгоритм:**

1. Найти характеристический многочлен $\chi_A(\lambda) = \det(A - \lambda E)$, все корни $\lambda_i$ и их алгебраические кратности $m_i$.
2. Для каждого $\lambda_i$ вычислить $B = A - \lambda_i E$ и найти $\ker B$. Пусть $d_1 = \dim \ker B$.
3. Если $d_1 = m_i$: корневое совпадает с собственным, $V_{\lambda_i}^* = \ker B$. Стоп.
4. Если $d_1 < m_i$: вычислить $B^2$ и найти $\ker B^2$. Пусть $d_2 = \dim \ker B^2$.
5. Повторять до $d_k = m_i$.

**ЛОВУШКИ:**
- Если $d_1 < m_i$, нельзя останавливаться на первой степени. Собственное подпространство не является корневым.
- Если на очередном шаге $d_k = m_i$, дальнейшее увеличение степени ничего нового не даст — ядра стабилизировались.

**ПРИЗНАКИ ПРИМЕНИМОСТИ:** кратные собственные значения, матрица не диагонализируема.

---

### 3. Базис циклического подпространства и матрица сужения

**Когда применять:** дан вектор $v \in V$, нужно найти минимальное $A$-инвариантное подпространство, содержащее $v$.

**Определение.** Циклическое подпространство: $Z(A, v) = \langle v, Av, A^2 v, \ldots \rangle$.

**Алгоритм:**

1. Вычислять $v, Av, A^2v, \ldots$ последовательно.
2. На каждом шаге проверять линейную независимость полученных векторов.
3. Остановиться, когда $A^k v \in \langle v, Av, \ldots, A^{k-1}v \rangle$. Пусть $A^k v = \sum_{j=0}^{k-1} a_j A^j v$.
4. Базис: $\{v, Av, \ldots, A^{k-1}v\}$, размерность $d = k$.
5. Матрица сужения $[A|_Z]$ в этом базисе составляется по столбцам:
   - $j$-й столбец ($j < k$): $A(A^{j-1}v) = A^j v$ — это $(j+1)$-й базисный вектор, столбец $(0,\ldots,0,1,0,\ldots,0)^T$.
   - Последний столбец: координаты $A^k v = a_0 v + \cdots + a_{k-1}A^{k-1}v$, то есть $(a_0, a_1, \ldots, a_{k-1})^T$.

**ЛОВУШКИ:**
- Недостаточно смотреть на один элемент при проверке линейной зависимости — нужно проверять всю систему уравнений.
- Координаты образа в матрице сужения записываются по столбцам, не по строкам.

---

## Разбор задач

### Задача 1. Собственные значения матрицы ранга 1 (задача 22, лист 18)

**Условие:** $A \in M_n(\mathbb{R})$, $\operatorname{rank} A = 1$. Найдите спектр $A$, если а) $\operatorname{tr} A \neq 0$, б) $\operatorname{tr} A = 0$.

**Решение:**

Так как $\operatorname{rank} A = 1$, запишем $A = cb^T$ ($c$ — ненулевой столбец, $b^T$ — ненулевая строка). Для произвольного $x$:
$$A^2 x = c \cdot b^T (c \cdot b^T x) = c(b^T c)(b^T x) = (b^T c) \cdot Ax,$$
то есть $A^2 = (b^T c) A$. Заметим, что $b^T c = \operatorname{tr}(cb^T) = \operatorname{tr} A$, следовательно,
$$A^2 = (\operatorname{tr} A) \cdot A.$$

Из этого: $A(A - (\operatorname{tr} A)E) = 0$, значит характеристический многочлен делится на $\lambda(\lambda - \operatorname{tr} A)$.

По теореме о ранге-дефекте $\dim \ker A = n - 1$, поэтому $0$ — собственное значение геометрической кратности $n-1$, алгебраической кратности не менее $n-1$.

**а) $\operatorname{tr} A \neq 0$:** характеристический многочлен $\chi_A(\lambda) = (-1)^n \lambda^{n-1}(\lambda - \operatorname{tr} A)$. Спектр: $\{0^{(n-1)},\ (\operatorname{tr} A)^{(1)}\}$. Алгебраическая кратность нуля совпадает с геометрической — оператор диагонализируем.

**б) $\operatorname{tr} A = 0$:** характеристический многочлен $\chi_A(\lambda) = (-1)^n \lambda^n$. Единственное собственное значение $0$ кратности $n$. Из $A^2 = 0$ следует нильпотентность $A$. Геометрическая кратность нуля равна $n-1 < n$ — оператор не диагонализируем.

**Ответ:** а) $\sigma(A) = \{0,\ \operatorname{tr} A\}$ с кратностями $(n-1, 1)$; б) $\sigma(A) = \{0\}$ с кратностью $n$.

---

### Задача 2. Корневые подпространства (задача 1а, лист ЖНФ)

**Условие:** Найти корневые подпространства оператора, заданного матрицей
$$A = \begin{pmatrix} 4 & -5 & 2 \\ 5 & -7 & 3 \\ 6 & -9 & 4 \end{pmatrix}$$
в стандартном базисе $\mathbb{R}^3$.

#### Шаг 1. Характеристический многочлен

Вычислим $\det A$:
$$\det A = 4[(-7)(4) - 3(-9)] - (-5)[5 \cdot 4 - 3 \cdot 6] + 2[5(-9) - (-7)(6)]$$
$$= 4(-28 + 27) + 5(20 - 18) + 2(-45 + 42)$$
$$= 4(-1) + 5(2) + 2(-3) = -4 + 10 - 6 = 0.$$

Значит, $\lambda = 0$ — корень. Вычислим $\operatorname{tr} A = 4 + (-7) + 4 = 1$.

Сумма главных миноров 2-го порядка (главные миноры — из строк и столбцов с одинаковыми индексами):

$$M_{\{1,2\}} = \det\begin{pmatrix}4&-5\\5&-7\end{pmatrix} = -28+25 = -3,$$
$$M_{\{1,3\}} = \det\begin{pmatrix}4&2\\6&4\end{pmatrix} = 16-12 = 4,$$
$$M_{\{2,3\}} = \det\begin{pmatrix}-7&3\\-9&4\end{pmatrix} = -28+27 = -1.$$

Сумма: $-3 + 4 + (-1) = 0$.

Характеристический многочлен:
$$\chi_A(\lambda) = -\lambda^3 + (\operatorname{tr} A)\lambda^2 - 0 \cdot \lambda + 0 = -\lambda^3 + \lambda^2 = -\lambda^2(\lambda - 1).$$

Собственные значения: $\lambda_1 = 0$ с алгебраической кратностью $m_1 = 2$; $\lambda_2 = 1$ с алгебраической кратностью $m_2 = 1$.

#### Шаг 2. Корневое подпространство $V_0^*$

**Ядро первой степени** $\ker A$:

$$A \xrightarrow{\substack{R_2 \leftarrow 4R_2 - 5R_1 \\ R_3 \leftarrow 2R_3 - 3R_1}} \begin{pmatrix} 4 & -5 & 2 \\ 0 & -3 & 2 \\ 0 & -3 & 2 \end{pmatrix} \xrightarrow{R_3 \leftarrow R_3 - R_2} \begin{pmatrix} 4 & -5 & 2 \\ 0 & -3 & 2 \\ 0 & 0 & 0 \end{pmatrix}.$$

$\operatorname{rank} A = 2$, поэтому $\dim \ker A = 1$. Геометрическая кратность $1 < m_1 = 2$ — нужна вторая степень.

Из ступенчатого вида: $-3x_2 + 2x_3 = 0 \Rightarrow x_2 = \frac{2}{3}x_3$; $4x_1 - 5 \cdot \frac{2}{3}x_3 + 2x_3 = 0 \Rightarrow 4x_1 = \frac{4}{3}x_3 \Rightarrow x_1 = \frac{1}{3}x_3$.

При $x_3 = 3$: базисный вектор $(1, 2, 3)^T$.
$$\ker A = \left\langle \begin{pmatrix} 1 \\ 2 \\ 3 \end{pmatrix} \right\rangle.$$

**Ядро второй степени** $\ker A^2$:

Вычислим $A^2$. Строка 1 матрицы $A$: $(4, -5, 2)$. Умножаем на $A$:
$$A^2_{1,\bullet}: \quad 4(4,-5,2)+(-5)(5,-7,3)+2(6,-9,4) = (16,-20,8)+(-25,35,-15)+(12,-18,8) = (3,-3,1).$$

Строки 2 и 3 вычисляются аналогично; оказывается, все строки $A^2$ одинаковы:
$$A^2 = \begin{pmatrix} 3 & -3 & 1 \\ 3 & -3 & 1 \\ 3 & -3 & 1 \end{pmatrix}.$$

$\operatorname{rank} A^2 = 1$, поэтому $\dim \ker A^2 = 2 = m_1$. Стабилизация достигнута.

Единственное уравнение $\ker A^2$: $3x_1 - 3x_2 + x_3 = 0$, откуда $x_3 = -3x_1 + 3x_2$. Свободные переменные $x_1, x_2$:

При $x_1=1, x_2=0$: $x_3 = -3$, вектор $(1,0,-3)^T$.

При $x_1=0, x_2=1$: $x_3 = 3$, вектор $(0,1,3)^T$.

Проверка: $A^2 \cdot (1,0,-3)^T = (3\cdot1 - 3\cdot0 + 1\cdot(-3),\ \ldots) = (0, 0, 0)^T$ $\checkmark$

$$V_0^* = \ker A^2 = \left\langle \begin{pmatrix}1\\0\\-3\end{pmatrix},\ \begin{pmatrix}0\\1\\3\end{pmatrix} \right\rangle, \quad \dim V_0^* = 2.$$

#### Шаг 3. Корневое подпространство $V_1^*$

Алгебраическая кратность $m_2 = 1$ — достаточно $\ker(A - E)$.

$$A - E = \begin{pmatrix} 3 & -5 & 2 \\ 5 & -8 & 3 \\ 6 & -9 & 3 \end{pmatrix} \xrightarrow{\substack{R_2 \leftarrow 3R_2 - 5R_1 \\ R_3 \leftarrow R_3 - 2R_1}} \begin{pmatrix} 3 & -5 & 2 \\ 0 & 1 & -1 \\ 0 & 1 & -1 \end{pmatrix} \xrightarrow{R_3 \leftarrow R_3 - R_2} \begin{pmatrix} 3 & -5 & 2 \\ 0 & 1 & -1 \\ 0 & 0 & 0 \end{pmatrix}.$$

$\dim \ker(A-E) = 1 = m_2$. Корневое совпадает с собственным.

Из второй строки: $x_2 = x_3$. Из первой: $3x_1 - 5x_3 + 2x_3 = 0 \Rightarrow x_1 = x_3$.

При $x_3 = 1$: базисный вектор $(1, 1, 1)^T$.

$$V_1^* = \left\langle \begin{pmatrix}1\\1\\1\end{pmatrix} \right\rangle, \quad \dim V_1^* = 1.$$

#### Итог

$$\mathbb{R}^3 = V_0^* \oplus V_1^*, \quad \dim V_0^* + \dim V_1^* = 2 + 1 = 3.\ \checkmark$$

На $V_0^*$ оператор нильпотентен второго порядка (ядро первой степени одномерно, а не двумерно). На $V_1^*$ — умножение на 1. Оператор не диагонализируем.

---

### Задача 3. Циклическое подпространство (задача 2б, лист ЖНФ)

**Условие:** $V = M_2(\mathbb{R})$, оператор $A : X \mapsto X \cdot B$, где
$$B = \begin{pmatrix} 1 & 2 \\ 0 & 1 \end{pmatrix}, \quad v = \begin{pmatrix} 1 & 1 \\ -1 & 1 \end{pmatrix}.$$

Найти базис циклического подпространства $Z(A, v)$ и матрицу сужения $A|_{Z(A,v)}$ в этом базисе.

#### Шаг 1. Вычисляем $v_1 = v$, $v_2 = Av = v \cdot B$

$$v_2 = \begin{pmatrix}1&1\\-1&1\end{pmatrix}\begin{pmatrix}1&2\\0&1\end{pmatrix} = \begin{pmatrix}1 \cdot 1+1 \cdot 0 & 1 \cdot 2+1 \cdot 1 \\ (-1) \cdot 1+1 \cdot 0 & (-1) \cdot 2+1 \cdot 1\end{pmatrix} = \begin{pmatrix}1&3\\-1&-1\end{pmatrix}.$$

#### Шаг 2. Проверяем линейную независимость $v_1$ и $v_2$

Если $v_2 = \alpha v_1$, то из элемента $(1,2)$: $3 = \alpha \cdot 1$, из элемента $(2,2)$: $-1 = \alpha \cdot 1$ — противоречие $(\alpha = 3 \neq -1)$. Значит, $v_1$ и $v_2$ линейно независимы.

#### Шаг 3. Вычисляем $v_3 = A^2v = v_2 \cdot B$

$$v_3 = \begin{pmatrix}1&3\\-1&-1\end{pmatrix}\begin{pmatrix}1&2\\0&1\end{pmatrix} = \begin{pmatrix}1 \cdot 1+3 \cdot 0 & 1 \cdot 2+3 \cdot 1 \\ (-1) \cdot 1+(-1) \cdot 0 & (-1) \cdot 2+(-1) \cdot 1\end{pmatrix} = \begin{pmatrix}1&5\\-1&-3\end{pmatrix}.$$

#### Шаг 4. Проверяем, лежит ли $v_3$ в $\langle v_1, v_2 \rangle$

Ищем $\alpha, \beta$ такие, что $v_3 = \alpha v_1 + \beta v_2$:

$$\begin{pmatrix}1&5\\-1&-3\end{pmatrix} = \alpha\begin{pmatrix}1&1\\-1&1\end{pmatrix} + \beta\begin{pmatrix}1&3\\-1&-1\end{pmatrix} = \begin{pmatrix}\alpha+\beta & \alpha+3\beta \\ -\alpha-\beta & \alpha-\beta\end{pmatrix}.$$

Система (4 уравнения из 4 элементов матрицы):

$(1,1)$: $\alpha + \beta = 1$

$(1,2)$: $\alpha + 3\beta = 5$

$(2,1)$: $-\alpha - \beta = -1$ (совпадает с первым)

$(2,2)$: $\alpha - \beta = -3$

Из первого и второго: $2\beta = 4 \Rightarrow \beta = 2$, $\alpha = -1$.

Проверка по $(2,2)$: $(-1) - 2 = -3$ $\checkmark$

Итак, $A^2 v = -v_1 + 2v_2$, цикл замкнулся.

#### Шаг 5. Базис и матрица сужения

Базис $Z(A, v) = \langle v_1, v_2 \rangle$:
$$v_1 = \begin{pmatrix}1&1\\-1&1\end{pmatrix}, \quad v_2 = \begin{pmatrix}1&3\\-1&-1\end{pmatrix}.$$

Координаты образов в базисе $\{v_1, v_2\}$:

$A(v_1) = v_2 = 0 \cdot v_1 + 1 \cdot v_2 \Rightarrow$ первый столбец: $(0, 1)^T$.

$A(v_2) = A^2 v = -1 \cdot v_1 + 2 \cdot v_2 \Rightarrow$ второй столбец: $(-1, 2)^T$.

$$[A|_{Z(A,v)}]_{\{v_1, v_2\}} = \begin{pmatrix} 0 & -1 \\ 1 & 2 \end{pmatrix}.$$

#### Проверка

Характеристический многочлен матрицы сужения: $\lambda^2 - 2\lambda + 1 = (\lambda - 1)^2$. Единственное собственное значение $\lambda = 1$ кратности 2; геометрическая кратность равна 1 (матрица $[A|_Z] - E = \begin{pmatrix}-1&-1\\1&1\end{pmatrix}$ имеет ранг 1). Матрица сужения — жорданов блок $2 \times 2$ с $\lambda = 1$, что ожидаемо: $B = E + N$, где $N = \begin{pmatrix}0&2\\0&0\end{pmatrix}$ нильпотентна.

**Ответ:**
$$Z(A,v) = \left\langle \begin{pmatrix}1&1\\-1&1\end{pmatrix},\ \begin{pmatrix}1&3\\-1&-1\end{pmatrix}\right\rangle, \quad [A|_Z] = \begin{pmatrix}0&-1\\1&2\end{pmatrix}.$$

---

## Сравнительная таблица методов

| Ситуация | Что делать | Когда останавливаться |
|---|---|---|
| $\operatorname{rank} A = 1$ | Формула $A^2 = (\operatorname{tr} A)A$, аналитически | Спектр получается немедленно |
| Все алг. кратности = 1 | Найти $\ker(A - \lambda_i E)$ для каждого $\lambda_i$ | После нахождения ядра первой степени |
| Геом. кратность $<$ алг. кратности | Итерировать $\ker(A-\lambda_i E)^k$, $k = 1, 2, \ldots$ | Когда $\dim\ker(A-\lambda_i E)^k$ достигло алг. кратности $m_i$ |
| Циклическое подпространство | Строить $v, Av, A^2v,\ldots$ | Когда $A^kv$ линейно выражается через предыдущие |

---

## Справочный лист

**Корневое подпространство:**
$$V_\lambda^* = \ker(A - \lambda E)^m, \quad m = \text{алг. кратность } \lambda, \quad \dim V_\lambda^* = m.$$

**Разложение в прямую сумму** (все корни над $\mathbb{R}$):
$$V = V_{\lambda_1}^* \oplus \cdots \oplus V_{\lambda_k}^*.$$

**Строгое возрастание цепочки ядер:**
$$\dim \ker(A-\lambda E) < \dim\ker(A-\lambda E)^2 < \cdots < \dim\ker(A-\lambda E)^p = m.$$

**Матрица ранга 1:** $A = cb^T \Rightarrow A^2 = (\operatorname{tr} A)A$.

Спектр при $\operatorname{tr} A \neq 0$: $\{0^{(n-1)},\ (\operatorname{tr} A)^{(1)}\}$.

Спектр при $\operatorname{tr} A = 0$: $\{0^{(n)}\}$, и $A^2 = 0$.

**Связь следа и собственных значений:**
$$\operatorname{tr} A = \lambda_1 + \cdots + \lambda_n.$$

**Характеристический многочлен $3 \times 3$:**
$$\chi_A(\lambda) = -\lambda^3 + (\operatorname{tr} A)\lambda^2 - \Bigl(\sum_{i < j} M_{\{i,j\}}\Bigr)\lambda + \det A,$$
где $M_{\{i,j\}} = a_{ii}a_{jj} - a_{ij}a_{ji}$ — главный минор из строк/столбцов $i$ и $j$.

**Матрица сужения на $Z(A,v)$** в базисе $\{v, Av, \ldots, A^{d-1}v\}$, если $A^d v = \sum_{j=0}^{d-1} a_j A^j v$:
$$[A|_Z] = \begin{pmatrix} 0 & 0 & \cdots & 0 & a_0 \\ 1 & 0 & \cdots & 0 & a_1 \\ 0 & 1 & \cdots & 0 & a_2 \\ \vdots & & \ddots & \vdots & \vdots \\ 0 & 0 & \cdots & 1 & a_{d-1} \end{pmatrix}.$$

---

## Типичные ошибки семинара

1. Путают геометрическую и алгебраическую кратности. Геометрическая — $\dim\ker(A-\lambda E)$; алгебраическая — степень $\lambda$ в $\chi_A$. Первая всегда не превосходит вторую.

2. Останавливают цепочку ядер слишком рано. Нужно продолжать, пока $\dim\ker(A-\lambda E)^k$ не достигнет алгебраической кратности.

3. Ошибаются в знаках при вычислении $\det A$ и миноров. В задаче 1а второй столбец матрицы имеет отрицательные элементы — при раскладке по первой строке это требует особого внимания.

4. При умножении матриц путают порядок: оператор $A: X \mapsto XB$ вычисляет $XB$, а не $BX$. Порядок множителей имеет значение.

5. При составлении матрицы сужения: $j$-й столбец — координаты $A(v_j)$ в базисе $\{v_1, \ldots, v_d\}$, а не образ $v_j$ в стандартном базисе.

6. При проверке принадлежности $A^k v$ линейной оболочке: нужно проверить совместность всей системы, сравнивая все элементы матриц, а не только один.
