## ## Общий контекст

Основная цель лекции — научиться упрощать изучение линейных операторов. Если у нас есть пространство огромной размерности, работать с ним целиком сложно. Идея состоит в том, чтобы «разбить» это пространство на более мелкие части (подпространства) так, чтобы оператор действовал внутри них независимо. Это позволяет свести одну сложную задачу к нескольким простым.

Эта тема является фундаментом для понимания структуры линейного оператора, приведения его матрицы к каноническим видам (например, к диагональному или Жорданову) и тесно связана с понятиями ядра, образа и сопряженного пространства.

---

## ## Основное содержание

### 1. Определение инвариантного подпространства

**Мотивация и интуиция:** Представьте, что у вас есть комната (пространство), и в ней стоит шкаф (подпространство). Линейный оператор — это некое правило перемещения предметов. Если, согласно этому правилу, любой предмет, взятый из шкафа, после перемещения снова оказывается в шкафу, то этот шкаф называется **инвариантным** относительно данного правила. Мы как бы «не выходим за пределы» этого подпространства под действием оператора.

**Формальное определение:** Пусть $V$ — векторное пространство, а $A$ — эндоморфизм (линейный оператор, действующий из $V$ в $V$). Подпространство $U \subseteq V$ называется **инвариантным относительно оператора $A$** (или просто $A$-инвариантным), если образ этого подпространства снова лежит в нем самом: $$A(U) \subseteq U$$ Это означает, что для любого вектора $u \in U$ его образ $A(u)$ также принадлежит $U$.

---

### 2. Примеры инвариантных подпространств

1. **Тривиальные примеры:** В любом пространстве для любого оператора всегда есть два инвариантных подпространства: нулевое подпространство ${0}$ и само пространство $V$.
    - _Почему:_ Нулевой вектор всегда переходит в нулевой. А из всего пространства выйти в принципе невозможно, так как оператор действует внутри него.
2. **Ядро и образ:**
    - Любое подпространство, **содержащееся в ядре** ($U \subseteq Ker A$), инвариантно.
        - _Интуиция:_ Все векторы из такого $U$ переходят в ноль, а ноль лежит в любом подпространстве.
    - Любое подпространство, **содержащее образ** ($Im A \subseteq U$), инвариантно.
        - _Интуиция:_ Куда бы оператор ни отправил вектор, он гарантированно попадет в $Im A$, а значит, и в $U$.
3. **Проекция и Отражение:** Пусть $V = U \oplus W$ (прямая сумма).
    - Для **проекции** на $U$ параллельно $W$: и $U$, и $W$ являются инвариантными. Векторы из $U$ остаются на месте, векторы из $W$ переходят в ноль (который лежит в $W$).
    - Для **отражения** относительно $U$ вдоль $W$: оба подпространства также инвариантны. Векторы из $U$ не меняются, а векторы из $W$ просто меняют знак ($w \to -w$), оставаясь в $W$.
4. **Оператор дифференцирования ($D$):** В пространстве многочленов инвариантными подпространствами являются пространства многочленов степени не выше $n$ ($P_n[x]$).
    - _Интуиция:_ При дифференцировании степень только падает, мы никогда не получим многочлен большей степени.
5. **Оператор сдвига:** В бесконечномерном пространстве с базисом ${e_i}_{i \in \mathbb{Z}}$, где $A(e_i) = e_{i+1}$, нетривиальных конечномерных инвариантных подпространств нет. Однако, если оператор переводит $e_i$ в $e_{i+2}$, то подпространства, порожденные векторами только с четными или только с нечетными индексами, будут инвариантными.

---

### 3. Коммутирующие операторы и инвариантность

**Определение:** Операторы $A$ и $B$ называются коммутирующими, если $AB = BA$. _Пример:_ Операторы $A$ и $A - \lambda E$ всегда коммутируют.

**Лемма:** Если операторы $A$ и $B$ коммутируют, то ядро и образ одного оператора инвариантны относительно другого.

**Доказательство (для образа):**

1. Пусть $y \in Im A$. Нужно доказать, что $B(y) \in Im A$.
2. Раз $y \in Im A$, то существует такой $x$, что $A(x) = y$.
3. Применим $B$ к обеим частям: $B(A(x)) = B(y)$.
4. Так как операторы коммутируют, $B(A(x)) = A(B(x))$.
5. Значит, $B(y) = A(B(x))$. Это означает, что $B(y)$ является образом вектора $B(x)$ под действием оператора $A$.
6. Следовательно, $B(y) \in Im A$. Что и требовалось доказать.

**Доказательство (для ядра):**

1. Пусть $x \in Ker A$ (т.е. $A(x) = 0$). Нужно доказать, что $B(x) \in Ker A$.
2. Проверим, куда перейдет $B(x)$ под действием $A$: $A(B(x))$.
3. В силу коммутативности: $A(B(x)) = B(A(x))$.
4. Так как $x \in Ker A$, то $A(x) = 0$. Получаем $B(0)$.
5. Любой линейный оператор переводит ноль в ноль: $B(0) = 0$.
6. Значит, $A(B(x)) = 0$, то есть $B(x) \in Ker A$.

---

### 4. Матрица оператора при наличии инвариантного подпространства

Если у нас есть инвариантное подпространство $U$, мы можем выбрать «удачный» базис, согласованный с ним: сначала взять базис самого $U$ ($e_1, \dots, e_k$), а затем дополнить его до базиса всего пространства $V$ ($e_{k+1}, \dots, e_n$).

**Лемма о блочно-треугольной матрице:** В таком согласованном базисе матрица оператора $A$ имеет верхнеблочно-треугольный вид: $$\begin{pmatrix} A_U & B \\ 0 & C \end{pmatrix}$$ где:

- $A_U$ — матрица **сужения** оператора на подпространство $U$.
- $C$ — матрица **фактор-оператора** в фактор-пространстве $V/U$.

**Интуиция:** Нули в левом нижнем углу возникают именно потому, что векторы из $U$ (первые $k$ векторов базиса) при действии оператора остаются в $U$. Значит, в их разложении по всему базису коэффициенты при «чужих» векторах ($e_{k+1}, \dots, e_n$) будут равны нулю.

#### Сужение и фактор-оператор

1. **Сужение ($A|_U$):** Это тот же оператор, но мы смотрим на него только «глазами» подпространства $U$. Он действует из $U$ в $U$.
2. **Фактор-оператор ($\bar{A}$):** Он действует на классы смежности в фактор-пространстве $V/U$ по правилу: $\bar{A}(v + U) = A(v) + U$.
    - _Корректность:_ Лектор доказывает, что если взять разных представителей одного класса ($v_1 - v_2 \in U$), то благодаря инвариантности $U$ их образы тоже попадут в один и тот же класс.
    - _Линейность:_ Фактор-оператор сохраняет сумму классов и умножение на скаляр.

---

### 5. Прямые суммы и диагонализируемость

Если всё пространство распадается в прямую сумму инвариантных подпространств $V = U_1 \oplus U_2 \oplus \dots \oplus U_s$, то в согласованном базисе матрица становится **блочно-диагональной**: $$\begin{pmatrix} A_1 & 0 & \dots & 0 \\ 0 & A_2 & \dots & 0 \\ \vdots & \vdots & \ddots & \vdots \\ 0 & 0 & \dots & A_s \end{pmatrix}$$ Это идеальная ситуация — мы полностью разделили жизнь оператора на независимые блоки.

**Диагонализируемость:** Оператор называется диагонализируемым, если существует базис, в котором его матрица чисто диагональна.

- Это эквивалентно тому, что всё пространство можно разбить в прямую сумму **одномерных** инвариантных подпространств.

**Контрпример (дифференцирование):** Оператор дифференцирования в $P_n[x]$ нельзя привести даже к блочно-диагональному виду (кроме тривиального). Все его инвариантные подпространства вложены друг в друга как матрешки ($P_0 \subset P_1 \subset P_2 \dots$), и у них нет инвариантных прямых дополнений — они всегда пересекаются по ненулевым векторам.

---

### 6. Инвариантность и сопряженный оператор

**Лемма:** Подпространство $U$ инвариантно относительно $A$ тогда и только тогда, когда его **аннулятор** $U^\circ$ инвариантен относительно сопряженного оператора $A^*$. ($U \subseteq V$ инвариантно $\iff U^\circ \subseteq V^*$ инвариантно).

**Идея доказательства:** Нужно проверить, что для любой формы $\omega \in U^\circ$ форма $A^*(\omega)$ также зануляется на всех векторах из $U$. По определению сопряженного оператора: $\langle A^*(\omega), u \rangle = \langle \omega, A(u) \rangle$. Поскольку $u \in U$ и $U$ инвариантно, то $A(u) \in U$. А так как $\omega$ из аннулятора $U$, она превращает любой вектор из $U$ в ноль. Значит, $\langle \omega, A(u) \rangle = 0$.

---

## Ключевые инсайты

1. **Инвариантность = Упрощение:** Поиск инвариантных подпространств — это способ «разрезать» матрицу оператора на независимые или слабо связанные блоки.
2. **Собственные векторы:** Одномерное инвариантное подпространство — это и есть направление **собственного вектора**. Если $A(u) = \lambda u$, то прямая, на которой лежит $u$, никуда не смещается, только растягивается. Это «атомарный» уровень инвариантности.
3. **Связь размерностей:** Если подпространство имеет размерность $n-1$ (коразмерность 1), то его аннулятор имеет размерность 1. Это позволяет связывать гиперплоскости в основном пространстве с собственными векторами в сопряженном.
4. **Геометрический смысл фактор-оператора:** Это взгляд на оператор «сквозь пальцы»: мы игнорируем всё, что происходит внутри инвариантного подпространства $U$, и смотрим только на то, как оператор перемещает целые пласты (классы смежности).