[[Лекция_13_Особенности_разработки_и_внедрения_ИИ_в_нефтегазе.pdf]]
## Подробный конспект занятия: Особенности разработки и внедрения ИИ в нефтегазовой отрасли

Лектор: **Павел Вавилов**, ML-инженер в **Центре Компетенций Искусственного Интеллекта (ЦКИИ) в Газпромнефти** и аспирант второго курса ИТМО.

### I. Введение и особенности отрасли

Развитие ИИ в нефтегазовой отрасли является не просто модным трендом, а **обоснованной необходимостью**.

1. **Сложность месторождений**: Современная добыча нефти требует бурения скважин на глубину 4 км и более (более 60% всей добываемой нефти в этом году). Чем глубже залежи, тем сложнее конструкции и выше требования к безопасности.
2. **Эффективность**: ИИ необходим для повышения эффективности и **ускорения принятия управленческих решений**, а также для анализа геологической системы вокруг скважины в реальном времени.
3. **Безопасность**: ИИ используется для анализа и **предсказания поломок оборудования** (любой техники) и обеспечения безопасности людей на предприятиях.
4. **Финансирование**: Расходы нефтяных компаний в России на цифровизацию растут (прирост составил 55% за прошлый год по сравнению с позапрошлым годом), при этом **почти 40% (или половина) этих расходов приходится именно на ИИ**.
5. **Роль ИИ**: ИИ создается как **помощник человека** (дополнительная пара рук и глаз), а не как полная замена специалистов.

### II. Примеры ИИ-проектов в Газпромнефти

Проекты реализуются в сферах компьютерного зрения (CV) и прогнозирования физических процессов:

1. **Детекция поломок с помощью дронов**:
    
    - Задача: Обследование длинных воздушных линий электропередач, чтобы вовремя обнаружить поломки. Ранее требовался просмотр огромного видеоряда человеком.
    - Решение: Использование **свёрточных нейронных сетей (CNN)** для анализа видеоряда.
    - _**Интуитивное понимание: Свёрточная нейронная сеть (CNN)**_ — **это как очень внимательный глаз, который умеет "смотреть" на изображения и видео.** Она разбивает картинку на маленькие части (свертки) и учится узнавать специфические признаки, например, поврежденную опору или трещину, выполняя работу намного быстрее человека.
2. **Определение промышленных объектов на спутниковых снимках**:
    
    - Задача: Помочь ГИС-специалистам (специалистам, работающим с геоданными) найти на огромных спутниковых снимках дороги, карьеры, промышленные постройки и болотистые участки для планирования новых месторождений или коммуникаций.
    - Модель: Использовалась предобученная модель **YOLOv11s-seg**.
    - _**Интуитивное понимание: YOLO (You Only Look Once)**_ — **это как скоростной сканер.** Эта модель обучена смотреть на все изображение целиком (за один проход) и быстро определять местоположение и тип объектов. **Fine-tuning (Тонкая настройка)** — это процесс адаптации уже обученной модели (YOLO) под очень специфические задачи и данные (например, наши спутниковые снимки), что требует меньше ресурсов и времени, чем обучение с нуля.
3. **ИИ-ассистент для анализа работы скважин (с использованием RL)**:
    
    - Задача: Создание "агента" для прогнозирования изменений физических полей (давлений, проницаемости, насыщенности) вокруг скважины при изменении режимов добычи.
    - Решение: Использование **обучения с подкреплением (Reinforcement Learning, RL)**.
    - _**Интуитивное понимание: Обучение с подкреплением (RL)**_ — **это метод "кнута и пряника".** Модель (агент) совершает действия в виртуальной среде. Если действие хорошее (повышает эффективность или безопасность), она получает "пряник" (награду). Если плохое, она получает "кнут" (штраф). Так модель учится принимать оптимальные решения.
4. **Прогнозирование параметров скважины через PINN/PINO**:
    
    - Задача: Прогнозирование поведения скважины и ее параметров (давление, насыщенность) с учетом физических законов.
    - Модели: **PINN (Physics-Informed Neural Networks)** и **PINO (Physics-Informed Neural Operators)**.
    - _**Интуитивное понимание: PINN (Физически информированные нейронные сети)**_ — **это обычная нейросеть, которой добавили "совесть" в виде законов физики.** Модель оптимизирует не только ошибку на данных, но и ошибку, связанную с нарушением физических уравнений (дифференциальных уравнений), чтобы ее предсказания были реалистичными и соответствовали действительности. **Функция потерь (Loss Function)** — это "счетчик ошибок" модели. В PINN к нему добавляется "ошибка по физике".
    - _**Интуитивное понимание: Цифровой двойник**_ — **это точная виртуальная копия реального объекта** (например, скважины или завода). Он позволяет проводить симуляции (например, прогнозировать поведение при разных режимах работы), не рискуя реальным оборудованием.

### III. Особенности данных в нефтегазе

Нефтянка использует весь спектр данных, от "больших" до "малых", что обусловливает специфические подходы к работе.

#### Типы данных

1. **Big Data (Большие данные)**:
    - Примеры: Показатели с тысяч датчиков на месторождениях и заводах, сейсмические данные, видеопоток с дронов (очень большой объем данных).
2. **Small Data (Малые данные)**:
    - Примеры: Техническая документация, геологические отчеты, **рукописные журналы** по скважинам.
    - _**Интуитивное понимание: Small Data**_ — **это как редкие, но очень ценные рукописи.** Данных мало, но они содержат уникальную и важную информацию. С ними приходится работать, несмотря на их небольшой объем и "грязный" вид.
3. **Симулированные данные**: Промежуточный случай, когда данные генерируются с помощью симуляторов (например, для проверки полей давлений), что удобно, поскольку позволяет получать неограниченное количество данных, хотя это редкость для других отраслей.

#### Ключевые проблемы данных

1. **"Грязные" / неразмеченные данные**: Включают шум, пропущенные значения и **ошибки оцифровки** (особенно при извлечении текста из рукописных журналов с помощью OCR).
2. **Недостаточный объем**: Особенно актуально для спутниковых снимков (например, в проекте было всего 13 сцен и около 3000 тайлов), что часто ограничивает возможность обучать модели с нуля.
3. **Дисбаланс классов**: Одни классы (например, частые поломки или часто встречающиеся объекты) представлены очень хорошо, а другие (редкие, но важные события) — плохо.

### IV. Методы работы с данными

Для решения проблем с данными применяются следующие подходы:

1. **Feature Engineering (Фичеинжиниринг)**:
    
    - Цель: Создание более информативных признаков (фич) из существующих данных.
    - Методы: **Комбинирование фич** и **составление композитных эмбеддингов**.
    - _**Интуитивное понимание: Фичеинжиниринг**_ — **это "кулинария" данных.** Вы берете исходные признаки и комбинируете их, чтобы получить один, но гораздо более информативный "признак", который модель может лучше усвоить. Важно, однако, не потерять физический смысл получившегося признака.
    - _**Интуитивное понимание: Эмбеддинг**_ — **это векторное представление слова.** Это перевод слов и текста с человеческого языка на язык цифр (векторов), понятный машине, чтобы она могла работать с семантикой предложения.
2. **Добавление синтетики**:
    
    - Цель: Увеличение объема обучающей выборки, особенно для слабо представленных классов.
    - Методы: **Генерация синтетических данных** (например, текстов, похожих на редко встречающиеся) и **аугментация данных** (повороты, добавление шумов, синонимизация текста).
    - Использование **цифровых двойников** и **физически информированных сетей (PINN)** позволяет проводить постоянные симуляции и получать большие массивы данных, моделируя аварии или изменения режимов без риска.

### V. Исследования, разработка и внедрение

Ключевые аспекты успешной разработки ИИ в корпоративной среде:

1. **Важнейший принцип: Погружение в предметную область и понимание бизнес-процессов**:
    
    - Необходимо понимать, откуда берутся данные, как они преобразуются, и как устроены все процессы в компании.
    - Это позволяет разработчику (ML-инженеру, Data Engineer) корректно корректировать свои планы и эффективно общаться с заказчиками, которые часто не являются техническими специалистами. **Понимание данных — ключ к построению хорошей модели**.
2. **Вызов 1: Организационные процедуры**:
    
    - Проблема: Бюрократия, долгие процессы согласования в больших корпорациях.
    - Решение: Демонстрация **быстрых побед (quick wins)** и создание **MVP (Minimal Valuable Product)** для получения поддержки и доверия менеджмента.
3. **Вызов 2: Внедрение в существующую ИТ-структуру**:
    
    - Проблема: Необходимость вписать новый продукт в уже существующую, часто огромную, инфраструктуру.
    - Решение: Использование **промышленных платформ** (например, CBOX от Т1 или собственные платформы Газпромнефти), которые обеспечивают защиту и ускоряют переход от создания продукта к внедрению. Инфраструктура сегодня играет критически важную роль, часто даже более важную, чем выбор самой топовой модели ИИ.

### VI. Результаты внедрения ИИ

Успешное внедрение ИИ оценивается по двум ключевым показателям:

1. **Экономический результат**: Прямое влияние на прибыль или сокращение расходов компании (например, сокращение использования реагентов на Томскнефтехиме на 50-60% благодаря цифровому двойнику).
2. **Качественный результат**: Улучшение процессов и условий работы:
    - Повышение безопасности.
    - Сокращение времени простоя оборудования (например, благодаря цифровым двойникам).
    - **Повышение точности и скорости принятия решений** во всех сферах (добыча, логистика, безопасность).

---

**Ключевые выводы занятия**:

1. **Данные — "сегодняшняя нефть"**: Важно уметь работать с неполными, "грязными" и небольшими данными, так как на их обработку уходит 50–80% всего времени.
2. **Знание предметной области**: Погружение в специфику нефтегаза или другой отрасли критически важно для создания эффективной модели.
3. **Платформенные решения**: Наличие общей платформы для ИИ-решений сильно упрощает внедрение инструментов в реальный промышленный сектор.

---

**Аналогия для закрепления понимания:**

Представьте, что вы — инженер, строящий мост (модель ИИ) через бурную реку (сложные бизнес-процессы).

- **PINN** — это не просто чертеж (данные), это чертеж, который встроен в законы статики и сопротивления материалов (физика). Ваш мост точно не рухнет.
- **Цифровой двойник** — это маленькая, точная модель моста, которую вы построили в лаборатории. Вы можете создать наводнение или ураган (аварийные ситуации) в лаборатории, чтобы понять, как поведет себя настоящий мост, прежде чем его строить, тем самым **генерируя данные** и **повышая безопасность**.
- **Знание предметной области** — это знание геологии берегов реки, чтобы правильно выбрать фундамент. Без этого даже идеальный чертеж (модель) бесполезен.
- **Small Data (Рукописные журналы)** — это как старинные записи, оставленные предыдущими строителями мостов. Их мало, почерк неразборчив, но в них содержатся уникальные секреты, как избежать ошибок.