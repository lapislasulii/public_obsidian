[[Цифровые-двойники.pdf]]
### 1. Обзор процессов Upstream и Downstream

Лекция начинается с напоминания о процессах в нефтегазовой отрасли, которые делятся на **Upstream** (добыча и разведка) и **Downstream** (переработка и сбыт).

- **Upstream** включает: Поиск/разведку (например, с помощью вибротраков, приемников и сейсморазведки), Анализ/оценку/проектирование месторождения, Бурение, и Добычу (например, с помощью станка-качалки).
- **Downstream** включает: Логистику, Переработку (получение дистиллятов, бензина, дизельного топлива), Дистрибуцию и Сбыт.

Основное внимание на занятии уделяется этапам **Анализа, оценки и проектирования, Бурения и Добычи**. Именно на этих этапах теряется большинство денег из-за высокой неопределенности и рисков ошибок при оценке или бурении.

### 2. Принятие решений и тестирование гипотез

Для минимизации рисков и ошибок необходимо принимать правильные решения.

#### Ключевое понятие: Гипотеза

**Статистическая гипотеза** – это формализованное предположение о свойствах случайной величины или виде ее распределения, которое можно подтвердить или опровергнуть на основе данных.

- **Простое пояснение:** _Это наше формальное, измеряемое предположение о том, что произойдет, если мы что-то изменим. Например: "Если мы покажем рекламу после покупки, пользователи будут покупать чаще"._

Для корректной проверки гипотезу необходимо строго формализовать, ответив на три вопроса:

1. **Что изменим?** (Например, сменим "палец вверх" на "сердечко" в соцсети).
2. **На что это повлияет?** (Например, на активность аудитории/трафика).
3. **Как будем измерять?** (Например, по количеству лайков или покупок).

#### Ключевое понятие: A/B-тестирование

**A/B-тестирование** – это метод проверки гипотезы, при котором аудитория делится на две выборки (A и B), и им показываются два разных элемента (например, палец вверх и сердечко), чтобы определить, какой вариант дает лучший результат.

- **Простое пояснение:** _Это как провести контролируемый эксперимент, чтобы точно знать, что именно вызвало изменение. Вы показываете двум разным группам пользователей два разных варианта и сравниваете результаты._

Процесс A/B-тестирования включает пять шагов: формулирование гипотезы (проверяется только одна гипотеза за раз), определение двух тестируемых элементов, определение размера выборок, запуск теста и измерение результата.

#### Переход к промышленности

В онлайн-бизнесе объектом, генерирующим эксперимент, являются **пользователи (люди/покупатели)**. В нефтяной промышленности, при работе с месторождением, объектом, на основе которого производятся оценки, является **скважина**.

Однако проведение прямого A/B-тестирования на промышленных объектах (например, на скважинах или насосах) затруднительно, потому что это **дорого**, **долго** и может привести к **печальным (аварийным) последствиям**. Кроме того, такие эксперименты часто требуют согласования с государством.

### 3. Цифровые двойники (Digital Twins)

Поскольку полноценные эксперименты на реальных объектах невозможны или нежелательны, используется концепция цифровых двойников.

#### Ключевое понятие: Цифровой двойник (ЦД)

**Цифровой двойник (digital twin)** – это виртуальная модель реального объекта, процесса или системы, которая постоянно **синхронизируется** с физическим прототипом через данные, получаемые с датчиков, систем управления и других источников.

- **Простое пояснение:** _Это "живая" компьютерная копия реального объекта, которая постоянно "дышит" одними и теми же данными, что и ее физический прототип. Если в реальности что-то меняется, копия мгновенно обновляется, позволяя нам безопасно "играть" с настройками и предсказывать будущее._

**Цифровой двойник объединяет три компонента**:

1. Физический объект (двигатель, завод, скважина, сердце).
2. Цифровую копию (модель с параметрами и алгоритмами).
3. Синхронизацию данных между ними (через датчики, IoT, SCADA).

**Примеры ЦД:** Цифровой нефтеперерабатывающий завод (позволяет безопасно экспериментировать с давлением и выдачей дистиллятов), цифровой двойник поезда (для оптимизации сопротивления ветру), и цифровой двойник сердца (для моделирования дефектов и изучения поведения клапанов).

#### Задача и принимаемые решения

Основная задача инженеров-нефтяников, решаемая с помощью ЦД: **быстро считать прогноз добычи** с хорошей точностью на краткосрочном (сутки-месяцы) и долгосрочном (годы) периодах.

**ЦД помогает принимать следующие решения**:

- **Бурение новых скважин:** Сколько, куда бурить и как их расположить относительно друг друга.
- **Подбор режима работы:** Определение темпов отбора (добывающие скважины) и нагнетания (нагнетательные скважины, которые закачивают воду или газ для поддержания давления).
- **Подбор геолого-технических мероприятий:** Как увеличить или избежать падения добычи.
- **Оптимизация сценария разработки:** Можно ли разработать месторождение лучше и получить больше.

### 4. Построение и адаптация цифрового двойника

Процесс построения начинается со сбора и анализа исходных данных.

**Исходные данные включают**:

- **ГДИС (Гидродинамические исследования скважин):** Изучение влияния скважин друг на друга.
- **ГИС (Геофизические исследования):** Определение глубины залегания пластов.
- **Сейсмика:** Получение информации о геологической структуре и слоистости.
- **Отбивка, Инклинометрия:** Определение, где скважина пересекает пласт, и углы самой скважины.

Экспертная группа (геологи) собирает, анализирует и интегрирует эти данные, чтобы построить **Геологическую модель** (нефтяники называют её **"болванкой"**), которая является основой для ЦД.

**Проблема нехватки данных:** Степень изученности месторождения, как правило, низкая (в отличие от исторических примеров, где пробурены тысячи скважин, например, на Самотлорском месторождении — более 20 000). Часто мы имеем лишь несколько точек (скважин), на основе которых нужно восстановить всю сложную структуру пласта. Таким образом, базовая модель — это всегда **гипотеза**.

#### Ключевое понятие: Адаптация модели

Поскольку первоначальная модель неточна, мы используем цикл **Анализ -> Моделирование -> Оптимизация**. По мере получения новых данных (в результате бурения, добычи) модель уточняется и адаптируется.

**Адаптация** — это процесс синхронизации виртуальной модели с реальными данными.

- **Простое пояснение:** _Мы постоянно корректируем нашу виртуальную карту месторождения, чтобы она как можно точнее соответствовала тому, что мы фактически видим в скважинах. Это как уточнять прогноз погоды: чем больше данных поступает, тем точнее становится прогноз._

1. **Исходные данные и параметры:** У нас есть реальные данные, базовая модель (гипотеза) и **Параметры** пласта (Пористость, Проницаемость, Насыщенность).
2. **Управляющие параметры:** Выбираются те параметры, в которых мы наименее уверены (например, проницаемость — свойство породы пропускать жидкость). Именно их мы будем адаптировать.
3. **Оптимизация:** Управляющие параметры передаются в оптимизатор. Происходит подбор этих параметров (весов), чтобы прогноз, рассчитанный моделью, максимально совпадал с фактическими данными по добыче.
4. **Применение:** Полученные значения проецируются на всю 3D-модель месторождения.

Задача адаптации с точки зрения машинного обучения близка к работе с **Временными рядами (Time Series)**, поскольку мы предсказываем отложенную выборку по дате. Однако процесс обучения здесь необычен: вместо весов нейронов оптимизируются свойства (многомерные веса) каждой ячейки 3D-куба месторождения.

### 5. Вызовы и проблемы ИИ в цифровых двойниках

Хотя модель может хорошо адаптироваться под новые данные, существует ряд сложностей.

#### 1. Проблема оптимизации и подгонки

**Нюанс:** Математика оптимизатора способна идеально подогнать (переобучить) модель под фактические данные (например, под добычу). Однако геологический эксперт, взглянув на модель, может заметить, что она не соответствует физике или адаптирована только под "фаворитные" скважины, в то время как другие игнорируются. **Подгонка запрещена**.

#### 2. Проблема физичности

**Нюанс:** Алгоритмы оптимизации не гарантируют физичность результатов. Могут возникнуть "нефизичные всплески" дебета (объема добычи) или неадекватное поведение жидкостей.

- **Простое пояснение:** _Математика может найти формулу, которая идеально описывает прошлые данные, но эта формула может противоречить законам физики, по которым работает месторождение. Модель становится точной, но не реалистичной._

#### 3. Финальное слово

Поскольку алгоритмы не могут отличить подгонку от корректной аппроксимации и не всегда гарантируют физичность, **финальное решение о выборе наилучшей адаптированной модели остается за группой экспертов**.

### 6. Управление и будущее: Мультиагентные системы

Цифровой двойник месторождения (ГДМ) изолированно не решает всех бизнес-задач. Необходимо учитывать экономику, строительство инфраструктуры и планирование бурения. Сейчас для получения ответа на комплексный вопрос ("Окупится ли разработка?") требуется длинная цепочка действий, занимающая месяцы: Геология -> Отчетность -> Бизнес-план -> Строительство -> Экономика.

Для ускорения этой цепочки внедряются **большие языковые модели (БЯМ/LLM)** и **мультиагентные системы**.

#### Ключевое понятие: Мультиагентные системы

**Мультиагентная система** – это ансамбль (набор) специализированных агентов ИИ, работающих вместе, часто с иерархией.

- **Простое пояснение:** _Это не один "ультрагений" (одна большая модель), а команда умных помощников. Каждый агент в этой команде специализируется на чем-то своем (например, один знает, как работать с базой данных, другой — как запустить симуляцию бурения), и они общаются друг с другом, чтобы решить комплексную задачу, которая не под силу одному._

В такой системе:

- **Инженер** (человек) задает вопрос.
- **Постановщик** (Агент ИИ) формализует запрос и выделяет исходные данные.
- **Методолог** (Агент ИИ) определяет, как решить задачу.
- **Конструктор** и другие специализированные агенты работают с конкретными ЦД (ГДМ, Экономика, Бурение) и базами данных, используя необходимые интеграции.

#### Главные вызовы для ИИ

Основная проблема в интеграции LLM в промышленность — это передача **доменной экспертизы**:

1. **Интеграция с двойниками:** Необходимо разобраться со сложными, многословными техническими запросами (например, JSON-объектами) для запуска симуляций.
2. **Объяснить LLM:** Как пользоваться специализированным ПО.
3. **Объяснить LLM:** Что такое оптимальная разработка и процессы компании (включая сложные аббревиатуры и правила).
4. **Объяснить LLM:** Геологические закономерности (например, как пористость зависит от проницаемости), которые могут меняться от месторождения к месторождению.

### 7. Общие выводы

- **Экспертиза внутри инженерного ИИ** – главный вызов на сегодняшний день. Нельзя решить задачи "из-под коробки"; всегда требуются адаптация и "костыли".
- Мы не можем проводить эксперименты над промышленными объектами из-за обязательств (закон, экология, люди).
- **Цифровые двойники** – самый точный инструмент и возможность принимать верные решения, прогнозируя последствия.
- **Мультиагентные системы** – наступившее будущее, обеспечивающее сложную интеграцию и контекстный инжиниринг.