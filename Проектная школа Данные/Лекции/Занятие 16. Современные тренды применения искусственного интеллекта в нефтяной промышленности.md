
[[Лекция_16_Современные_тренды_применения_ИИ_в_нефтяной_промышленности.pdf]]
**Подробный конспект занятия: Современные тренды применения искусственного интеллекта в нефтяной промышленности**

Сегодняшняя лекция была посвящена современным трендам применения искусственного интеллекта (ИИ) в целом, и, в частности, в нефтяной промышленности.

В рамках лекции были рассмотрены следующие основные тренды:

1. **Генеративный ИИ** (Generative AI).
2. **Агентный ИИ** (Agentic AI).
3. **Цифровые двойники** (Digital Twins) (упомянуто как направление, но подробно не обсуждалось, так как была отдельная лекция).
4. **Дополненный ИИ** (Augmented AI).
5. **Гибридный ИИ** (Hybrid AI).
6. **Оптимизация с помощью ИИ** (Optimization with AI).

---

### 1. Генеративный ИИ (Generative AI)

Генеративный ИИ является, пожалуй, основным направлением, которое ассоциируется у людей с ИИ (например, через **ChatGPT**).

**Пояснение простым языком:** Это технологии, которые могут создавать новый контент (текст, изображения, дизайн) по запросу.

**Примеры применения Генеративного ИИ в мире:**

- **Генеративный дизайн:** Модель предлагает структуру, форму или модель физического объекта для оптимизации, например, использования металла. Это может привести к созданию более прочных деталей с меньшими затратами ресурсов.
- **Дизайн химических соединений (Drug Design):** Создание новых молекул, обладающих заранее заданными необходимыми свойствами, с помощью структурного описания.
- **Генеративное проектирование:** Проектирование дорог или систем с учетом геологического ландшафта.

**Примеры применения Генеративного ИИ в «Газпромнефти» (ГПН):**

- Генерация геологических полей (например, генерация датасетов).
- Генерация или анализ сложных чертежей (моделей), которые сложно чертить вручную.

#### 1.1. Большие языковые модели (LLMs — Large Language Models)

LLMs — это частный пример Генеративного ИИ.

**Концепция:** LLMs — это группа моделей и подходов, реализующих решение задачи **next word (token) prediction** (предсказание следующего слова или токена).

- **Next word (token) prediction:** Задача по предсказанию $N+1$ токена из положения $N$.
- **Пояснение простым языком:** Представьте, что модель — это продвинутый автозаполнитель. Она берет то, что вы уже написали, и пытается угадать, какой токен (слово или часть слова) с наибольшей вероятностью должен стоять следующим. Повторяя этот процесс, она генерирует целое предложение или ответ.

**Примеры LLMs:** ChatGPT, DeepSeek (сопоставим с ChatGPT, но не требует VPN и популярен в России), Claude.

#### 1.2. Архитектура LLMs: Трансформеры (Transformers)

В основе всех языковых моделей лежит архитектура **Трансформеров**.

- **История:** Архитектура была представлена в оригинальной статье в 2017 году.
- **Проблемы предыдущих архитектур (LSTM, RNN):** Серьезные проблемы с обработкой больших текстов, включая взрывающийся градиент и неспособность видеть долгие последовательности текста.
- **Основные особенности Трансформеров:**
    - **Механизм Self-Attention (Само-внимание):** Позволяет модели понимать зависимости между словами, даже если они далеко друг от друга в тексте.
    - **Позиционное кодирование (Positional Encoding):** Позволяет сообщать модели порядок слов и их значение в конкретном положении в предложении. Благодаря этому отпала необходимость в сложной предобработке текста (удаление пунктуации, стоп-слов, приведение к корню).

**Семейства моделей на основе Трансформеров:**

1. **Семейство BERT (Encoder):** Левая часть Трансформера (кодировщик). Используется для задач **классификации** (например, как в рамках хакатона).
2. **Семейство GPT (Decoder):** Правая часть Трансформера (декодер). Используется для **генерации** какого-либо контента.

#### 1.3. Применение LLMs в нефтяной компании

- **Корпоративные чат-боты:** Быстрые ответы на внутренние вопросы сотрудников (например, как оформить отпуск или подать заявление на командировку), используя внутренние данные компании.
- **RAG-системы (Retrieval-Augmented Generation):** Системы на основе LLM, содержащие точные доменные знания.
    - **Пояснение простым языком:** RAG — это способ дать LLM доступ к дополнительной, реальной информации (векторному хранилищу или базе данных). Модель "сбегает" туда, находит нужный сегмент знаний, и возвращается с ответом, который подкреплен фактами. При этом модель не дообучается напрямую (не "файтюнится"), а лишь дополняется хранилищем.
- **Агенты:** Сущности на основе LLM, которые могут помогать специалистам в работе.

---

### 2. Агентный ИИ (Agentic AI)

Изначально концепция агента появилась в **обучении с подкреплением (Reinforcement Learning)**.

#### 2.1. Обучение с подкреплением (RL)

**Концепция:** Агент (сущность, например, робот) находится в определенной среде (environment) и совершает действие (take action). В ответ среда возвращает ему обратную связь в виде **награды (reward)**.

- **Пояснение простым языком:** Если робот делает шаг и падает, он получает отрицательную награду. Если делает успешный шаг, получает положительную награду. Агент учится, пытаясь перейти в новое состояние (New State) с максимально высокой положительной наградой. Это базовый концепт, на котором, например, основано обучение роботов ходить.

#### 2.2. Отличие LLM от LLM-Агента

В современном ИИ агенты — это сущности, основанные на больших языковых моделях, но обладающие дополнительными возможностями.

|Характеристика|Генеративный ИИ (Gen AI)|Агентный ИИ (Agentic AI)|
|:--|:--|:--|
|**Вход**|Промпт (запрос).|Конкретная задача.|
|**Цикл работы**|Вы посылаете запрос, модель отвечает. Бесконечный цикл правок.|Более сложная схема: Агент составляет план, совершает действия, наблюдает, запоминает и корректирует промпты.|
|**Ключевые отличия**|LLM в ядре.|LLM в ядре, **набор инструментов (тулинг)**, **память**, **коррекция промптов**.|

**Пояснение простым языком:** Развернутая LLM — это как калькулятор: вы вводите пример, он выдает ответ. Агент — это как стажер: вы даете ему задачу ("Составь отчет"), он сам решает, какие программы открыть (тулинг), какие шаги выполнить, помнит, что он делал вчера, и может сам улучшить свои инструкции (коррекция промптов), чтобы в следующий раз сделать лучше.

**Применение Агентов в нефтяной компании (часто в виде многоагентных систем):**

- **Оркестрация процессов:** Планирование, выбор цифровых моделей, их запуск и экспертиза результатов работы.
- **Цифровые НИОКР (Научно-исследовательские, опытно-конструкторские работы):** Виртуальная команда агентов может проверять гипотезы, что экономит время специалистов и деньги компании, которые могли бы быть потрачены на множество реальных НИОКР.
- **Цифровизация предприятий:** Управление параметрами оборудования на производстве (например, вентилями, задвижками) с помощью коллективного разума агентов, обменивающихся информацией.

---

### 3. Дополненный ИИ (Augmented AI)

**Концепция:** Использование ИИ для усиления естественного интеллекта человека.

**Аналогия простым языком:** Это **экзоскелет для мозга специалиста**. ИИ подсказывает, добавляет новую информацию, чтобы специалист ничего не забыл, но **решение всегда остается за человеком**.

**Примеры применения Дополненного ИИ:**

- **Очки дополненной реальности с ИИ:** Используются для обучения специалистов реальным операциям в опасных условиях (например, для высотных работ) или для подсказок по работе с электроникой.
- **Оптимизация добычи:** Виртуальный помощник для специалистов на скважинах, который в высокотехнологичных очках может указывать на странные моменты или подсказывать, какие параметры подкрутить для улучшения результата.
- **Оптимизация логистики:** Агент, который предлагает логистам управленческие решения по маршрутам, но окончательное решение принимает человек.
- **Оптимизация правовых процессов:** Цифровой помощник для юридического отдела, который помогает разобраться в сложных процессах, прикладывая ссылки на законодательство, чтобы избежать галлюцинаций (выдумывания фактов).

---

### 4. Оптимизация с помощью ИИ

Оптимизация — это улучшение существующих технологий или решений через использование ИИ.

**Концепция:** ИИ использует исторические данные и результаты моделирования для исправления и усовершенствования решений, которые ранее были приняты людьми.

**Примеры:**

- **Оптимизация расстановки скважин:** В реальном кейсе изменение расположения всего одной скважины, предложенное моделью, привело к увеличению накопленной добычи нефти на 10% и уменьшению накопленной добычи воды на 8%.
- Оптимизация также может быть реализована с помощью **обучения с подкреплением**, где действие агента — это координаты следующей скважины, а награда — изменение добычи нефти.
- С помощью ML-модели можно добиться того же суммарного эффекта, что и при экспертной расстановке, но с меньшим количеством скважин.

---

### 5. Гибридный ИИ (Hybrid AI)

**Концепция:** Сочетание лучших сторон физического моделирования и решений, основанных на ИИ (нейронных сетях).

- **Синоним:** **Physics-Informed Machine Learning (PIML)** — построение нейронных сетей, которые аппроксимируют дифференциальные уравнения (физику) и реальные измерения (данные).
- **Важность:** Гибридный ИИ особенно ценен в реальной жизни, где часто встречается **Small Data** (мало данных), а не Big Data, с которой лучше работают обычные трансформеры.

**Преимущества Гибридного ИИ:**

- **Скорость и Устойчивость** (традиционно от физических симуляторов).
- **Гибкость** (от ИИ — можно использовать для разного круга задач).
- **Интерпретируемость:** Благодаря добавлению физических симуляторов, мы можем понять, как модель получила состояние B из состояния А (в отличие от большинства традиционных ИИ-алгоритмов, которые являются "черным ящиком").

**Пояснение простым языком:** Это умная модель, которая, помимо изучения данных, обязана подчиняться законам физики. Например, если она моделирует поток жидкости, она не может предсказать, что вода внезапно потечет вверх, потому что в ее алгоритм "вшита" гравитация.

**Применение Гибридного ИИ в ГПН:**

- **Прогнозирование ледовой обстановки:** Моделирование поведения жидкости и кристаллизации льда для оптимизации маршрутов ледоколов (снижение расхода топлива).
- **Моделирование физических полей:** Моделирование полей проницаемости, давлений и насыщенности.
- **Моделирование динамики газонефтяного контакта:** Моделирование поверхности раздела фаз между нефтью и газовой шапкой в пласте.

---

### Технические детали (Хакатон)

В ходе обсуждения хакатона были раскрыты следующие технические детали относительно проверяющей модели:

1. **Модель:** Используется **Tiny 2 Rubert от Coin Integrated** (меньшая модель, которая обучается быстрее, чем RuBERT Large, но имеет сопоставимые метрики).
2. **Токенизатор:** Используется соответствующий токенизатор с HuggingFace.
3. **Функция потерь (Loss):** Используется **Focal Loss** (для работы с большим количеством классов).
4. **Голова классификатора (Кастомная архитектура):** Линейный слой, затем нелинейность (ReLU с Dropout 0.3), и еще один линейный слой на выход (по количеству классов — 36 нейронов).
5. **Формула скора:** Макро F1 скор (общий для всех классов) минус 0.1, умноженное на квадратный корень из дисперсии макро F1 скора по классам.
    - **Цель метрики:** Убедиться, что модель примерно одинаково уверена во всех классах (дисперсия должна стремиться к нулю).
    - **Бейзлайн:** 0.4285 (полученный при подстановке значений макро F1 0.46 и дисперсии 99.000).

---

Чтобы представить себе, как Гибридный ИИ сочетает в себе разные аспекты, можно подумать о нем как о строителе, использующем лазерный уровень. Традиционный ИИ (строитель) мог бы просто смотреть на готовые дома (данные) и пытаться угадать, как их построить, используя только свою интуицию (статистику). Но Гибридный ИИ (строитель с лазерным уровнем) обязан следовать точным законам (физика), которые диктует уровень, чтобы его стена не рухнула, при этом он может использовать гибкие инструменты (нейросети) для быстрой работы.