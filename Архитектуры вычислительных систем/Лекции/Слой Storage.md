[[Лек 5. Слой Storage Ч1.pdf]]
# Конспект лекции: Слой хранения (Storage), Часть 1

### 1. Определение и задачи слоя Storage

**Storage** — это инфраструктура хранения данных, включающая устройства хранения (DAS, SAS, NAS, SDN), а также абстрагированные и облачные сервисы. Этот слой управляет данными в различных форматах и обеспечивает доступ к ним для приложений и служб.

**Основные задачи слоя:**

- Непосредственное **хранение данных**.
- Обеспечение **надежности** и **безопасности**.
- Поддержание **производительности** в соответствии с требованиями приложений.
- **Масштабируемость** и обеспечение **версионирования**.
- **Экономическая эффективность**.

### 2. Архитектура слоя хранения

Архитектура хранения представляет собой «слоеный пирог» из различных механизмов:

1. **I/O Subsystem:** Интерфейс между приложением и системой хранения.
2. **File System:** Механизм организации, именования и хранения данных.
3. **Volume Manager:** Абстракция тома.
4. **Partition Manager:** Управление разделами.
5. **Class:** Унификация специфики устройств (диски, ленты, оптика).
6. **Port:** Управление дисковыми протоколами (SCSIport, SATAport).
7. **Disk Subsystem:** Аппаратное обеспечение для чтения и записи.

### 3. Аппаратное обеспечение и типы дисков

В современных аппаратных залах можно встретить СХД типов DAS, NAS, SAN, а также программно-определяемые хранилища (SDS) и облачные решения.

#### Основные типы накопителей:

- **HDD (Hard Disk Drive):** Устройство произвольного доступа, работающее на принципе магнитной записи. Несмотря на возраст технологии, HDD остаются востребованными, так как они **дешевле за Мб**, подходят для **«холодного»** и долговечного хранения.
- **SSD (Solid-State Drive):** Энергонезависимое немеханическое устройство на базе микросхем памяти.

**Историческая справка:** В 1956 году жесткий диск IBM объемом 5 МБ весил около тонны (состоял из 50 дисков диаметром 24 дюйма). Современные решения, такие как **AWS Snowmobile**, представляют собой «диск на колесах» емкостью 100 ПБ в защищенном фургоне с вооруженной охраной.

#### Характеристики накопителей:

- **Для HDD:** Форм-фактор, объем буфера (8–256 Мб), скорость вращения шпинделя (от 4200 до 15000 об/мин в зависимости от назначения), IOPS, MTBF (наработка на отказ), уровень шума и ударостойкость.
- **Для SSD:** Тип флеш-памяти, количество циклов перезаписи (ресурс), IOPS, энергопотребление.

**Типы памяти SSD и их ресурс (циклы P/E):**

- **SLC:** 1 бит на ячейку (50 000 – 100 000 циклов).
- **eMLC:** Корпоративный класс (10 000 – 30 000 циклов).
- **MLC:** 2 бита на ячейку (3 000 – 10 000 циклов).
- **TLC:** 3 бита на ячейку (500 – 2 000 циклов).

### 4. Интерфейсы подключения

Интерфейс определяет скорость и режим взаимодействия накопителя с системой:

- **SATA (Serial ATA):** Последовательный интерфейс, развившийся из ATA (IDE). Работает в полудуплексном режиме по протоколу AHCI, поддерживает «горячее подключение» (Hot Plug). Скорость Revision 3.0 — до 6 Гбит/с.
- **NVMe:** Современный интерфейс (на базе PCIe), обеспечивающий типичные скорости 2000–2500 Мб/с. Обладает расширенным управлением питанием и возможностью обновления прошивки без остановки (для корпоративного класса).
- **SAS (Serial Attached SCSI):** Последовательный интерфейс для замены параллельного SCSI.
    - Работает в **полнодуплексном режиме**.
    - Совместим с SATA.
    - Поддерживает более 16384 устройств (против 32 у SCSI) с помощью **экспандеров** (расширителей).
    - Скорость SAS-4 достигает 22.5 Гбит/с.

### 5. Производительность дисковой подсистемы

Производительность измеряется в нескольких метриках:

- **MB/s (Мб/с) или GB/s:** Скорость линейного чтения/записи (важно для больших файлов).
- **IOPS (Operations Per Second):** Количество операций ввода-вывода в секунду (критично для баз данных).
- **Latency (Латентность):** Время ожидания между запросом и передачей данных (мс или мкс).

**Факторы, влияющие на IOPS:** конфигурация RAID, настройки драйверов и ОС, фрагментация файловой системы, размеры блоков данных, количество потоков и наличие фоновых приложений.

**Сравнение скоростей:** Линейное чтение на NVMe значительно превосходит показатели SATA SSD и HDD, достигая 2500 Мб/с против 550 Мб/с и 150 Мб/с соответственно. При этом с увеличением размера блока данных скорость чтения/записи растет, а показатель IOPS падает.

### Выводы

1. Слой Storage имеет сложную многоуровневую архитектуру .
2. Хотя флеш-накопители (SSD/NVMe) являются актуальным стандартом, HDD сохраняют свою нишу для дешевого и долговечного хранения .
3. Интерфейс подключения вносит критический вклад в итоговую скорость системы .
4. Понимание внутреннего устройства позволяет корректно измерять и оценивать производительность .**