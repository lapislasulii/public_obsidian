[[Лек 10. Слой Витртуализация.pdf]]
# Конспект лекции 10: Слой Virtualisation

## 1. Введение в виртуализацию

**Виртуализация** представляет собой технологический слой в ИТ-инфраструктуре, который **абстрагирует физические ресурсы** (серверы, системы хранения, сети) и предоставляет их в виде виртуальных машин или контейнеров.

**Ключевые определения:**

- **Виртуализация** — это предоставление набора вычислительных ресурсов или их логического объединения в отрыве от аппаратной реализации, обеспечивающее **логическую изоляцию** процессов, работающих на одном физическом ресурсе.
- **Виртуальная машина (VM)** — программная или аппаратная система, которая эмулирует аппаратное обеспечение гостевой платформы (guest) и исполняет её программы на хост-платформе (host), создавая изолированные среды для приложений и ОС.

## 2. Архитектура и классификация виртуализации

Центральным компонентом системы виртуализации является **гипервизор** (VMM — Virtual Machine Manager), который служит программным интерфейсом между оборудованием и разделами.

### Классификация гипервизоров:

- **Тип 1 (Bare Metal):** Гипервизор устанавливается непосредственно на «голое железо» (оборудование).
- **Тип 2 (Hosted):** Гипервизор работает внутри основной (хостовой) операционной системы.
- **Гибридный тип:** Сочетает черты обоих подходов.

### Аппаратная поддержка:

Для эффективной работы используется **аппаратная виртуализация**, такая как **Intel-VT** и **AMD-V**. В архитектурном плане гипервизор занимает так называемое **«Кольцо -1»**, располагаясь ниже ядра ОС (Кольцо 0) и приложений (Кольцо 3).

## 3. Основные термины и понятия

- **Раздел (Partition):** Это работающая виртуальная машина. Разделы делятся на **родительские** (управляющие) и **гостевые** (дочерние).
- **Стек виртуализации:** Набор компонентов в родительском разделе для управления гипервизором и дочерними разделами (например, для Hyper-V это VSP, VMBus, VDI).
- **Режимы разделов:** Разделы могут быть **эмулируемыми** или **просветленными** (enlightened).

## 4. Задачи и примеры использования

Виртуализация решает широкий спектр бизнес-задач:

1. **Виртуализация серверов:** Позволяет запускать несколько серверных ОС на одном физическом узле (примеры: VMware ESXi, Hyper-V, KVM, XEN).
2. **Виртуализация приложений:** Изоляция ПО от ОС (примеры: Microsoft App-V, VMware ThinApp, Citrix XenApp).
3. **Виртуализация рабочих мест (VDI):** Удаленный доступ к рабочим столам.
4. **Облачные вычисления:** Создание масштабируемых инфраструктур.

## 5. Контейнеризация

**Контейнеризация** — это виртуализация на уровне операционной системы. В отличие от классических ВМ, здесь ядро ОС поддерживает несколько изолированных экземпляров пространства пользователя.

### Технологическая база (Linux):

- **Namespaces:** Изолируют процессы (PID), сеть (Networking), файловую систему (Mount) и пользователей (User).
- **Control Groups (Cgroups):** Управляют ресурсами контейнера, ограничивая потребление памяти (Memory), процессора (CPU), операций ввода-вывода (IOPS) и сети.

### Преимущества и недостатки контейнеров:

|Преимущества|Недостатки|
|:--|:--|
|**Легкость:** минимальные накладные расходы.|**Сложность управления:** требует оркестрации.|
|**Скорость:** мгновенный запуск.|**Слабая изоляция:** общая безопасность зависит от ядра хоста.|
|**Инкапсуляция:** все зависимости в одном образе.|**Специфика ОС:** в основном ориентировано на Linux.|
|**Повторное использование:** готовые образы.|**Новизна:** технология требует актуальных компетенций.|

### Принципы работы:

Для эффективного использования контейнеров (например, через **Docker** или **podman**) необходимо следовать правилам: один контейнер — одна функция, статичность образа (не вносить изменения в работающий контейнер) и обязательное лимитирование ресурсов.

## 6. Оркестрация контейнеров

При масштабировании инфраструктуры ручное управление контейнерами становится невозможным, что требует использования **оркестраторов** (например, **Kubernetes (K8s)** или **OpenShift**).

**Основные задачи оркестратора:**

- Автоматическое развертывание и масштабирование.
- Балансировка нагрузки и управление сетевым трафиком.
- **Самовосстановление:** автоматический перезапуск упавших контейнеров.
- Управление хранилищами, секретами и конфигурациями.
- Автоматические обновления и откаты.

## 7. Итоги

Виртуализация предоставляет гибкость в управлении ресурсами, а контейнеризация обеспечивает высокую эффективность и скорость развертывания приложений, хотя и имеет специфические ограничения по изоляции. Выбор конкретной технологии (от виртуальных машин типа VirtualBox/VMware до контейнерных сред Docker/K8s) зависит от архитектурных задач проекта.