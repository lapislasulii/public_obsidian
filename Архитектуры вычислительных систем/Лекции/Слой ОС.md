[[Лек 9. Слой ОС.pdf]]
### **Конспект лекции №9. Операционные системы**

#### **1. Определение и роль ОС в ИТ-инфраструктуре**

**Операционная система (ОС)** представляет собой комплекс взаимосвязанных программ, предназначенных для **управления ресурсами компьютера** и организации взаимодействия с пользователем. В иерархии ИТ-инфраструктуры слой ОС располагается между аппаратным обеспечением (серверы, хранилища) и промежуточным ПО (Middleware) или средами выполнения (Runtime).

**Основные задачи современной ОС:**

- **Взаимодействие с оборудованием:** управление процессором, обработка прерываний, ввод-вывод (I/O) и работа с внешними устройствами.
- **Управление ресурсами:** распределение процессорного времени (процессы), оперативной памяти и организация файловых систем.
- **Обеспечение безопасности:** защита данных и разграничение прав доступа.
- **Сетевое взаимодействие:** поддержка протоколов и сетевых интерфейсов.
- **Предоставление API и интерфейса:** создание среды для выполнения приложений и взаимодействия с пользователем.

**Можно ли работать без ОС?** Да, но в ограниченных случаях:

1. **Встраиваемые системы:** устройства на микроконтроллерах, где специальное ПО напрямую управляет аппаратурой.
2. **Сервисные программы:** BIOS/UEFI, работающие до загрузки основной ОС.

---

#### **2. Архитектура операционных систем**

Типовая архитектура ОС строится на принципах **многослойности и абстракции**.

**Основные уровни ядра:**

1. **Средства аппаратной поддержки:** функции процессора для поддержки привилегированного режима, распределения памяти и переключения контекста.
2. **Машинно-зависимые компоненты:** слой, экранирующий остальные части ОС от особенностей конкретного «железа».
3. **Базовые механизмы ядра:** выполнение примитивных операций, таких как диспетчеризация прерываний и перемещение страниц памяти на диск.
4. **Менеджеры ресурсов:** модули, управляющие процессами, вводом-выводом, файловой системой и памятью.
5. **Интерфейс системных вызовов (API):** верхний слой ядра, предоставляющий приложениям доступ к ресурсам системы в удобной форме без привязки к физическим деталям.

**Аппаратная зависимость и защита:** Разработка ОС сильно зависит от архитектуры процессора, набора команд и разрядности (16/32/64/128 бит). Важной частью является **аппаратное разграничение доступа** через кольца защиты процессора (от Ring 0 для ядра до Ring 3 для приложений). Переносимость ОС между разными архитектурами обеспечивается перекомпиляцией кода и абстрактной архитектурой ядра.

---

#### **3. Классификация ОС**

ОС классифицируются по нескольким признакам:

- **По архитектуре ядра:** монолитные (полное ядро), микроядерные и гибридные.
- **По назначению:** пользовательские, серверные, мобильные, встраиваемые и общего назначения.
- **По времени обработки:** ОС реального времени и обычные.
- **По лицензированию:** проприетарные (платные/закрытые) и «свободные» (Open Source).
- **Дополнительно:** многопользовательские и сетевые системы.

---

#### **4. История и философия Linux**

История Linux неразрывно связана с **UNIX**, созданной в 1969 году Деннисом Ричи и Кеном Томпсоном.

**Ключевые идеи UNIX:**

- Основа системы — процесс и файл.
- Компонентная архитектура: одна программа выполняет одну функцию.
- Принцип **«всё есть файл»** и максимальное абстрагирование от оборудования.

В 1983 году Ричард Столлмэн основал проект **GNU** (GNU’s Not UNIX), разработав набор инструментов (toolchain, Emacs). В 1991 году **Линус Торвальдс**, обучаясь на системе Minix, начал писать собственный терминал, что переросло в создание ядра Linux. Первая версия 0.0.1 появилась 17 сентября 1991 года, а в 1994 году вышла версия 1.0 под лицензией GNU.

---

#### **5. Структура и версии ядра Linux**

**Linux — это именно ядро**, а не полноценная ОС. Полноценная система называется **дистрибутивом** (ядро + пользовательские приложения).

- **Управление разработкой:** Линус Торвальдс возглавляет иерархию мейнтейнеров. Процесс описывается как «тоталитарная демократия» с многоуровневым тестированием сообществом. За финансирование отвечает Linux Foundation.
- **Версионность:** формат `A.B.C[.D]`, где A — версия, B — мажорная ревизия, C — минорная ревизия, D — исправление критических ошибок.
- **Компоненты ядра:** планировщик процессов, менеджер памяти (kernel/user space), средства межпроцессного взаимодействия (IPC), виртуальная файловая система (VFS) и сетевой стек.
- **User Space:** включает системные библиотеки (**glibc**, реализующая стандарты POSIX), утилиты и службы (демоны).

---

#### **6. Процесс загрузки Linux**

Запуск системы проходит через несколько этапов:

1. **BIOS POST:** проверка аппаратуры и чтение первого сектора загрузочного устройства.
2. **Загрузчик (GRUB2):** выбор ядра, загрузка драйверов файловой системы и самого образа ядра (`/boot/vmlinuz`).
3. **Ядро:** монтирует временную файловую систему `initramfs` в память (`tmpfs`) и запускает инициализатор.
4. **Systemd:** монтирует основные файловые системы и запускает службы.

---

#### **7. Подсистема инициализации SYSTEMD**

**Systemd** — это современная подсистема инициализации и управления службами, созданная Леннартом Пёттерингом и Кеем Сиверсом. Она заменила классический `init` в большинстве дистрибутивов.

**Юниты (Units) в systemd:** Службы и ресурсы описываются файлами юнитов. Основные типы:

- `.service` — обычная программа/служба.
- `.target` — группа юнитов (цель загрузки).
- `.mount` и `.automount` — точки монтирования.
- `.socket` — сокеты для взаимодействия процессов.
- `.timer` — запуск по расписанию.

**Каталоги юнитов:**

- `/usr/lib/systemd/system` — юниты от разработчиков приложений.
- `/run/systemd/system` — динамические (временные) юниты.
- `/etc/systemd/system` — настройки и юниты, созданные администратором.

**Ключевые утилиты:**

- `systemctl`: управление службами (start, stop, enable, status, reboot).
- `systemd-analyze`: анализ времени и графиков загрузки.
- `journalctl`: просмотр системных логов (хранятся в `/run/log/journal/`). Можно фильтровать по конкретной службе (`-u`) или следить за логом в реальном времени (`-f`).